---
layout: post
title: "Dirichlet Process Mixture of Factor Analyzer"
tags: [Bayesian Nonparametrics]
comments: true
---

```python
import numpy as np
import pandas as pd
import random

from numpy import linalg as LA

import scipy.stats as stats
from scipy.stats import multivariate_normal, invwishart
from collections import Counter
from sklearn.cluster import KMeans
from sklearn.metrics.cluster import normalized_mutual_info_score

import matplotlib.pyplot as plt
import plotly.graph_objects as go

from Neal2000_MFA import Algorithm_8_MFA
from MFA_posterior import parameter_sample

import multiprocessing 
from multiprocessing import Pool
from functools import partial, reduce
import time
```

# 1. Generating data


```python
true_K = 4 # The true number of clusters : 0,1, ... , true_K-1
dim = 15 # The dimension of our sample space
N = 500 # The number of observations to generate

true_d = [np.random.randint(1,dim) for k in range(true_K)]# The true dimensions of each clusters. val: 1 ~ dim
true_mu_list = [(np.random.rand(dim,1)-0.5)*60 for k in range(true_K)] # The true mean vectors of each clusters. val: -10 ~ 10
true_W_list = [(np.random.rand(dim, true_d[k])-0.5)*10 for k in range(true_K)] # The true W matrices of each clusters. val: -5 ~ 5 

sigma = 0.1

#clusterprob = np.random.rand(1,true_K)[0]
clusterprob = list(np.repeat(N/true_K,true_K))
clusterprob = clusterprob/sum(clusterprob) # The cluster assignment probability to generate data

true_z = [np.random.choice(np.arange(true_K), p=clusterprob) for n in range(N)]
true_z_count = [true_z.count(k) for k in range(true_K)]

data = pd.DataFrame({})

for k in range(true_K):
    mean_k = true_mu_list[k]
    W_k = true_W_list[k]
    cov_k = np.matmul(W_k, W_k.transpose()) + np.diag(np.repeat(sigma,dim))
    n_k = true_z_count[k]
    
    df = pd.DataFrame(np.random.multivariate_normal(mean_k[:,0], cov_k, n_k))
    df.index = np.repeat(k,n_k)
    data = data.append(df)
    
data.columns = ['V'+str(val) for val in np.arange(1,dim+1)]
```


```python
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>V1</th>
      <th>V2</th>
      <th>V3</th>
      <th>V4</th>
      <th>V5</th>
      <th>V6</th>
      <th>V7</th>
      <th>V8</th>
      <th>V9</th>
      <th>V10</th>
      <th>V11</th>
      <th>V12</th>
      <th>V13</th>
      <th>V14</th>
      <th>V15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>-17.027587</td>
      <td>-36.351348</td>
      <td>-37.478123</td>
      <td>25.957548</td>
      <td>-16.592331</td>
      <td>-7.520300</td>
      <td>5.466696</td>
      <td>33.261372</td>
      <td>26.178091</td>
      <td>-11.414522</td>
      <td>35.726361</td>
      <td>-4.553333</td>
      <td>-19.476742</td>
      <td>-17.632172</td>
      <td>6.599922</td>
    </tr>
    <tr>
      <td>0</td>
      <td>-14.853615</td>
      <td>-38.960099</td>
      <td>-35.334548</td>
      <td>13.202306</td>
      <td>-19.380925</td>
      <td>-19.782543</td>
      <td>-4.867465</td>
      <td>28.805263</td>
      <td>31.174993</td>
      <td>-9.895027</td>
      <td>33.066063</td>
      <td>-7.232485</td>
      <td>-22.830395</td>
      <td>-23.515216</td>
      <td>0.076708</td>
    </tr>
    <tr>
      <td>0</td>
      <td>-22.869518</td>
      <td>-28.646954</td>
      <td>-33.692458</td>
      <td>11.795818</td>
      <td>-20.430765</td>
      <td>-18.621177</td>
      <td>-9.275940</td>
      <td>25.382077</td>
      <td>29.732905</td>
      <td>-2.293668</td>
      <td>27.541883</td>
      <td>-6.195451</td>
      <td>-18.855018</td>
      <td>-24.409180</td>
      <td>2.950909</td>
    </tr>
    <tr>
      <td>0</td>
      <td>-33.817122</td>
      <td>-28.493944</td>
      <td>-42.979389</td>
      <td>31.996120</td>
      <td>-13.169088</td>
      <td>-11.052886</td>
      <td>-3.017904</td>
      <td>29.013522</td>
      <td>21.255120</td>
      <td>-6.554552</td>
      <td>25.144934</td>
      <td>-3.748930</td>
      <td>-21.770406</td>
      <td>-28.029451</td>
      <td>1.749013</td>
    </tr>
    <tr>
      <td>0</td>
      <td>-22.983209</td>
      <td>-37.104099</td>
      <td>-35.418901</td>
      <td>15.624102</td>
      <td>-20.569184</td>
      <td>-22.405804</td>
      <td>5.608591</td>
      <td>32.502325</td>
      <td>30.532606</td>
      <td>-6.817886</td>
      <td>20.778679</td>
      <td>-8.611996</td>
      <td>-15.459400</td>
      <td>-31.803583</td>
      <td>5.352403</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-5.113880</td>
      <td>25.588680</td>
      <td>2.358271</td>
      <td>-28.522395</td>
      <td>22.556697</td>
      <td>-13.601695</td>
      <td>26.921473</td>
      <td>-17.828499</td>
      <td>-28.168902</td>
      <td>-18.423947</td>
      <td>-6.968528</td>
      <td>-14.595847</td>
      <td>-4.917201</td>
      <td>14.048643</td>
      <td>2.205619</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-6.174692</td>
      <td>23.979336</td>
      <td>4.988885</td>
      <td>-33.170151</td>
      <td>6.242494</td>
      <td>-10.697447</td>
      <td>37.114109</td>
      <td>-11.605661</td>
      <td>-24.660610</td>
      <td>-21.405182</td>
      <td>-3.104706</td>
      <td>-14.517690</td>
      <td>-4.197293</td>
      <td>35.937669</td>
      <td>19.094541</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4.264316</td>
      <td>26.929149</td>
      <td>6.198285</td>
      <td>-13.160207</td>
      <td>4.264595</td>
      <td>-17.980763</td>
      <td>21.297848</td>
      <td>-10.508099</td>
      <td>-22.834084</td>
      <td>-19.933416</td>
      <td>3.969016</td>
      <td>-8.435123</td>
      <td>1.608751</td>
      <td>7.875081</td>
      <td>6.462787</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-18.729982</td>
      <td>16.208263</td>
      <td>24.523535</td>
      <td>-20.903804</td>
      <td>45.589911</td>
      <td>-34.222392</td>
      <td>22.855339</td>
      <td>2.422174</td>
      <td>-27.312237</td>
      <td>-9.653131</td>
      <td>12.689959</td>
      <td>-20.911422</td>
      <td>-7.150545</td>
      <td>-10.819102</td>
      <td>-0.785856</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-19.345481</td>
      <td>32.336554</td>
      <td>13.844730</td>
      <td>-38.290888</td>
      <td>26.854893</td>
      <td>-5.193902</td>
      <td>39.636729</td>
      <td>-4.562352</td>
      <td>-30.972030</td>
      <td>-13.923027</td>
      <td>3.157088</td>
      <td>-25.301932</td>
      <td>-6.027334</td>
      <td>18.906508</td>
      <td>12.853261</td>
    </tr>
  </tbody>
</table>
<p>500 rows × 15 columns</p>
</div>



3개의 차원에 대해서만 그려본 모습.


```python
plotx, ploty, plotz = data.iloc[:,0],data.iloc[:,1],data.iloc[:,2]
fig = go.Figure(data=[go.Scatter3d(x=plotx, y=ploty, z=plotz,
                                   mode='markers', 
                                   marker=dict(size=2, color=data.index, colorscale='Viridis', opacity=1 ))])
fig.show()
```

Cluster 별 latent dimension과 원소 수의 true value는 다음과 같다.


```python
true_d
```




    [7, 10, 5, 13]




```python
true_z_count
```




    [115, 143, 129, 113]



# 2. Settings

## Specifying hyperparameters


```python
#specifying hyperparameters for prior distribution
mu_tilde = data.apply(np.mean).values
nu_tilde = dim
Sigma_tilde = (1/N)*np.cov(data.transpose())
alpha_tilde = 1
beta_tilde = 1
a_0 = 2
gamma_tilde = 1
delta_tilde = 1
a_tilde = 1
b_tilde = 5


# Initial number of clusters
K_0 = 2

hyperpara_dict = {'mu_tilde': mu_tilde, 'nu_tilde': nu_tilde, 'Sigma_tilde': Sigma_tilde, 'alpha_tilde': alpha_tilde, 
                 'beta_tilde': beta_tilde, 'a_0': a_0, 'gamma_tilde': gamma_tilde, 'delta_tilde': delta_tilde, 
                  'a_tilde': a_tilde, 'b_tilde': b_tilde, 'K_0': K_0, 'N': N, 'dim': dim}
```

## Initializing parameters


```python
# list to save the iteration result
## hyperparameter
mu_0_list = []
Sigma_0_list = []
phi_list = []
b_0_list = []
## Mixture component parameter
mu_list = []
Lambda_list = []
Psi_list = []
d_list = []
## Mixture assignment parameter
c_list = []
alpha_list = []

## initialize cluster assignment
#kmeans = KMeans(n_clusters=K_0, random_state=0).fit(data)
#c_list.append(kmeans.labels_)
#c_list.append(np.random.randint(0, K_0, N))

## Initialize alpha
alpha_list.append(np.random.gamma(a_tilde, 1/b_tilde, 1)[0])

## Initialize d : 1 ~ dim-1
d_list.append(np.random.randint(1, dim, K_0))

## Initialize mu_0
mu_0_list.append(np.random.multivariate_normal(mu_tilde, Sigma_tilde, 1)[0])

## Initialize Sigma_0
inv_wishart = invwishart(df=nu_tilde, scale=LA.inv(Sigma_tilde))
Sigma_0_list.append(inv_wishart.rvs(1))

## Initialize phi_j's
phi_list.append(np.random.gamma(alpha_tilde, 1/beta_tilde, dim-1))

## Initialize a_0, b_0
b_0_list.append(np.random.gamma(gamma_tilde, 1/delta_tilde, 1)[0])

## Initialize mu_k's
mu_list.append(np.random.multivariate_normal(mu_0_list[-1], Sigma_0_list[-1], K_0).transpose())

## Initialize c
c_init = np.zeros((N),dtype=int)
for n in range(N):
    normarray = np.array([LA.norm(data.iloc[n].values - mu_list[-1][:,muidx]) for muidx in range(mu_list[-1].shape[1]) ])
    c_init[n] = np.argmin(normarray)
c_list.append(c_init)

## Initialize Lambda_k's
Lambda_total = [] 
for i in range(K_0):
    Lambda_init = np.zeros((dim,d_list[-1][i]))
    for j in range(d_list[-1][i]):
        Lambda_j_init = np.random.multivariate_normal(np.repeat(0, dim), np.diag(np.repeat(1/(phi_list[-1][j]),dim)), 1)[0]
        Lambda_init[:,j] = Lambda_j_init
    Lambda_total.append(Lambda_init)
Lambda_list.append(Lambda_total)

## Initialize Psi_k's
Psi_total = []
for i in range(K_0):
    Psi_init = np.diag(1/np.random.gamma(a_0, 1/b_0_list[-1], dim))
    Psi_total.append(Psi_init)
Psi_list.append(Psi_total)

init_dict = {'mu_0': mu_0_list[-1], 'Sigma_0': Sigma_0_list[-1], 'phi': phi_list[-1], 'b_0': b_0_list[-1],
             'mu': mu_list[-1], 'Lambda': Lambda_list[-1], 'Psi': Psi_list[-1], 'd': d_list[-1], 'c': c_list[-1], 
             'alpha': alpha_list[-1]}
```


```python
init_dict
```




    {'mu_0': array([-10.5796966 ,  -0.53295315,  -5.50465242,  -2.97212471,
             -3.01247383,  -6.47696968,   7.4842918 ,   1.96275214,
              4.51985615,   5.57832617,   1.42320164,  -7.60205859,
             -3.56831577,  -7.19265603,  -0.72895332]),
     'Sigma_0': array([[ 2.49123453e+02, -2.19514061e+02,  1.98476655e+02,
              2.57418625e+02, -2.49006860e+02,  1.78742772e+02,
             -3.24722445e+02,  1.87372666e+02, -2.97748910e+02,
              7.19770576e+00, -2.94525641e+01,  1.53423126e+02,
             -4.03613283e+02,  7.44543186e+02, -3.38787130e+01],
            [-2.19514061e+02,  1.99332795e+02, -1.78352967e+02,
             -2.30770364e+02,  2.23024114e+02, -1.61178129e+02,
              2.93384807e+02, -1.70631159e+02,  2.68878070e+02,
             -8.41546025e+00,  2.69535766e+01, -1.35537741e+02,
              3.65283403e+02, -6.71814212e+02,  2.90932008e+01],
            [ 1.98476655e+02, -1.78352967e+02,  1.62687780e+02,
              2.07881462e+02, -2.01129283e+02,  1.44072323e+02,
             -2.63101922e+02,  1.51356564e+02, -2.40389008e+02,
              5.93003470e+00, -2.29012377e+01,  1.22723129e+02,
             -3.24265292e+02,  6.01857181e+02, -2.63807496e+01],
            [ 2.57418625e+02, -2.30770364e+02,  2.07881462e+02,
              2.70878518e+02, -2.61004605e+02,  1.88183060e+02,
             -3.42977602e+02,  1.99721171e+02, -3.14672050e+02,
              9.59831608e+00, -3.22477042e+01,  1.59322553e+02,
             -4.26401791e+02,  7.84038033e+02, -3.30215120e+01],
            [-2.49006860e+02,  2.23024114e+02, -2.01129283e+02,
             -2.61004605e+02,  2.53843797e+02, -1.82683568e+02,
              3.32754766e+02, -1.93860235e+02,  3.05519374e+02,
             -9.73299324e+00,  3.08648464e+01, -1.54665915e+02,
              4.15049656e+02, -7.59304658e+02,  3.22933188e+01],
            [ 1.78742772e+02, -1.61178129e+02,  1.44072323e+02,
              1.88183060e+02, -1.82683568e+02,  1.32827471e+02,
             -2.40583412e+02,  1.41578719e+02, -2.21566233e+02,
              8.08303770e+00, -2.27203310e+01,  1.11298350e+02,
             -3.02086934e+02,  5.49015775e+02, -2.31289533e+01],
            [-3.24722445e+02,  2.93384807e+02, -2.63101922e+02,
             -3.42977602e+02,  3.32754766e+02, -2.40583412e+02,
              4.40290598e+02, -2.59593395e+02,  4.04131345e+02,
             -1.56769050e+01,  4.26462706e+01, -2.02281116e+02,
              5.51115752e+02, -1.00020490e+03,  4.08024292e+01],
            [ 1.87372666e+02, -1.70631159e+02,  1.51356564e+02,
              1.99721171e+02, -1.93860235e+02,  1.41578719e+02,
             -2.59593395e+02,  1.58680428e+02, -2.40068503e+02,
              1.34625512e+01, -2.73220726e+01,  1.17841391e+02,
             -3.30163779e+02,  5.86000959e+02, -2.24177658e+01],
            [-2.97748910e+02,  2.68878070e+02, -2.40389008e+02,
             -3.14672050e+02,  3.05519374e+02, -2.21566233e+02,
              4.04131345e+02, -2.40068503e+02,  3.72608265e+02,
             -1.58388824e+01,  3.94341497e+01, -1.85891295e+02,
              5.08495479e+02, -9.18473930e+02,  3.72636664e+01],
            [ 7.19770576e+00, -8.41546025e+00,  5.93003470e+00,
              9.59831608e+00, -9.73299324e+00,  8.08303770e+00,
             -1.56769050e+01,  1.34625512e+01, -1.58388824e+01,
              4.74611288e+00, -2.96073129e+00,  5.29688570e+00,
             -2.42894224e+01,  3.23342239e+01,  5.34142540e-02],
            [-2.94525641e+01,  2.69535766e+01, -2.29012377e+01,
             -3.22477042e+01,  3.08648464e+01, -2.27203310e+01,
              4.26462706e+01, -2.73220726e+01,  3.94341497e+01,
             -2.96073129e+00,  6.14591260e+00, -1.88087176e+01,
              5.50897932e+01, -9.46260202e+01,  2.56447075e+00],
            [ 1.53423126e+02, -1.35537741e+02,  1.22723129e+02,
              1.59322553e+02, -1.54665915e+02,  1.11298350e+02,
             -2.02281116e+02,  1.17841391e+02, -1.85891295e+02,
              5.29688570e+00, -1.88087176e+01,  9.55656417e+01,
             -2.52319971e+02,  4.61902270e+02, -2.02116427e+01],
            [-4.03613283e+02,  3.65283403e+02, -3.24265292e+02,
             -4.26401791e+02,  4.15049656e+02, -3.02086934e+02,
              5.51115752e+02, -3.30163779e+02,  5.08495479e+02,
             -2.42894224e+01,  5.50897932e+01, -2.52319971e+02,
              6.99540428e+02, -1.25067256e+03,  5.17031338e+01],
            [ 7.44543186e+02, -6.71814212e+02,  6.01857181e+02,
              7.84038033e+02, -7.59304658e+02,  5.49015775e+02,
             -1.00020490e+03,  5.86000959e+02, -9.18473930e+02,
              3.23342239e+01, -9.46260202e+01,  4.61902270e+02,
             -1.25067256e+03,  2.28330172e+03, -9.60889011e+01],
            [-3.38787130e+01,  2.90932008e+01, -2.63807496e+01,
             -3.30215120e+01,  3.22933188e+01, -2.31289533e+01,
              4.08024292e+01, -2.24177658e+01,  3.72636664e+01,
              5.34142540e-02,  2.56447075e+00, -2.02116427e+01,
              5.17031338e+01, -9.60889011e+01,  6.90597176e+00]]),
     'phi': array([0.37730185, 0.00713908, 0.28880592, 1.00715917, 1.78147993,
            0.25171846, 0.24627171, 0.54029245, 0.30525224, 0.10043334,
            1.31118513, 0.93485124, 0.98017262, 0.69568678]),
     'b_0': 0.22503269767145934,
     'mu': array([[-22.11246086,   5.36436731],
            [ 10.45711399, -13.07840932],
            [-14.15746816,   6.2730544 ],
            [-17.58959884,  11.0293064 ],
            [ 10.74299061, -15.00477298],
            [-18.82166887,   1.77955946],
            [ 27.79952698,  -6.75202493],
            [-14.66842069,   6.31397432],
            [ 25.66378858,  -6.63948458],
            [  1.68684689,   3.13066913],
            [  5.14523775,   1.8831888 ],
            [-16.12335979,  -0.13135713],
            [ 26.49816809, -16.81845441],
            [-51.048682  ,  31.08897085],
            [ -0.49704862,  -3.79374347]]),
     'Lambda': [array([[ 2.42773406e+00, -5.14259081e+00, -2.21199722e+00,
              -9.78954865e-01,  1.12016350e+00,  3.24888858e+00],
             [ 6.97643353e-01, -1.14472553e+01,  8.86318660e-01,
               7.87334866e-01, -6.07535305e-01, -2.18179200e+00],
             [ 1.43542198e+00,  3.56860073e+00,  1.31565391e+00,
               2.13467668e+00, -4.19539867e-01,  1.37155547e+00],
             [ 1.88056878e+00, -8.95454878e+00,  1.83600990e+00,
              -3.36445081e-01, -3.86491390e-01, -2.24114211e+00],
             [ 7.44209171e-01,  5.94285466e+00,  5.53956783e+00,
               8.46392100e-01,  4.42773275e-01, -3.60154741e+00],
             [ 1.11365856e+00,  8.44680113e+00,  3.91773200e-01,
               1.58870916e+00, -3.02872482e-01, -6.13655781e+00],
             [-9.35819137e-01, -8.18486558e+00, -1.04679913e+00,
               1.78983642e+00,  2.85820475e-01,  5.12716767e-01],
             [ 1.61782670e+00,  1.63071992e+01, -2.50188464e+00,
              -1.86497534e+00, -1.77837052e+00,  2.54275206e+00],
             [ 1.07408122e+00,  1.19310055e+01,  2.87942063e-01,
              -9.31054248e-01, -1.27051473e+00, -7.10499293e-01],
             [-1.67877422e-01, -1.29901734e+01,  2.35825165e+00,
               6.07242796e-01, -2.96529618e-01,  2.10061479e+00],
             [-2.54958064e+00, -1.15474294e+01, -5.99517136e-01,
               4.75612800e-01,  4.27408853e-02, -1.04457230e+00],
             [ 9.77553416e-01, -3.16935572e+01, -2.97166736e+00,
               7.43417900e-01, -5.94874465e-01, -1.82401906e+00],
             [ 3.35338697e-01,  3.60364947e+00, -1.45239024e+00,
               3.09220502e-01,  9.08998116e-01,  3.40394004e+00],
             [-8.52063750e-01, -4.18047832e+00,  1.83185776e+00,
              -8.19024155e-01,  2.28108605e-01,  1.84333265e+00],
             [ 2.66719895e+00, -1.61804562e+01,  1.62303880e+00,
              -3.63993988e-01, -2.02349829e-02,  1.55727265e+00]]),
      array([[  0.52963678,   2.68780428,  -1.34584145],
             [  3.01534944,  12.98913781,   2.65872394],
             [ -0.34577098,  -5.66976825,  -4.61642558],
             [ -1.1183843 ,  -0.91440076,  -0.67268476],
             [ -2.82362013,  17.1195034 ,  -2.25733216],
             [  0.43848661,  -3.90512646,   1.76979514],
             [ -0.25310443,  -1.64230597,  -1.95469755],
             [ -1.42371806,   0.66471487,  -2.22087458],
             [ -2.53724791,  -2.44965754,   1.26881164],
             [  1.18649253,  10.51393449,  -0.94263262],
             [ -0.45483289, -13.94766431,  -0.39231347],
             [ -0.80834129,   8.88275341,  -2.29104029],
             [ -0.19457733,  -4.60455521,   1.11467081],
             [ -1.00410806, -11.73899065,  -0.35934645],
             [  0.36286301,   3.45190614,   1.10098429]])],
     'Psi': [array([[0.0411733 , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.21481857, 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.3250026 , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.11099103, 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.03767077,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.09676922, 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.17399361, 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.19228462, 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.22326443, 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.12695546,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.0505733 , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.36918892, 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.07568105, 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.15761507, 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.16679734]]),
      array([[0.03784321, 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.17154962, 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.46229525, 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.17595995, 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.18868369,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.05291112, 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.11500872, 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.16508208, 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.11940206, 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.03411399,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.23164045, 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.10079185, 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.21066831, 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.06658336, 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.16721265]])],
     'd': array([6, 3]),
     'c': array([1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1,
            1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1,
            0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0,
            1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1,
            0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1,
            1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1,
            1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0,
            1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0,
            1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1]),
     'alpha': 0.2632582162143184}



## Number of iterations
Iteration 수는 5000으로 설정.


```python
Iter = 5000
```

## Define module for parallel computing
8개의 processor로 parameter의 업데이트를 병렬적으로 수행.


```python
multiprocessing.cpu_count()
```




    8




```python
def parallel_iter(func, dataset_list, init_dict_var):
    parameter_sample_lists_fixed = partial(func, initialization_dict = init_dict_var, hyperparameter_dict = hyperpara_dict, whole_data = data)     
    if __name__ == '__main__':
        pool = Pool(multiprocessing.cpu_count()) 
        result_list = list(pool.map(parameter_sample_lists_fixed, dataset_list))
        pool.close()
        pool.join()
    return result_list
```

## Create list to save the NMI values of each iteration


```python
NMI_list = []
```

# 3. Sampling

$\mathbf c$를 업데이트할 때 사용하는 auxiliary variable의 수는 $m = 4$을 사용.


```python
start_time = time.time()
for iters in range(Iter):
    start_iter_time = time.time()
    if (iters % 5 == 1) or (iters < 30):
        print("alpha for this iteration is ",alpha_list[-1])
    
    ##################### Update c ##################### 
    c_iter_result = Algorithm_8_MFA(data, init_dict, hyperpara_dict, m=4)
    
    mu_0_list.append(c_iter_result['mu_0'])
    Sigma_0_list.append(c_iter_result['Sigma_0'])
    phi_list.append(c_iter_result['phi'])
    b_0_list.append(c_iter_result['b_0'])
    mu_list.append(c_iter_result['mu'])
    Lambda_list.append(c_iter_result['Lambda'])
    Psi_list.append(c_iter_result['Psi'])
    d_list.append(c_iter_result['d'])
    c_list.append(c_iter_result['c'])
    alpha_list.append(c_iter_result['alpha'])
    
    # divide data by clusters
    grouped = data.groupby(c_list[-1])
    data_c_list = [(idx,grouped.get_group(idx)) for idx in np.unique(c_list[-1])]
    K = len(data_c_list)
    
    # Update init_dict for next task
    init_dict = {'mu_0': mu_0_list[-1], 'Sigma_0': Sigma_0_list[-1], 'phi': phi_list[-1], 'b_0': b_0_list[-1],
                 'mu': mu_list[-1], 'Lambda': Lambda_list[-1], 'Psi': Psi_list[-1], 'd': d_list[-1], 'c': c_list[-1], 
                 'alpha': alpha_list[-1]}
    
    ##################### Update mixture components ##################### 
    # Parallel update for mixture component parameters
    phi_result_list = parallel_iter(func = parameter_sample, dataset_list = data_c_list, init_dict_var= init_dict)
    phi_result_list
    # Update parameter lists
    for j in range(K):        
        mu_list[-1][:,j] = phi_result_list[j]['mu_k']
        Lambda_list[-1][j] = phi_result_list[j]['Lambda_k']
        Psi_list[-1][j] = phi_result_list[j]['Psi_k']
        d_list[-1][j] = phi_result_list[j]['d_k']
        
    ##################### Update parameters for prior distributions ##################### 
    # Update alpha
    eta = np.random.beta(alpha_list[-1]+1, N, 1)[0]
    alpha_mix_prob = [a_tilde + K-1, N*(b_tilde - np.log(eta))]
    alpha_mix_prob = alpha_mix_prob/sum(alpha_mix_prob)
    mix_bool = np.random.choice([True,False], p=alpha_mix_prob)
    # sample from mixture of gamma
    if mix_bool:
        alpha_new = np.random.gamma(a_tilde+K, 1/(b_tilde - np.log(eta)), 1)[0]
    else:
        alpha_new = np.random.gamma(a_tilde+K-1, 1/(b_tilde - np.log(eta)), 1)[0]
    alpha_list[-1] = alpha_new
    
    # Update mu_0
    mu_bar =  np.mean(pd.DataFrame(mu_list[-1]).transpose()).values
    cov = LA.inv(LA.inv(Sigma_tilde) + K*LA.inv(Sigma_0_list[-1]))
    mean = np.matmul(cov,(np.matmul(LA.inv(Sigma_tilde), mu_tilde) + K*np.matmul(LA.inv(Sigma_0_list[-1]),mu_bar)))
    mu_0_new = np.random.multivariate_normal(mean, cov, 1)[0]
    mu_0_list[-1] = mu_0_new
    
    # Update Sigma_0
    V = np.matmul( (pd.DataFrame(mu_list[-1].transpose())- mu_bar).values.transpose(), 
                  (pd.DataFrame(mu_list[-1].transpose())- mu_bar).values )
    inv_wishart = invwishart(df=nu_tilde + 1, scale=LA.inv(Sigma_tilde) + V)
    Sigma_0_list[-1] = inv_wishart.rvs(1)
    
    # Update phi_j
    for j in range(dim-1):
        shape = alpha_tilde
        rate = beta_tilde
        for k in range(K):
            if d_list[-1][k] > j:
                shape = shape + (dim/2)
                LL = Lambda_list[-1][k][:,j]
                rate = rate + (np.dot(LL, LL)/2)
        phi_j_new = np.random.gamma(shape, 1/rate, 1)[0]
        phi_list[-1][j] = phi_j_new
        
    # Update b_0
    shape = gamma_tilde + (a_0*K*dim)
    rate = delta_tilde
    for k in range(K):
        rate = rate + sum(1/np.diag(Psi_list[-1][k]))
    b_0_new = np.random.gamma(shape, 1/rate, 1)[0]
    b_0_list[-1] = b_0_new
    
    ######################## Update init_dict for next iteration ##########################

    init_dict = {'mu_0': mu_0_list[-1], 'Sigma_0': Sigma_0_list[-1], 'phi': phi_list[-1], 'b_0': b_0_list[-1],
                 'mu': mu_list[-1], 'Lambda': Lambda_list[-1], 'Psi': Psi_list[-1], 'd': d_list[-1], 'c': c_list[-1], 
                 'alpha': alpha_list[-1]}
    
    ######################## Print out the output ##########################
    NMI = normalized_mutual_info_score(data.index, c_list[-1],average_method = 'arithmetic')
    NMI_list.append(NMI)
    
    end_time = time.time()
    
    if (iters % 5 == 1) or (iters < 30):
        print(iters+1,"th iteration completed // # of clusters : ",max(c_list[-1])+1)
        table = np.array([( Counter(c_list[-1])[j] ) for j in range(max(c_list[-1])+1)])
        table = pd.DataFrame(table).transpose()
        table = table.append(pd.DataFrame(d_list[-1]).transpose())
        table.index = ['count', 'dim']
        print(table)
        print("Normalized Mutual Information Score : ", NMI)
        print("Elapsed time : ", np.round(end_time - start_iter_time,1), "sec // Total elapsed time : ", np.round(end_time - start_time,1), "sec")
        print("==================================================================================")
```

    alpha for this iteration is  0.2632582162143184
    1 th iteration completed // # of clusters :  54
           0   1   2   3   4   5   6   7   8   9   ...  44  45  46  47  48  49  \
    count  14   8  17  15  12  11  12  10  11  14  ...   5   3   3   4   3   1   
    dim     6   3   5   6   4   6   3   1   8  10  ...   1   6   6   7   1   8   
    
           50  51  52  53  
    count   1   2   2   1  
    dim     2   2   8   5  
    
    [2 rows x 54 columns]
    Normalized Mutual Information Score :  0.17340250969319826
    Elapsed time :  25.8 sec // Total elapsed time :  25.8 sec
    ==================================================================================
    alpha for this iteration is  4.08245572088003
    2 th iteration completed // # of clusters :  67
           0   1   2   3   4   5   6   7   8   9   ...  57  58  59  60  61  62  \
    count   4   1   5   6   3   4   2   2   4   5  ...   5   2   3   3   3   2   
    dim     6   5   6   4   6   3   2   8  10   6  ...   8   4   8  12   3   4   
    
           63  64  65  66  
    count   1   2   1   1  
    dim     1   5   8   7  
    
    [2 rows x 67 columns]
    Normalized Mutual Information Score :  0.3637149924839635
    Elapsed time :  35.5 sec // Total elapsed time :  61.3 sec
    ==================================================================================
    alpha for this iteration is  6.431113896278033
    3 th iteration completed // # of clusters :  63
           0   1   2   3   4   5   6   7   8   9   ...  53  54  55  56  57  58  \
    count   3   6   2   2   3   4   5   1   3   2  ...   7   3   2   1   2   3   
    dim     6   5   6   6   3   2  10   6   3   2  ...  14   7   2   3   9   7   
    
           59  60  61  62  
    count   2   1   2   1  
    dim     1   3   6  11  
    
    [2 rows x 63 columns]
    Normalized Mutual Information Score :  0.5354817677614138
    Elapsed time :  40.1 sec // Total elapsed time :  101.4 sec
    ==================================================================================
    alpha for this iteration is  7.488668014141318
    4 th iteration completed // # of clusters :  41
           0   1   2   3    4   5   6    7   8   9   ...  31  32  33  34  35  36  \
    count   1   1   1   2  113   9  96  112   1   1  ...   1   2   1   1   1   1   
    dim     7   6   3   3   14  11  12   14   6   4  ...   3   2   1   6   8   5   
    
           37  38  39  40  
    count   4   1   2   1  
    dim     1   2   8   5  
    
    [2 rows x 41 columns]
    Normalized Mutual Information Score :  0.7340073757911796
    Elapsed time :  35.2 sec // Total elapsed time :  136.7 sec
    ==================================================================================
    alpha for this iteration is  4.235476648791053
    5 th iteration completed // # of clusters :  28
            0   1    2   3   4   5    6   7   8   9   ...  18  19  20  21  22  23  \
    count  114  72  132   2   8  45  100   1   2   4  ...   1   1   1   1   1   2   
    dim     14  12   14   4   9  13   14   3   8   2  ...   3   7   5   6   1   8   
    
           24  25  26  27  
    count   1   1   1   1  
    dim     2   5   4   8  
    
    [2 rows x 28 columns]
    Normalized Mutual Information Score :  0.8267103701541815
    Elapsed time :  30.5 sec // Total elapsed time :  167.2 sec
    ==================================================================================
    alpha for this iteration is  2.5904034243805913
    7 th iteration completed // # of clusters :  26
            0   1    2   3   4   5   6   7   8   9   ...  16  17  18  19  20  21  \
    count  114  28  135   2  15  94  93   1   1   1  ...   1   1   1   1   1   1   
    dim     14  14   14   3   9  14  14   3   8   1  ...   6   3   6   1   1   2   
    
           22  23  24  25  
    count   1   1   1   1  
    dim     9   6   4   9  
    
    [2 rows x 26 columns]
    Normalized Mutual Information Score :  0.8428785182360695
    Elapsed time :  23.3 sec // Total elapsed time :  214.2 sec
    ==================================================================================
    alpha for this iteration is  1.6058022977746813
    12 th iteration completed // # of clusters :  26
            0   1    2   3   4   5    6   7   8   9   ...  16  17  18  19  20  21  \
    count  114  25  134   2   8  96  102   1   1   1  ...   1   1   1   1   1   1   
    dim     14  14   14   2  13  14   14   3  10   2  ...   7   3   5   1   1   2   
    
           22  23  24  25  
    count   1   1   1   1  
    dim     9   5   5   9  
    
    [2 rows x 26 columns]
    Normalized Mutual Information Score :  0.8670783381255375
    Elapsed time :  22.7 sec // Total elapsed time :  329.2 sec
    ==================================================================================
    alpha for this iteration is  2.7629893681992836
    17 th iteration completed // # of clusters :  26
            0   1    2   3   4    5   6   7   8   9   ...  16  17  18  19  20  21  \
    count  114  14  134   2  19  107  91   1   1   1  ...   1   1   1   1   1   1   
    dim     14  14   14   3  14   14  14   3  10   4  ...   5   4   6   2   1   2   
    
           22  23  24  25  
    count   1   1   1   1  
    dim    11   6   4   8  
    
    [2 rows x 26 columns]
    Normalized Mutual Information Score :  0.8650913341708795
    Elapsed time :  23.6 sec // Total elapsed time :  447.6 sec
    ==================================================================================
    alpha for this iteration is  2.648857258723105
    22 th iteration completed // # of clusters :  26
            0   1    2   3   4    5   6   7   8   9   ...  16  17  18  19  20  21  \
    count  114  17  134   2  17  104  93   1   1   1  ...   1   1   1   1   1   1   
    dim     14  14   14   3  14   14  14   3   8   4  ...   4   6   7   2   2   2   
    
           22  23  24  25  
    count   1   1   1   1  
    dim     8   6   5   8  
    
    [2 rows x 26 columns]
    Normalized Mutual Information Score :  0.8637423641817068
    Elapsed time :  23.1 sec // Total elapsed time :  563.5 sec
    ==================================================================================
    alpha for this iteration is  2.6609569969508446
    27 th iteration completed // # of clusters :  26
            0   1    2   3   4    5   6   7   8   9   ...  16  17  18  19  20  21  \
    count  114  11  134   2  19  110  91   1   1   1  ...   1   1   1   1   1   1   
    dim     14  14   14   3  14   14  14   3  10   2  ...   4   7   7   1   1   2   
    
           22  23  24  25  
    count   1   1   1   1  
    dim     8   8   5   7  
    
    [2 rows x 26 columns]
    Normalized Mutual Information Score :  0.8686210789444941
    Elapsed time :  23.7 sec // Total elapsed time :  678.3 sec
    ==================================================================================
    alpha for this iteration is  2.8677908637119076
    32 th iteration completed // # of clusters :  26
            0   1    2   3   4    5   6   7   8   9   ...  16  17  18  19  20  21  \
    count  114   7  134   2  13  114  97   1   1   1  ...   1   1   1   1   1   1   
    dim     14  14   14   4  14   14  14   3  12   3  ...   4   7   7   1   2   2   
    
           22  23  24  25  
    count   1   1   1   1  
    dim     8   8   6   7  
    
    [2 rows x 26 columns]
    Normalized Mutual Information Score :  0.8801171046931516
    Elapsed time :  26.4 sec // Total elapsed time :  797.0 sec
    ==================================================================================
    alpha for this iteration is  2.3655497951975675
    37 th iteration completed // # of clusters :  26
            0   1    2   3   4    5   6   7   8   9   ...  16  17  18  19  20  21  \
    count  114   8  134   2  12  113  98   1   1   1  ...   1   1   1   1   1   1   
    dim     14  14   14   6  14   14  14   3  13   5  ...   5   8   8   1   4   2   
    
           22  23  24  25  
    count   1   1   1   1  
    dim    10   6   4  10  
    
    [2 rows x 26 columns]
    Normalized Mutual Information Score :  0.8797454248309614
    Elapsed time :  23.0 sec // Total elapsed time :  912.9 sec
    ==================================================================================
    alpha for this iteration is  2.9104573782395753
    42 th iteration completed // # of clusters :  26
            0   1    2   3   4    5   6   7   8   9   ...  16  17  18  19  20  21  \
    count  114   4  134   2  11  117  99   1   1   1  ...   1   1   1   1   1   1   
    dim     14  13   14   5  14   14  14   2  13   4  ...   5   9   6   1   3   3   
    
           22  23  24  25  
    count   1   1   1   1  
    dim     8   5   3  11  
    
    [2 rows x 26 columns]
    Normalized Mutual Information Score :  0.8876793161342177
    Elapsed time :  23.4 sec // Total elapsed time :  1031.9 sec
    ==================================================================================
    alpha for this iteration is  2.5615500545098584
    47 th iteration completed // # of clusters :  26
            0    1   2   3    4    5   6   7   8   9   ...  16  17  18  19  20  \
    count  114  134   2   7  120  103   1   1   1   1  ...   1   1   1   1   1   
    dim     14   14   5  14   14   14   3  12   1   2  ...  11  12   7   2   3   
    
           21  22  23  24  25  
    count   1   1   1   1   1  
    dim     3   8   6   4  10  
    
    [2 rows x 26 columns]
    Normalized Mutual Information Score :  0.9001033041430261
    Elapsed time :  23.3 sec // Total elapsed time :  1148.6 sec
    ==================================================================================
    alpha for this iteration is  2.47323045128049
    52 th iteration completed // # of clusters :  25
            0    1   2   3    4    5   6   7   8   9   ...  15  16  17  18  19  \
    count  114  134   2   6  121  104   1   1   1   1  ...   1   1   1   1   1   
    dim     14   13   4  14   14   14   4  13   2   2  ...   3   8   5   2   3   
    
           20  21  22  23  24  
    count   1   1   1   1   1  
    dim     2   7   7   4  11  
    
    [2 rows x 25 columns]
    Normalized Mutual Information Score :  0.9051510837487619
    Elapsed time :  23.4 sec // Total elapsed time :  1265.6 sec
    ==================================================================================
    alpha for this iteration is  2.1790587063644002
    57 th iteration completed // # of clusters :  25
            0    1   2   3    4   5   6   7   8   9   ...  15  16  17  18  19  20  \
    count  114  134   2  11  121  99   1   1   1   1  ...   1   1   1   1   1   1   
    dim     14   13   4  14   14  14   5  12   3   2  ...   3   9   5   2   3   3   
    
           21  22  23  24  
    count   1   1   1   1  
    dim     7   5   5  10  
    
    [2 rows x 25 columns]
    Normalized Mutual Information Score :  0.8978145851311342
    Elapsed time :  23.1 sec // Total elapsed time :  1379.7 sec
    ==================================================================================
    alpha for this iteration is  1.9314936349004412
    62 th iteration completed // # of clusters :  25
            0    1   2   3    4    5   6   7   8   9   ...  15  16  17  18  19  \
    count  114  134   2   8  121  102   1   1   1   1  ...   1   1   1   1   1   
    dim     14   13   4  14   14   14   2  13   3   4  ...   4  10   6   1   4   
    
           20  21  22  23  24  
    count   1   1   1   1   1  
    dim     4   7   4   6  11  
    
    [2 rows x 25 columns]
    Normalized Mutual Information Score :  0.9019694717057004
    Elapsed time :  23.0 sec // Total elapsed time :  1494.8 sec
    ==================================================================================
    alpha for this iteration is  2.629562557725017
    67 th iteration completed // # of clusters :  25
            0    1   2   3    4    5   6   7   8   9   ...  15  16  17  18  19  \
    count  114  134   2   5  121  105   1   1   1   1  ...   1   1   1   1   1   
    dim     14   13   4  14   14   14   3  14   2   3  ...   5  10   5   2   3   
    
           20  21  22  23  24  
    count   1   1   1   1   1  
    dim     4  11   4   5   9  
    
    [2 rows x 25 columns]
    Normalized Mutual Information Score :  0.9069012510648811
    Elapsed time :  23.0 sec // Total elapsed time :  1610.0 sec
    ==================================================================================
    alpha for this iteration is  2.45462744530895
    72 th iteration completed // # of clusters :  24
            0    1   2   3    4    5   6   7   8   9   ...  14  15  16  17  18  \
    count  114  135   2   5  121  105   1   1   1   1  ...   1   1   1   1   1   
    dim     14   13   4  14   14   14   2  13   2   4  ...   4  10   3   4   4   
    
           19  20  21  22  23  
    count   1   1   1   1   1  
    dim     3   9   7   5  10  
    
    [2 rows x 24 columns]
    Normalized Mutual Information Score :  0.9104279258549057
    Elapsed time :  22.6 sec // Total elapsed time :  1723.1 sec
    ==================================================================================
    alpha for this iteration is  3.1031322633039755
    77 th iteration completed // # of clusters :  24
            0    1   2   3    4    5   6   7   8   9   ...  14  15  16  17  18  \
    count  114  135   2   4  121  106   1   1   1   1  ...   1   1   1   1   1   
    dim     14   13   5  14   14   14   3  13   2   5  ...   3  12   4   4   5   
    
           19  20  21  22  23  
    count   1   1   1   1   1  
    dim     3   9   5   6   9  
    
    [2 rows x 24 columns]
    Normalized Mutual Information Score :  0.9123255969426347
    Elapsed time :  22.8 sec // Total elapsed time :  1837.7 sec
    ==================================================================================
    alpha for this iteration is  2.5952146986849707
    82 th iteration completed // # of clusters :  24
            0    1   2   3    4    5   6   7   8   9   ...  14  15  16  17  18  \
    count  114  135   2   4  121  106   1   1   1   1  ...   1   1   1   1   1   
    dim     14   13   5  13   14   14   3  12   2   4  ...   3  13   5   2   5   
    
           19  20  21  22  23  
    count   1   1   1   1   1  
    dim     3  12   7   5   9  
    
    [2 rows x 24 columns]
    Normalized Mutual Information Score :  0.9123255969426347
    Elapsed time :  22.9 sec // Total elapsed time :  1952.3 sec
    ==================================================================================
    alpha for this iteration is  2.457154470050333
    87 th iteration completed // # of clusters :  23
            0    1   2   3    4    5   6   7   8   9   ...  13  14  15  16  17  \
    count  114  135   2   4  122  106   1   1   1   1  ...   1   1   1   1   1   
    dim     14   13   5  12   14   14   4  11   3   4  ...   5   6   5   1   5   
    
           18  19  20  21  22  
    count   1   1   1   1   1  
    dim     3  11   8   7   8  
    
    [2 rows x 23 columns]
    Normalized Mutual Information Score :  0.9158329571117765
    Elapsed time :  22.0 sec // Total elapsed time :  2071.5 sec
    ==================================================================================
    alpha for this iteration is  1.835177791228218
    92 th iteration completed // # of clusters :  22
            0    1   2    3    4   5   6   7   8   9   ...  12  13  14  15  16  \
    count  114  135   2  122  110   1   1   1   1   1  ...   1   1   1   1   1   
    dim     14   13   5   14   14   5   8   1   3   6  ...   4   7   4   2   4   
    
           17  18  19  20  21  
    count   1   1   1   1   1  
    dim     3  10   8   9   9  
    
    [2 rows x 22 columns]
    Normalized Mutual Information Score :  0.9263841669541721
    Elapsed time :  22.5 sec // Total elapsed time :  2183.0 sec
    ==================================================================================
    alpha for this iteration is  1.9027952077275037
    97 th iteration completed // # of clusters :  21
            0    1   2    3    4   5   6   7   8   9   ...  11  12  13  14  15  \
    count  114  135   2  123  110   1   1   1   1   1  ...   1   1   1   1   1   
    dim     14   13   5   14   14   3   9   1   4   7  ...  12   4   9   5   3   
    
           16  17  18  19  20  
    count   1   1   1   1   1  
    dim     4   3  11   8  11  
    
    [2 rows x 21 columns]
    Normalized Mutual Information Score :  0.9300057992828807
    Elapsed time :  21.2 sec // Total elapsed time :  2291.4 sec
    ==================================================================================
    alpha for this iteration is  2.4046022628413244
    102 th iteration completed // # of clusters :  20
             0    1  2    3    4  5   6  7  8  9  10  11  12  13  14  15  16  17  \
    count  114  135  2  123  111  1   1  1  1  1   1   1   1   1   1   1   1   1   
    dim     14   13  5   14   14  3  11  2  6  7  12  14   3   8   9   2   1   4   
    
           18  19  
    count   1   1  
    dim     6   9  
    Normalized Mutual Information Score :  0.9335908200463936
    Elapsed time :  21.3 sec // Total elapsed time :  2399.2 sec
    ==================================================================================
    alpha for this iteration is  2.0419095394323254
    107 th iteration completed // # of clusters :  20
             0    1  2    3    4  5   6  7  8  9  10  11  12  13  14  15  16  17  \
    count  114  135  2  123  111  1   1  1  1  1   1   1   1   1   1   1   1   1   
    dim     14   13  5   14   14  3  10  4  7  7  10  14   4   7   8   5   1   4   
    
           18  19  
    count   1   1  
    dim     6  10  
    Normalized Mutual Information Score :  0.9335908200463936
    Elapsed time :  21.2 sec // Total elapsed time :  2505.6 sec
    ==================================================================================
    alpha for this iteration is  2.581276708915583
    112 th iteration completed // # of clusters :  20
             0    1  2    3    4  5   6  7  8  9  10  11  12  13  14  15  16  17  \
    count  114  135  2  123  111  1   1  1  1  1   1   1   1   1   1   1   1   1   
    dim     14   13  7   14   14  2  11  3  8  6  12  14   6   8   9   6   2   4   
    
           18  19  
    count   1   1  
    dim     4  10  
    Normalized Mutual Information Score :  0.9335908200463936
    Elapsed time :  21.0 sec // Total elapsed time :  2612.0 sec
    ==================================================================================
    alpha for this iteration is  2.428682679936777
    117 th iteration completed // # of clusters :  19
             0    1  2    3    4  5  6  7  8  9  10  11  12  13  14  15  16  17  \
    count  114  136  2  123  111  1  1  1  1  1   1   1   1   1   1   1   1   1   
    dim     14   13  5   14   14  2  9  3  6  6  12   5   5  10   7   4   6   4   
    
           18  
    count   1  
    dim    10  
    Normalized Mutual Information Score :  0.9373332632326629
    Elapsed time :  23.1 sec // Total elapsed time :  2719.8 sec
    ==================================================================================
    alpha for this iteration is  1.1429853019695742
    122 th iteration completed // # of clusters :  19
             0    1  2    3    4  5  6  7  8  9  10  11  12  13  14  15  16  17  \
    count  114  136  2  123  111  1  1  1  1  1   1   1   1   1   1   1   1   1   
    dim     14   14  4   14   14  3  9  4  5  6  13   3   3  10   8   4   5   4   
    
           18  
    count   1  
    dim    12  
    Normalized Mutual Information Score :  0.9373332632326629
    Elapsed time :  20.8 sec // Total elapsed time :  2824.5 sec
    ==================================================================================
    alpha for this iteration is  1.4555202252079593
    127 th iteration completed // # of clusters :  19
             0    1  2    3    4  5  6  7  8  9  10  11  12  13  14  15  16  17  \
    count  114  136  2  123  111  1  1  1  1  1   1   1   1   1   1   1   1   1   
    dim     14   14  5   14   14  5  8  4  7  5  14   4   3  10   9   5   5   6   
    
           18  
    count   1  
    dim    11  
    Normalized Mutual Information Score :  0.9373332632326629
    Elapsed time :  21.1 sec // Total elapsed time :  2928.5 sec
    ==================================================================================
    alpha for this iteration is  1.3031294801578162
    132 th iteration completed // # of clusters :  18
             0    1  2    3    4  5  6  7  8  9  10  11  12  13  14  15  16  17
    count  114  136  2  124  111  1  1  1  1  1   1   1   1   1   1   1   1   1
    dim     14   14  5   14   14  3  8  3  8  6  11   2   5  11   5   6   4  12
    Normalized Mutual Information Score :  0.9410463931103893
    Elapsed time :  20.6 sec // Total elapsed time :  3031.6 sec
    ==================================================================================
    alpha for this iteration is  1.578588457857095
    137 th iteration completed // # of clusters :  18
             0    1  2    3    4  5  6  7  8  9  10  11  12  13  14  15  16  17
    count  114  136  2  124  111  1  1  1  1  1   1   1   1   1   1   1   1   1
    dim     14   14  4   14   14  4  9  4  9  6  11   2   8  13   8   4   3   9
    Normalized Mutual Information Score :  0.9410463931103893
    Elapsed time :  20.6 sec // Total elapsed time :  3134.9 sec
    ==================================================================================
    alpha for this iteration is  1.55507712386363
    142 th iteration completed // # of clusters :  17
             0    1  2    3    4  5  6  7  8  9  10  11  12  13  14  15  16
    count  114  136  2  125  111  1  1  1  1  1   1   1   1   1   1   1   1
    dim     14   13  4   14   14  2  9  4  7  4  10   2   8   9   3   5  13
    Normalized Mutual Information Score :  0.9447942683217329
    Elapsed time :  21.1 sec // Total elapsed time :  3238.2 sec
    ==================================================================================
    alpha for this iteration is  2.4083009061291243
    147 th iteration completed // # of clusters :  17
             0    1  2    3    4  5  6  7   8  9  10  11  12  13  14  15  16
    count  114  136  2  125  111  1  1  1   1  1   1   1   1   1   1   1   1
    dim     14   13  4   14   14  3  8  6  10  6  11   4   9  11   3   5  10
    Normalized Mutual Information Score :  0.9447942683217329
    Elapsed time :  20.1 sec // Total elapsed time :  3339.8 sec
    ==================================================================================
    alpha for this iteration is  1.7227428412627221
    152 th iteration completed // # of clusters :  16
             0    1  2    3    4  5  6  7   8  9  10  11  12  13  14  15
    count  114  137  2  125  111  1  1  1   1  1   1   1   1   1   1   1
    dim     14   13  6   14   14  4  6  6  10  5   8   3   8   3   5   8
    Normalized Mutual Information Score :  0.9486320454228061
    Elapsed time :  21.0 sec // Total elapsed time :  3446.8 sec
    ==================================================================================
    alpha for this iteration is  1.7788072623208673
    157 th iteration completed // # of clusters :  16
             0    1  2    3    4  5  6  7   8  9  10  11  12  13  14  15
    count  114  137  2  125  111  1  1  1   1  1   1   1   1   1   1   1
    dim     14   13  8   14   14  4  8  6  11  5   8   4  10   4   3   9
    Normalized Mutual Information Score :  0.9486320454228061
    Elapsed time :  20.0 sec // Total elapsed time :  3547.9 sec
    ==================================================================================
    alpha for this iteration is  1.9339266116062346
    162 th iteration completed // # of clusters :  16
             0    1    2    3  4   5  6  7  8  9  10  11  12  13  14  15
    count  114  137  126  111  1   1  1  1  1  1   1   1   1   1   1   1
    dim     14   13   14   14  4  10  6  9  6  9   5   7  10   3   3  11
    Normalized Mutual Information Score :  0.9515366465326283
    Elapsed time :  20.4 sec // Total elapsed time :  3648.4 sec
    ==================================================================================
    alpha for this iteration is  1.5115091481332235
    167 th iteration completed // # of clusters :  16
             0    1    2    3   4  5   6  7  8  9  10  11  12  13  14  15
    count  114  137  125  111   2  1   1  1  1  1   1   1   1   1   1   1
    dim     14   13   14   14  12  2  11  6  8  4   8   5   3   4   5  11
    Normalized Mutual Information Score :  0.9486320454228062
    Elapsed time :  23.1 sec // Total elapsed time :  3752.1 sec
    ==================================================================================
    alpha for this iteration is  1.6530008609455416
    172 th iteration completed // # of clusters :  16
             0    1    2    3   4  5  6  7  8   9  10  11  12  13  14  15
    count  114  137  124  111   2  2  1  1  1   1   1   1   1   1   1   1
    dim     14   14   14   14  11  3  2  9  4  10   4   7   7   3   2  10
    Normalized Mutual Information Score :  0.9457503020609286
    Elapsed time :  21.4 sec // Total elapsed time :  3868.9 sec
    ==================================================================================
    alpha for this iteration is  1.476992377055069
    177 th iteration completed // # of clusters :  16
             0    1    2    3   4  5  6  7  8  9  10  11  12  13  14  15
    count  114  137  124  111   2  2  1  1  1  1   1   1   1   1   1   1
    dim     14   14   14   14  10  4  4  9  3  7   4   7   5   3   2  11
    Normalized Mutual Information Score :  0.9457503020609286
    Elapsed time :  21.5 sec // Total elapsed time :  3976.9 sec
    ==================================================================================
    alpha for this iteration is  1.8713457671398686
    182 th iteration completed // # of clusters :  16
             0    1    2    3   4  5  6   7  8  9  10  11  12  13  14  15
    count  114  137  124  111   2  2  1   1  1  1   1   1   1   1   1   1
    dim     14   14   14   14  10  4  5  11  4  7   5   7   4   2   3  13
    Normalized Mutual Information Score :  0.9457503020609286
    Elapsed time :  19.8 sec // Total elapsed time :  4076.8 sec
    ==================================================================================
    alpha for this iteration is  1.4385273257451405
    187 th iteration completed // # of clusters :  16
             0    1    2    3   4  5  6  7  8  9  10  11  12  13  14  15
    count  114  137  124  111   2  2  1  1  1  1   1   1   1   1   1   1
    dim     14   13   14   14  13  4  4  9  4  7   2   7   3   2   2  13
    Normalized Mutual Information Score :  0.9457503020609286
    Elapsed time :  34.2 sec // Total elapsed time :  4191.4 sec
    ==================================================================================
    alpha for this iteration is  2.1604291555132877
    192 th iteration completed // # of clusters :  16
             0    1    2    3   4  5  6   7  8  9  10  11  12  13  14  15
    count  114  137  124  111   2  2  1   1  1  1   1   1   1   1   1   1
    dim     14   13   14   14  12  5  4  10  3  8   6   7   3   3   2  14
    Normalized Mutual Information Score :  0.9457503020609286
    Elapsed time :  28.6 sec // Total elapsed time :  4323.4 sec
    ==================================================================================
    alpha for this iteration is  2.1064456101731532
    197 th iteration completed // # of clusters :  16
             0    1    2    3   4  5  6   7  8  9  10  11  12  13  14  15
    count  114  137  125  111   1  2  1   1  1  1   1   1   1   1   1   1
    dim     14   13   14   14  11  3  5  13  6  8   6   9   4   2   3  12
    Normalized Mutual Information Score :  0.9486320454228062
    Elapsed time :  29.3 sec // Total elapsed time :  4473.0 sec
    ==================================================================================
    alpha for this iteration is  1.5079002425954362
    202 th iteration completed // # of clusters :  14
             0    1    2    3  4  5  6  7  8  9  10  11  12  13
    count  114  138  126  111  2  1  1  1  1  1   1   1   1   1
    dim     14   13   14   14  3  8  4  8  6  8   4   3   3  11
    Normalized Mutual Information Score :  0.9563511128509747
    Elapsed time :  30.5 sec // Total elapsed time :  4619.2 sec
    ==================================================================================
    alpha for this iteration is  1.066061144127872
    207 th iteration completed // # of clusters :  13
             0    1    2    3  4  5  6  7  8  9  10  11  12
    count  114  138  126  112  2  1  1  1  1  1   1   1   1
    dim     14   13   14   14  4  9  4  9  6  9   2   5   1
    Normalized Mutual Information Score :  0.9601485493777115
    Elapsed time :  27.2 sec // Total elapsed time :  4757.4 sec
    ==================================================================================
    alpha for this iteration is  1.2084285051542203
    212 th iteration completed // # of clusters :  13
             0    1    2    3  4  5  6   7   8  9  10  11  12
    count  114  138  126  112  2  1  1   1   1  1   1   1   1
    dim     14   13   14   14  3  9  5  13  10  8   4   4   1
    Normalized Mutual Information Score :  0.9601485493777115
    Elapsed time :  27.2 sec // Total elapsed time :  4894.5 sec
    ==================================================================================
    alpha for this iteration is  1.1156840502317462
    217 th iteration completed // # of clusters :  13
             0    1    2    3  4  5  6   7   8  9  10  11  12
    count  114  138  126  112  2  1  1   1   1  1   1   1   1
    dim     14   13   14   14  3  9  4  13  10  9   7   4   1
    Normalized Mutual Information Score :  0.9601485493777115
    Elapsed time :  27.5 sec // Total elapsed time :  5039.3 sec
    ==================================================================================
    alpha for this iteration is  0.9840763746252383
    222 th iteration completed // # of clusters :  13
             0    1    2    3  4  5  6   7   8  9  10  11  12
    count  114  138  126  112  2  1  1   1   1  1   1   1   1
    dim     14   14   14   14  3  8  3  14  10  7   6   3   4
    Normalized Mutual Information Score :  0.9601485493777115
    Elapsed time :  27.3 sec // Total elapsed time :  5175.3 sec
    ==================================================================================
    alpha for this iteration is  0.9536259079455116
    227 th iteration completed // # of clusters :  13
             0    1    2    3  4  5  6   7   8  9  10  11  12
    count  114  138  126  112  2  1  1   1   1  1   1   1   1
    dim     14   14   14   14  3  9  4  13  10  8   3   3   4
    Normalized Mutual Information Score :  0.9601485493777115
    Elapsed time :  26.8 sec // Total elapsed time :  5321.0 sec
    ==================================================================================
    alpha for this iteration is  1.8261637184628385
    232 th iteration completed // # of clusters :  12
             0    1    2    3  4  5  6   7  8  9  10  11
    count  114  139  126  112  2  1  1   1  1  1   1   1
    dim     14   14   14   14  3  8  5  13  8  7   2   3
    Normalized Mutual Information Score :  0.9641221263025105
    Elapsed time :  25.7 sec // Total elapsed time :  5449.4 sec
    ==================================================================================
    alpha for this iteration is  1.4988706327862493
    237 th iteration completed // # of clusters :  12
             0    1    2    3  4  5  6   7  8  9  10  11
    count  114  139  126  112  2  1  1   1  1  1   1   1
    dim     14   14   14   14  4  7  5  14  8  9   3   4
    Normalized Mutual Information Score :  0.9641221263025105
    Elapsed time :  26.2 sec // Total elapsed time :  5582.2 sec
    ==================================================================================
    alpha for this iteration is  0.888046254209504
    242 th iteration completed // # of clusters :  11
             0    1    2    3  4  5  6   7  8  9  10
    count  114  140  126  112  2  1  1   1  1  1   1
    dim     14   14   14   14  3  6  5  13  8  3   2
    Normalized Mutual Information Score :  0.9681336095611406
    Elapsed time :  27.3 sec // Total elapsed time :  5716.4 sec
    ==================================================================================
    alpha for this iteration is  1.2168075173311252
    247 th iteration completed // # of clusters :  9
             0    1    2    3  4  5  6  7  8
    count  114  142  126  112  2  1  1  1  1
    dim     13   14   14   14  4  8  3  5  4
    Normalized Mutual Information Score :  0.9762723081879234
    Elapsed time :  24.1 sec // Total elapsed time :  5841.3 sec
    ==================================================================================
    alpha for this iteration is  1.147599441096996
    252 th iteration completed // # of clusters :  9
             0    1    2    3  4  5  6  7  8
    count  114  142  126  112  2  1  1  1  1
    dim     13   14   14   14  4  7  3  6  3
    Normalized Mutual Information Score :  0.9762723081879234
    Elapsed time :  25.6 sec // Total elapsed time :  5963.5 sec
    ==================================================================================
    alpha for this iteration is  0.8324305860490426
    257 th iteration completed // # of clusters :  9
             0    1    2    3  4  5  6  7  8
    count  114  142  126  112  2  1  1  1  1
    dim     13   14   14   14  5  7  3  8  3
    Normalized Mutual Information Score :  0.9762723081879234
    Elapsed time :  25.1 sec // Total elapsed time :  6087.8 sec
    ==================================================================================
    alpha for this iteration is  1.0927917447084554
    262 th iteration completed // # of clusters :  9
             0    1    2    3  4  5  6  7  8
    count  114  142  126  112  2  1  1  1  1
    dim     13   14   14   14  5  7  3  9  3
    Normalized Mutual Information Score :  0.9762723081879234
    Elapsed time :  24.5 sec // Total elapsed time :  6211.8 sec
    ==================================================================================
    alpha for this iteration is  0.40080952452387
    267 th iteration completed // # of clusters :  9
             0    1    2    3  4  5  6  7  8
    count  114  142  126  112  2  1  1  1  1
    dim     13   14   14   14  6  7  5  8  3
    Normalized Mutual Information Score :  0.9762723081879234
    Elapsed time :  24.4 sec // Total elapsed time :  6335.8 sec
    ==================================================================================
    alpha for this iteration is  0.8026111469398863
    272 th iteration completed // # of clusters :  9
             0    1    2    3  4  5  6  7  8
    count  114  142  126  112  2  1  1  1  1
    dim     13   14   14   14  6  6  6  8  3
    Normalized Mutual Information Score :  0.9762723081879234
    Elapsed time :  24.9 sec // Total elapsed time :  6460.2 sec
    ==================================================================================
    alpha for this iteration is  0.8577480081024389
    277 th iteration completed // # of clusters :  9
             0    1    2    3  4  5  6   7  8
    count  114  142  126  112  2  1  1   1  1
    dim     13   13   14   14  5  9  3  10  2
    Normalized Mutual Information Score :  0.9762723081879234
    Elapsed time :  25.0 sec // Total elapsed time :  6610.8 sec
    ==================================================================================
    alpha for this iteration is  1.0215874669343572
    282 th iteration completed // # of clusters :  9
             0    1    2    3  4  5  6   7  8
    count  114  142  126  112  2  1  1   1  1
    dim     13   13   14   14  5  8  2  12  2
    Normalized Mutual Information Score :  0.9762723081879234
    Elapsed time :  24.9 sec // Total elapsed time :  6734.5 sec
    ==================================================================================
    alpha for this iteration is  0.5386106236489087
    287 th iteration completed // # of clusters :  9
             0    1    2    3  4  5  6   7  8
    count  114  142  126  112  2  1  1   1  1
    dim     13   13   14   14  4  7  3  10  4
    Normalized Mutual Information Score :  0.9762723081879234
    Elapsed time :  24.2 sec // Total elapsed time :  6866.1 sec
    ==================================================================================
    alpha for this iteration is  0.9217811222530695
    292 th iteration completed // # of clusters :  8
             0    1    2    3  4  5  6  7
    count  114  142  127  112  2  1  1  1
    dim     13   13   14   14  3  8  4  2
    Normalized Mutual Information Score :  0.9803177072176641
    Elapsed time :  26.5 sec // Total elapsed time :  6991.2 sec
    ==================================================================================
    alpha for this iteration is  0.41464980503862897
    297 th iteration completed // # of clusters :  7
             0    1    2    3  4  5  6
    count  115  142  127  112  2  1  1
    dim     13   14   14   14  2  3  2
    Normalized Mutual Information Score :  0.9843268747706517
    Elapsed time :  22.3 sec // Total elapsed time :  7104.3 sec
    ==================================================================================
    alpha for this iteration is  0.8354143635169674
    302 th iteration completed // # of clusters :  7
             0    1    2    3  4  5  6
    count  115  142  127  112  2  1  1
    dim     13   14   14   14  3  6  4
    Normalized Mutual Information Score :  0.9843268747706517
    Elapsed time :  22.0 sec // Total elapsed time :  7224.0 sec
    ==================================================================================
    alpha for this iteration is  0.6376601139305584
    307 th iteration completed // # of clusters :  7
             0    1    2    3  4  5  6
    count  115  142  127  112  2  1  1
    dim     13   13   14   14  4  9  3
    Normalized Mutual Information Score :  0.9843268747706517
    Elapsed time :  23.1 sec // Total elapsed time :  7345.7 sec
    ==================================================================================
    alpha for this iteration is  0.48212465771496804
    312 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  4  2
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  22.4 sec // Total elapsed time :  7453.3 sec
    ==================================================================================
    alpha for this iteration is  0.46526011421740443
    317 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  4  3
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  20.4 sec // Total elapsed time :  7557.6 sec
    ==================================================================================
    alpha for this iteration is  0.6960711760353144
    322 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  4  2
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  21.2 sec // Total elapsed time :  7662.5 sec
    ==================================================================================
    alpha for this iteration is  0.5459914402848157
    327 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  4  4
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  20.8 sec // Total elapsed time :  7767.6 sec
    ==================================================================================
    alpha for this iteration is  0.19743964395649763
    332 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  3  3
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  21.2 sec // Total elapsed time :  7875.1 sec
    ==================================================================================
    alpha for this iteration is  0.2183353082600598
    337 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  5  2
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  25.8 sec // Total elapsed time :  7989.3 sec
    ==================================================================================
    alpha for this iteration is  1.062169852254682
    342 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  3  3
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  23.2 sec // Total elapsed time :  8104.0 sec
    ==================================================================================
    alpha for this iteration is  0.8212852921941703
    347 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  3  2
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  32.1 sec // Total elapsed time :  8238.3 sec
    ==================================================================================
    alpha for this iteration is  0.8710463701127558
    352 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  3  3
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  24.4 sec // Total elapsed time :  8361.9 sec
    ==================================================================================
    alpha for this iteration is  0.3971406393636921
    357 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  4  1
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  24.2 sec // Total elapsed time :  8484.5 sec
    ==================================================================================
    alpha for this iteration is  0.6696504295547139
    362 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  3  3
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  23.6 sec // Total elapsed time :  8602.9 sec
    ==================================================================================
    alpha for this iteration is  0.39242723660608464
    367 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  3  2
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  24.5 sec // Total elapsed time :  8754.5 sec
    ==================================================================================
    alpha for this iteration is  0.6004088517350505
    372 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  3  5
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  22.6 sec // Total elapsed time :  8883.6 sec
    ==================================================================================
    alpha for this iteration is  0.7348343100768665
    377 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  3  7
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  29.4 sec // Total elapsed time :  9014.7 sec
    ==================================================================================
    alpha for this iteration is  0.6753678409330522
    382 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  5  7
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  36.7 sec // Total elapsed time :  9173.1 sec
    ==================================================================================
    alpha for this iteration is  0.2512091999990442
    387 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  2  6
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  30.1 sec // Total elapsed time :  9303.6 sec
    ==================================================================================
    alpha for this iteration is  0.18425751793212097
    392 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  3  5
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  21.8 sec // Total elapsed time :  9445.8 sec
    ==================================================================================
    alpha for this iteration is  0.6092228138725782
    397 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  3  4
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  24.1 sec // Total elapsed time :  9579.2 sec
    ==================================================================================
    alpha for this iteration is  0.22767939880089422
    402 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     14   13   14   14  2  2
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  39.6 sec // Total elapsed time :  9729.4 sec
    ==================================================================================
    alpha for this iteration is  0.27785039145914847
    407 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     14   13   14   14  2  4
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  30.6 sec // Total elapsed time :  9879.3 sec
    ==================================================================================
    alpha for this iteration is  0.6059413654566161
    412 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     14   13   14   14  3  5
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  26.7 sec // Total elapsed time :  10018.9 sec
    ==================================================================================
    alpha for this iteration is  0.4195639129581981
    417 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     14   13   14   14  3  5
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  21.3 sec // Total elapsed time :  10143.8 sec
    ==================================================================================
    alpha for this iteration is  0.3533660724665608
    422 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     14   13   14   14  2  5
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  21.4 sec // Total elapsed time :  10251.6 sec
    ==================================================================================
    alpha for this iteration is  0.4332385027917392
    427 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     14   13   14   14  4
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  20.0 sec // Total elapsed time :  10357.6 sec
    ==================================================================================
    alpha for this iteration is  0.5272093506111836
    432 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     14   13   14   14  2
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  19.3 sec // Total elapsed time :  10460.0 sec
    ==================================================================================
    alpha for this iteration is  0.49858772181012334
    437 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     14   13   14   14  4
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  19.3 sec // Total elapsed time :  10558.4 sec
    ==================================================================================
    alpha for this iteration is  0.864231578385934
    442 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     14   13   14   14  2
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  20.0 sec // Total elapsed time :  10656.1 sec
    ==================================================================================
    alpha for this iteration is  0.3552302656676545
    447 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     14   13   14   14  2
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  19.9 sec // Total elapsed time :  10766.5 sec
    ==================================================================================
    alpha for this iteration is  0.5545155199023056
    452 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     14   13   14   14  2
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  25.2 sec // Total elapsed time :  10885.1 sec
    ==================================================================================
    alpha for this iteration is  0.5039020295245679
    457 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     14   13   14   14  2
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  20.0 sec // Total elapsed time :  10993.9 sec
    ==================================================================================
    alpha for this iteration is  0.17119587804671269
    462 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     13   13   14   14  3
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  20.7 sec // Total elapsed time :  11094.0 sec
    ==================================================================================
    alpha for this iteration is  0.4273876085016931
    467 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     13   13   14   14  3
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  19.8 sec // Total elapsed time :  11192.2 sec
    ==================================================================================
    alpha for this iteration is  0.39054895529703537
    472 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     13   13   14   14  5
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  19.5 sec // Total elapsed time :  11290.6 sec
    ==================================================================================
    alpha for this iteration is  0.3532473208507237
    477 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     13   13   14   14  6
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  20.3 sec // Total elapsed time :  11391.9 sec
    ==================================================================================
    alpha for this iteration is  0.5354661291919014
    482 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  128  113  1
    dim     13   13   14   14  6
    Normalized Mutual Information Score :  0.9957796184419704
    Elapsed time :  19.8 sec // Total elapsed time :  11489.8 sec
    ==================================================================================
    alpha for this iteration is  0.18242585370675085
    487 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  18.7 sec // Total elapsed time :  11589.1 sec
    ==================================================================================
    alpha for this iteration is  0.45854391700428
    492 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  20.3 sec // Total elapsed time :  11694.3 sec
    ==================================================================================
    alpha for this iteration is  0.23849154731458871
    497 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  24.9 sec // Total elapsed time :  11815.1 sec
    ==================================================================================
    alpha for this iteration is  0.2679418540760964
    502 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  30.4 sec // Total elapsed time :  11927.4 sec
    ==================================================================================
    alpha for this iteration is  0.2294289502388042
    507 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  23.0 sec // Total elapsed time :  12034.1 sec
    ==================================================================================
    alpha for this iteration is  0.28519590235242787
    512 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  20.6 sec // Total elapsed time :  12130.3 sec
    ==================================================================================
    alpha for this iteration is  0.28827498382637046
    517 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  19.3 sec // Total elapsed time :  12225.8 sec
    ==================================================================================
    alpha for this iteration is  0.283552887856448
    522 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  18.0 sec // Total elapsed time :  12317.8 sec
    ==================================================================================
    alpha for this iteration is  0.21660200432827006
    527 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  19.4 sec // Total elapsed time :  12413.0 sec
    ==================================================================================
    alpha for this iteration is  0.39296497139797454
    532 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  20.6 sec // Total elapsed time :  12510.5 sec
    ==================================================================================
    alpha for this iteration is  0.19464188955818096
    537 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  25.9 sec // Total elapsed time :  12627.1 sec
    ==================================================================================
    alpha for this iteration is  0.6367301054677227
    542 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  37.8 sec // Total elapsed time :  12759.8 sec
    ==================================================================================
    alpha for this iteration is  0.16274867807961255
    547 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  18.2 sec // Total elapsed time :  12874.4 sec
    ==================================================================================
    alpha for this iteration is  0.4384199532466777
    552 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  20.3 sec // Total elapsed time :  12987.4 sec
    ==================================================================================
    alpha for this iteration is  0.13825012988664676
    557 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  17.0 sec // Total elapsed time :  13071.3 sec
    ==================================================================================
    alpha for this iteration is  0.432598335735783
    562 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  16.7 sec // Total elapsed time :  13164.0 sec
    ==================================================================================
    alpha for this iteration is  0.15112897075214785
    567 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  19.9 sec // Total elapsed time :  13255.7 sec
    ==================================================================================
    alpha for this iteration is  0.20138277325778514
    572 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  16.7 sec // Total elapsed time :  13339.1 sec
    ==================================================================================
    alpha for this iteration is  0.24468610408152128
    577 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  16.7 sec // Total elapsed time :  13428.7 sec
    ==================================================================================
    alpha for this iteration is  0.22714032999894238
    582 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  25.4 sec // Total elapsed time :  13535.5 sec
    ==================================================================================


* 약 67번째 iteration(27분 경과)부터는, singleton cluster를 제외하면, cluster assignment를 안정적으로 포착하며 state space를 탐색하는 모습을 보였다.
* 312번째 iteration(124분 경과)부터는, 4개의 observation을 제외하고 생성되었던 cluster를 찾아감.
* 487번째 iteration(193분 경과)부터는 모든 cluster가 완전히 포착됨.
* 하지만 subspace의 dimension은 거의 포착하지 못하는 모습을 보였음. 
    * 이는 dimension의 birth-death를 탐색하는 RJMCMC step이 iteration 별로 한 번 씩만 수행되서 그런 것은 아닐까?
    * 혹은 $\Psi$의 diagonal element가 서로 같다는 제약을 두지 않아서 그런 것인가?
    * Identifiability problem



```python

```


```python

```


```python

```

공분산을 확인하기 위해 1000번째 iteration에서 중단해보았다.


```python
Cov_estimated_0 = np.matmul(Lambda_list[-2][0],Lambda_list[-2][0].transpose()) + Psi_list[-2][0]
Cov_estimated_1 = np.matmul(Lambda_list[-2][1],Lambda_list[-2][1].transpose()) + Psi_list[-2][1]
Cov_estimated_2 = np.matmul(Lambda_list[-2][2],Lambda_list[-2][2].transpose()) + Psi_list[-2][2]
```


```python
Cov_true_0 = np.matmul(true_W_list[0],true_W_list[0].transpose()) + np.diag(np.repeat(sigma,dim))
Cov_true_1 = np.matmul(true_W_list[1],true_W_list[1].transpose()) + np.diag(np.repeat(sigma,dim))
Cov_true_2 = np.matmul(true_W_list[2],true_W_list[2].transpose()) + np.diag(np.repeat(sigma,dim))
```


```python
np.mean(pd.DataFrame(mu_list[-1]).transpose()).values
```




    array([-0.60144159, -1.00312128,  6.81017517, -5.98066164,  3.06089913,
           -0.68590817,  2.20218758, 10.09724462, -6.71764645,  7.40141854])




```python
val1, vec1 = LA.eigh(Cov_estimated_0)
val1 = val1[np.argsort(val1)[::-1]]
vec1 = vec1[:,np.argsort(val1)[::-1]]

val2, vec2 = LA.eigh(Cov_true_0)
val2 = val2[np.argsort(val2)[::-1]]
vec2 = vec2[:,np.argsort(val2)[::-1]]

df = pd.DataFrame([val1,val2])
df.index = ["estimated","true"]
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>estimated</td>
      <td>329.078916</td>
      <td>130.283488</td>
      <td>109.604822</td>
      <td>82.693508</td>
      <td>62.868054</td>
      <td>35.275020</td>
      <td>22.869043</td>
      <td>14.263365</td>
      <td>1.603746</td>
      <td>0.819304</td>
    </tr>
    <tr>
      <td>true</td>
      <td>219.654519</td>
      <td>135.418909</td>
      <td>86.685768</td>
      <td>72.067475</td>
      <td>31.107793</td>
      <td>18.853932</td>
      <td>7.778586</td>
      <td>0.500000</td>
      <td>0.500000</td>
      <td>0.500000</td>
    </tr>
  </tbody>
</table>
</div>




```python
val1, vec1 = LA.eigh(Cov_estimated_1)
val1 = val1[np.argsort(val1)[::-1]]
vec1 = vec1[:,np.argsort(val1)[::-1]]

val2, vec2 = LA.eigh(Cov_true_1)
val2 = val2[np.argsort(val2)[::-1]]
vec2 = vec2[:,np.argsort(val2)[::-1]]

df = pd.DataFrame([val1,val2])
df.index = ["estimated","true"]
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>estimated</td>
      <td>372.460980</td>
      <td>151.439763</td>
      <td>110.270056</td>
      <td>52.170564</td>
      <td>38.193328</td>
      <td>29.405775</td>
      <td>26.793994</td>
      <td>12.544531</td>
      <td>4.594465</td>
      <td>2.666787</td>
    </tr>
    <tr>
      <td>true</td>
      <td>208.509514</td>
      <td>176.544938</td>
      <td>102.404130</td>
      <td>43.504023</td>
      <td>39.344547</td>
      <td>14.575308</td>
      <td>5.837318</td>
      <td>0.500000</td>
      <td>0.500000</td>
      <td>0.500000</td>
    </tr>
  </tbody>
</table>
</div>




```python
val1, vec1 = LA.eigh(Cov_estimated_2)
val1 = val1[np.argsort(val1)[::-1]]
vec1 = vec1[:,np.argsort(val1)[::-1]]

val2, vec2 = LA.eigh(Cov_true_2)
val2 = val2[np.argsort(val2)[::-1]]
vec2 = vec2[:,np.argsort(val2)[::-1]]

df = pd.DataFrame([val1,val2])
df.index = ["estimated","true"]
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>estimated</td>
      <td>186.767789</td>
      <td>75.729795</td>
      <td>53.145282</td>
      <td>36.255812</td>
      <td>11.054797</td>
      <td>7.618271</td>
      <td>2.059132</td>
      <td>0.847434</td>
      <td>0.614211</td>
      <td>0.446752</td>
    </tr>
    <tr>
      <td>true</td>
      <td>78.661702</td>
      <td>0.500000</td>
      <td>0.500000</td>
      <td>0.500000</td>
      <td>0.500000</td>
      <td>0.500000</td>
      <td>0.500000</td>
      <td>0.500000</td>
      <td>0.500000</td>
      <td>0.500000</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.DataFrame(Cov_true_1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>49.303275</td>
      <td>-5.359289</td>
      <td>-39.121282</td>
      <td>-5.170560</td>
      <td>34.344265</td>
      <td>22.636355</td>
      <td>27.632796</td>
      <td>-26.797958</td>
      <td>-33.531483</td>
      <td>9.225358</td>
    </tr>
    <tr>
      <td>1</td>
      <td>-5.359289</td>
      <td>62.196386</td>
      <td>-20.886464</td>
      <td>15.761558</td>
      <td>3.121088</td>
      <td>28.152674</td>
      <td>13.945363</td>
      <td>1.146782</td>
      <td>12.157007</td>
      <td>-19.532118</td>
    </tr>
    <tr>
      <td>2</td>
      <td>-39.121282</td>
      <td>-20.886464</td>
      <td>64.258537</td>
      <td>-10.370499</td>
      <td>-49.749939</td>
      <td>-16.911300</td>
      <td>-8.173606</td>
      <td>10.868177</td>
      <td>37.766306</td>
      <td>-14.611605</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-5.170560</td>
      <td>15.761558</td>
      <td>-10.370499</td>
      <td>27.133722</td>
      <td>3.728911</td>
      <td>-2.556426</td>
      <td>-28.451584</td>
      <td>32.441693</td>
      <td>-9.094869</td>
      <td>2.899292</td>
    </tr>
    <tr>
      <td>4</td>
      <td>34.344265</td>
      <td>3.121088</td>
      <td>-49.749939</td>
      <td>3.728911</td>
      <td>66.076467</td>
      <td>1.303619</td>
      <td>-6.357167</td>
      <td>-24.734922</td>
      <td>-46.314103</td>
      <td>41.632646</td>
    </tr>
    <tr>
      <td>5</td>
      <td>22.636355</td>
      <td>28.152674</td>
      <td>-16.911300</td>
      <td>-2.556426</td>
      <td>1.303619</td>
      <td>52.288960</td>
      <td>45.683166</td>
      <td>-8.184721</td>
      <td>12.848669</td>
      <td>-14.510235</td>
    </tr>
    <tr>
      <td>6</td>
      <td>27.632796</td>
      <td>13.945363</td>
      <td>-8.173606</td>
      <td>-28.451584</td>
      <td>-6.357167</td>
      <td>45.683166</td>
      <td>86.119082</td>
      <td>-43.401508</td>
      <td>28.253575</td>
      <td>-20.286585</td>
    </tr>
    <tr>
      <td>7</td>
      <td>-26.797958</td>
      <td>1.146782</td>
      <td>10.868177</td>
      <td>32.441693</td>
      <td>-24.734922</td>
      <td>-8.184721</td>
      <td>-43.401508</td>
      <td>73.585545</td>
      <td>15.134963</td>
      <td>-0.867855</td>
    </tr>
    <tr>
      <td>8</td>
      <td>-33.531483</td>
      <td>12.157007</td>
      <td>37.766306</td>
      <td>-9.094869</td>
      <td>-46.314103</td>
      <td>12.848669</td>
      <td>28.253575</td>
      <td>15.134963</td>
      <td>61.647062</td>
      <td>-22.304380</td>
    </tr>
    <tr>
      <td>9</td>
      <td>9.225358</td>
      <td>-19.532118</td>
      <td>-14.611605</td>
      <td>2.899292</td>
      <td>41.632646</td>
      <td>-14.510235</td>
      <td>-20.286585</td>
      <td>-0.867855</td>
      <td>-22.304380</td>
      <td>49.610742</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.DataFrame(Cov_estimated_1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>71.789094</td>
      <td>27.034750</td>
      <td>-50.402422</td>
      <td>-39.238673</td>
      <td>88.255522</td>
      <td>50.446378</td>
      <td>13.165013</td>
      <td>-10.520953</td>
      <td>-25.580492</td>
      <td>-15.740031</td>
    </tr>
    <tr>
      <td>1</td>
      <td>27.034750</td>
      <td>68.920760</td>
      <td>-14.906305</td>
      <td>-29.690904</td>
      <td>49.525630</td>
      <td>47.955623</td>
      <td>24.549956</td>
      <td>-10.407349</td>
      <td>14.177903</td>
      <td>-27.744206</td>
    </tr>
    <tr>
      <td>2</td>
      <td>-50.402422</td>
      <td>-14.906305</td>
      <td>68.195171</td>
      <td>9.296009</td>
      <td>-76.198700</td>
      <td>-28.276494</td>
      <td>-3.387225</td>
      <td>0.212711</td>
      <td>33.805356</td>
      <td>2.939601</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-39.238673</td>
      <td>-29.690904</td>
      <td>9.296009</td>
      <td>66.380210</td>
      <td>-77.845682</td>
      <td>-33.643032</td>
      <td>-29.259640</td>
      <td>27.548819</td>
      <td>-2.099174</td>
      <td>18.830883</td>
    </tr>
    <tr>
      <td>4</td>
      <td>88.255522</td>
      <td>49.525630</td>
      <td>-76.198700</td>
      <td>-77.845682</td>
      <td>187.657945</td>
      <td>56.405222</td>
      <td>20.072429</td>
      <td>-16.517963</td>
      <td>-45.271365</td>
      <td>-4.966363</td>
    </tr>
    <tr>
      <td>5</td>
      <td>50.446378</td>
      <td>47.955623</td>
      <td>-28.276494</td>
      <td>-33.643032</td>
      <td>56.405222</td>
      <td>76.365573</td>
      <td>24.197430</td>
      <td>-3.871924</td>
      <td>13.718823</td>
      <td>-28.380172</td>
    </tr>
    <tr>
      <td>6</td>
      <td>13.165013</td>
      <td>24.549956</td>
      <td>-3.387225</td>
      <td>-29.259640</td>
      <td>20.072429</td>
      <td>24.197430</td>
      <td>62.472864</td>
      <td>-39.568208</td>
      <td>16.921528</td>
      <td>-8.906284</td>
    </tr>
    <tr>
      <td>7</td>
      <td>-10.520953</td>
      <td>-10.407349</td>
      <td>0.212711</td>
      <td>27.548819</td>
      <td>-16.517963</td>
      <td>-3.871924</td>
      <td>-39.568208</td>
      <td>81.220202</td>
      <td>3.818670</td>
      <td>-11.108592</td>
    </tr>
    <tr>
      <td>8</td>
      <td>-25.580492</td>
      <td>14.177903</td>
      <td>33.805356</td>
      <td>-2.099174</td>
      <td>-45.271365</td>
      <td>13.718823</td>
      <td>16.921528</td>
      <td>3.818670</td>
      <td>52.716609</td>
      <td>-25.604115</td>
    </tr>
    <tr>
      <td>9</td>
      <td>-15.740031</td>
      <td>-27.744206</td>
      <td>2.939601</td>
      <td>18.830883</td>
      <td>-4.966363</td>
      <td>-28.380172</td>
      <td>-8.906284</td>
      <td>-11.108592</td>
      <td>-25.604115</td>
      <td>64.821816</td>
    </tr>
  </tbody>
</table>
</div>


