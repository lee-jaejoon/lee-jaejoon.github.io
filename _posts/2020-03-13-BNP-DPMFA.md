---
layout: post
title: "Dirichlet Process Mixture of Factor Analyzer"
tags: [Bayesian Nonparametrics]
comments: true
---

```python
import numpy as np
import pandas as pd
import random

from numpy import linalg as LA

import scipy.stats as stats
from scipy.stats import multivariate_normal, invwishart
from collections import Counter
from sklearn.cluster import KMeans
from sklearn.metrics.cluster import normalized_mutual_info_score

import matplotlib.pyplot as plt
import plotly.graph_objects as go

from Neal2000_MFA import Algorithm_8_MFA
from MFA_posterior import parameter_sample

import multiprocessing 
from multiprocessing import Pool
from functools import partial, reduce
import time
```

# 1. Generating data


```python
true_K = 4 # The true number of clusters : 0,1, ... , true_K-1
dim = 15 # The dimension of our sample space
N = 500 # The number of observations to generate

true_d = [np.random.randint(1,dim) for k in range(true_K)]# The true dimensions of each clusters. val: 1 ~ dim
true_mu_list = [(np.random.rand(dim,1)-0.5)*60 for k in range(true_K)] # The true mean vectors of each clusters. val: -10 ~ 10
true_W_list = [(np.random.rand(dim, true_d[k])-0.5)*10 for k in range(true_K)] # The true W matrices of each clusters. val: -5 ~ 5 

sigma = 0.1

#clusterprob = np.random.rand(1,true_K)[0]
clusterprob = list(np.repeat(N/true_K,true_K))
clusterprob = clusterprob/sum(clusterprob) # The cluster assignment probability to generate data

true_z = [np.random.choice(np.arange(true_K), p=clusterprob) for n in range(N)]
true_z_count = [true_z.count(k) for k in range(true_K)]

data = pd.DataFrame({})

for k in range(true_K):
    mean_k = true_mu_list[k]
    W_k = true_W_list[k]
    cov_k = np.matmul(W_k, W_k.transpose()) + np.diag(np.repeat(sigma,dim))
    n_k = true_z_count[k]
    
    df = pd.DataFrame(np.random.multivariate_normal(mean_k[:,0], cov_k, n_k))
    df.index = np.repeat(k,n_k)
    data = data.append(df)
    
data.columns = ['V'+str(val) for val in np.arange(1,dim+1)]
```


```python
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>V1</th>
      <th>V2</th>
      <th>V3</th>
      <th>V4</th>
      <th>V5</th>
      <th>V6</th>
      <th>V7</th>
      <th>V8</th>
      <th>V9</th>
      <th>V10</th>
      <th>V11</th>
      <th>V12</th>
      <th>V13</th>
      <th>V14</th>
      <th>V15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>-17.027587</td>
      <td>-36.351348</td>
      <td>-37.478123</td>
      <td>25.957548</td>
      <td>-16.592331</td>
      <td>-7.520300</td>
      <td>5.466696</td>
      <td>33.261372</td>
      <td>26.178091</td>
      <td>-11.414522</td>
      <td>35.726361</td>
      <td>-4.553333</td>
      <td>-19.476742</td>
      <td>-17.632172</td>
      <td>6.599922</td>
    </tr>
    <tr>
      <td>0</td>
      <td>-14.853615</td>
      <td>-38.960099</td>
      <td>-35.334548</td>
      <td>13.202306</td>
      <td>-19.380925</td>
      <td>-19.782543</td>
      <td>-4.867465</td>
      <td>28.805263</td>
      <td>31.174993</td>
      <td>-9.895027</td>
      <td>33.066063</td>
      <td>-7.232485</td>
      <td>-22.830395</td>
      <td>-23.515216</td>
      <td>0.076708</td>
    </tr>
    <tr>
      <td>0</td>
      <td>-22.869518</td>
      <td>-28.646954</td>
      <td>-33.692458</td>
      <td>11.795818</td>
      <td>-20.430765</td>
      <td>-18.621177</td>
      <td>-9.275940</td>
      <td>25.382077</td>
      <td>29.732905</td>
      <td>-2.293668</td>
      <td>27.541883</td>
      <td>-6.195451</td>
      <td>-18.855018</td>
      <td>-24.409180</td>
      <td>2.950909</td>
    </tr>
    <tr>
      <td>0</td>
      <td>-33.817122</td>
      <td>-28.493944</td>
      <td>-42.979389</td>
      <td>31.996120</td>
      <td>-13.169088</td>
      <td>-11.052886</td>
      <td>-3.017904</td>
      <td>29.013522</td>
      <td>21.255120</td>
      <td>-6.554552</td>
      <td>25.144934</td>
      <td>-3.748930</td>
      <td>-21.770406</td>
      <td>-28.029451</td>
      <td>1.749013</td>
    </tr>
    <tr>
      <td>0</td>
      <td>-22.983209</td>
      <td>-37.104099</td>
      <td>-35.418901</td>
      <td>15.624102</td>
      <td>-20.569184</td>
      <td>-22.405804</td>
      <td>5.608591</td>
      <td>32.502325</td>
      <td>30.532606</td>
      <td>-6.817886</td>
      <td>20.778679</td>
      <td>-8.611996</td>
      <td>-15.459400</td>
      <td>-31.803583</td>
      <td>5.352403</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-5.113880</td>
      <td>25.588680</td>
      <td>2.358271</td>
      <td>-28.522395</td>
      <td>22.556697</td>
      <td>-13.601695</td>
      <td>26.921473</td>
      <td>-17.828499</td>
      <td>-28.168902</td>
      <td>-18.423947</td>
      <td>-6.968528</td>
      <td>-14.595847</td>
      <td>-4.917201</td>
      <td>14.048643</td>
      <td>2.205619</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-6.174692</td>
      <td>23.979336</td>
      <td>4.988885</td>
      <td>-33.170151</td>
      <td>6.242494</td>
      <td>-10.697447</td>
      <td>37.114109</td>
      <td>-11.605661</td>
      <td>-24.660610</td>
      <td>-21.405182</td>
      <td>-3.104706</td>
      <td>-14.517690</td>
      <td>-4.197293</td>
      <td>35.937669</td>
      <td>19.094541</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4.264316</td>
      <td>26.929149</td>
      <td>6.198285</td>
      <td>-13.160207</td>
      <td>4.264595</td>
      <td>-17.980763</td>
      <td>21.297848</td>
      <td>-10.508099</td>
      <td>-22.834084</td>
      <td>-19.933416</td>
      <td>3.969016</td>
      <td>-8.435123</td>
      <td>1.608751</td>
      <td>7.875081</td>
      <td>6.462787</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-18.729982</td>
      <td>16.208263</td>
      <td>24.523535</td>
      <td>-20.903804</td>
      <td>45.589911</td>
      <td>-34.222392</td>
      <td>22.855339</td>
      <td>2.422174</td>
      <td>-27.312237</td>
      <td>-9.653131</td>
      <td>12.689959</td>
      <td>-20.911422</td>
      <td>-7.150545</td>
      <td>-10.819102</td>
      <td>-0.785856</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-19.345481</td>
      <td>32.336554</td>
      <td>13.844730</td>
      <td>-38.290888</td>
      <td>26.854893</td>
      <td>-5.193902</td>
      <td>39.636729</td>
      <td>-4.562352</td>
      <td>-30.972030</td>
      <td>-13.923027</td>
      <td>3.157088</td>
      <td>-25.301932</td>
      <td>-6.027334</td>
      <td>18.906508</td>
      <td>12.853261</td>
    </tr>
  </tbody>
</table>
<p>500 rows × 15 columns</p>
</div>



3개의 차원에 대해서만 그려본 모습.


```python
plotx, ploty, plotz = data.iloc[:,0],data.iloc[:,1],data.iloc[:,2]
fig = go.Figure(data=[go.Scatter3d(x=plotx, y=ploty, z=plotz,
                                   mode='markers', 
                                   marker=dict(size=2, color=data.index, colorscale='Viridis', opacity=1 ))])
fig.show()
```


<div>


            <div id="34d74526-b2b5-469f-91dc-d8ef0e7c247d" class="plotly-graph-div" style="height:525px; width:100%;"></div>
            <script type="text/javascript">
                require(["plotly"], function(Plotly) {
                    window.PLOTLYENV=window.PLOTLYENV || {};
    
                if (document.getElementById("34d74526-b2b5-469f-91dc-d8ef0e7c247d")) {
                    Plotly.newPlot(
                        '34d74526-b2b5-469f-91dc-d8ef0e7c247d',
                        [{"marker": {"color": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3], "colorscale": [[0.0, "#440154"], [0.1111111111111111, "#482878"], [0.2222222222222222, "#3e4989"], [0.3333333333333333, "#31688e"], [0.4444444444444444, "#26828e"], [0.5555555555555556, "#1f9e89"], [0.6666666666666666, "#35b779"], [0.7777777777777778, "#6ece58"], [0.8888888888888888, "#b5de2b"], [1.0, "#fde725"]], "opacity": 1, "size": 2}, "mode": "markers", "type": "scatter3d", "x": [-17.027587128963916, -14.853614621352362, -22.86951754677181, -33.81712242617662, -22.98320913288017, -24.04732162196181, -20.449136425201967, -23.82611658724823, -22.661538604213735, -27.547955879157726, -16.172404635715644, -19.65517425374845, -33.62885746461882, -19.75596931324494, -17.037152301777162, -32.4546359208732, -18.333732266060817, -28.886226105375563, -19.792196264105094, -30.37476993020188, -9.295603952399297, -34.827524380530875, -28.963279857810427, -15.999375668946275, -30.170171434152632, -16.719713432976413, -29.416870925878136, -15.667093193173159, -19.069803914979016, -29.374566761208815, -10.974299499263882, -17.84431344840074, -20.926675387384535, -28.96457046490346, -30.40309027425431, -29.548182961214344, -20.87103369127804, -20.448575883032824, -23.055809486235717, -28.429703777687596, -18.919931574293546, -14.607880244828578, -29.082139007960883, -13.506765468414379, -4.937402175312737, -16.45454958868308, -22.69383481168549, -15.497214823093028, -24.822663819299123, -20.18243383487581, -28.854797057301205, -21.120916612977453, -15.439672339998797, -14.063363091367902, -20.884678975208555, -26.41920979246117, -11.867277739384459, -20.724922857246654, -22.342323899249664, -13.386369109885024, -21.566610385335895, -14.50575767293185, -29.118018140655323, -21.683409051657176, -20.868441551499096, -23.1771578950157, -26.466545317160758, -14.523362436922763, -26.296016867300054, -23.454741967838803, -47.607566082372145, -15.007994368559206, -29.320620302862444, -18.41334212416922, -26.855760131812296, -20.40695798719391, -14.250339740555994, -15.55198057309551, -29.86885370673145, -30.247882337865157, -15.993305571756174, -29.62299095699, -41.408000426314175, -35.4951425693588, -9.58720860558568, -13.362826001834723, -21.358249316098718, -23.111601613155226, -16.053959309583817, 2.092022380304332, -8.210220683763433, -18.73696832510423, -21.45257944693114, -18.28379429233024, -9.329847497472239, -16.07491770765005, -15.427580856526463, -33.67677901077468, -28.929708920942165, -25.837808162667816, -10.62614846066099, -16.871603717388403, -21.906587807083707, -13.649183004573171, -28.46677305524227, -20.953910869610823, -13.802314513371915, -24.662935584174267, -6.693984175636773, -23.892078212815008, -6.695300495763018, -5.902636036614558, -29.79862013778409, -20.272456995932775, -20.442868879017233, -15.371596024254327, 0.28968638721099715, 9.709842360257744, 5.728370822550724, -16.31084882237783, -10.833194614127779, -10.632216597530492, -3.5563378630658313, 0.051882818835313316, -18.338101984399216, -9.233766103026143, 7.301065780470607, -28.28398166910212, -4.035121748143056, -7.286027368115063, -21.336793813438675, -1.3182272012540697, 2.78505012147067, -20.368894838013887, 4.769573881406062, -1.2055818202940092, -17.93931431246091, -22.114537404744965, -8.245119665813617, -29.96162952522691, -11.357437430902493, -20.430662367594124, -5.206716348282108, -1.8551554521647677, -19.32416180910625, -16.11189258554894, 10.10759995496315, 8.144015269042365, -23.460405378313506, -12.652685704952154, -6.861608162936643, -0.19365966740732965, -22.956542288187443, -20.67375799202982, -22.78437596047212, -5.469199314048688, -16.94620696747411, -0.6942788683802181, -0.7104253762955697, -13.881794158049773, -18.96561634542972, -16.173928104044307, -4.158406533512688, -9.762718646784803, 2.090180308783564, -16.21526519762921, -21.79436142074229, -21.159376107628567, -0.016488733155782143, -7.09023124075881, -20.03534402893754, -13.893834172307432, -12.22261622862451, -2.9709858309925767, -14.095029525158488, -14.466890144689842, -33.8144227842128, -13.223141755918917, -10.779507323601377, -22.422889290121205, -17.930147890079358, -5.30517058005952, 0.4834855738165711, -22.091328761595, -1.9745094650170056, 2.595093771545436, -19.841552480457697, -11.714523066949448, -3.7827265860929353, -28.268115803023832, -1.4663330226195193, -28.234931359038256, -0.3668751519446012, -15.478356447070833, -14.523879744123823, -17.964111616532225, -2.0379124293788013, -12.803955261937372, -15.656630341322861, -13.421802917462376, -26.750287137024284, -22.15952293357816, -33.405578288054166, -6.651953826574126, 1.2551915888950607, 0.8635838485046428, -15.870804222045248, -12.807453113027279, -17.231657733218206, -9.05539946857364, -24.285408055501392, -9.66887288518539, -23.26780294831034, -16.312347145712366, -8.286338139120447, -26.283656491250795, -18.265441045390027, -4.936645356953125, -10.74935862146829, -4.5695789710828105, -6.892681736003232, -2.8652122804177313, -14.460990839505076, -19.894608476512175, -21.45174819796505, -7.96619924509983, 1.0225270454823843, -10.111862353727089, -15.999154816163557, -22.79976710972658, -5.940576799870008, -23.512630159719606, -19.356290004974834, -2.262617448241162, -13.585015229318115, 6.694709264742764, -5.99366758866798, -11.943427468410317, -12.439663776403117, -8.213068623373044, -14.34244390971737, -1.6708326006480902, -21.129065184048926, 0.6340605265900638, -20.9496555410507, -20.180375978426305, -5.2908922471455, -11.12276018126066, -19.092894359152467, -8.438539189990237, 0.3985316497652889, -2.1097358419073036, -20.07802662398531, -22.758462541038227, -8.91209523746821, -20.099423373884946, -13.12957927361956, -1.2393679572413028, -6.963351766104857, 1.642862509251663, -5.838016881207429, -6.793426195406815, -2.240502399920871, -21.1110153051348, -4.207798362101714, 0.12916720797400894, -13.262500527627724, -2.084088965318136, -4.944789133150758, -8.415094202446596, 12.517099215842764, -9.19784667179501, 2.9709748654867623, 2.235953766592572, -7.665002099201977, -6.326968062655679, -5.005550745350296, -7.980212117331952, -5.373771450420789, -7.526967398672699, -11.869772174770612, -8.889844572241536, -4.347192878123761, -5.31082099206834, 1.542643475789057, 0.3367426563192404, -1.4784362695349544, -4.055020865257758, 3.26549008277446, 2.9490330849858886, 0.38348751963407945, -1.254789873409324, 11.345975849214826, -9.098299720500098, -2.0432198564953015, -12.22491500028548, -1.8633023599114606, -5.4808585868290445, -4.536854576814756, 2.4051741602231447, 5.8181596234168005, -8.464118024134889, -0.058427331363233304, -3.394163877884078, 5.272580945340314, -8.794655281035087, -2.7325386777165943, -7.014774453580989, -1.8651217650295746, -1.1682594626566862, -2.0047409457769074, -1.1848262119568471, -8.600802251179928, 1.52401109091086, 7.30391829594142, -7.702108610313306, -6.285918788348966, 3.6720470442891253, -3.3124709402575436, -2.1680046506973745, 10.852932048260858, -10.670894292585878, -7.4730059540229306, 10.602525273763423, -0.21911365597705412, -3.698748506667174, -9.25896717482231, -23.65055096429535, -5.432418762215386, -4.337269639011753, 4.408827756594386, -6.65151417512801, 0.1536072787876681, -4.179065516372377, 1.7787985651405265, 8.706804729764963, -4.996242026342237, -3.799056915138046, -1.1214332254422716, -2.184001580235094, -2.9506954279848165, -4.408694575606431, 1.460313583722538, -1.221381611522432, -7.965806013671592, -15.126227781939683, 0.15414597036581634, 0.41750793714340206, -7.61246799497344, -1.6498385348550133, -6.442866185794326, 0.5228489688055733, -7.514036635039881, -0.15175210019153562, -7.341162115403898, -10.274713152057146, 8.093211018672143, -3.0748473395710763, -5.307284666402104, -0.7451794453051739, -7.011309465697028, -10.252468793603871, -6.0842619976781664, 3.2827045001307757, -6.054258739408991, 0.020858678213912185, -5.67294169025868, -6.229643081910182, 3.710667285594438, -3.6150949150463765, -4.235029596022572, -6.196815028951161, -5.4526511773258655, 10.533374269423549, 0.9871953887683684, -0.7219824763952793, -3.126685029565653, -1.4584970045945962, -5.281190551326954, 1.0359120941768731, 1.3804701972833557, -14.464596481610023, 10.731772861927809, -2.9578749190332196, -13.006044279882351, 9.379102652156352, -3.137871024988254, -7.504820055905011, -7.598162706117692, 7.137353054863448, -15.77447976243388, 2.265434035933657, -0.42402013610946643, -10.406047205388738, -2.8669086498031087, 4.348700014030937, -7.04653734200331, -3.4970112667816786, -6.102300425463304, 0.17700415635748445, -8.76188581800958, -9.143178087477265, 2.625325113686152, -21.75392319409365, -7.347535324921114, -12.346147967247848, 15.657018668306351, -22.023938936534464, 4.3452778691800535, 23.24243199576759, -13.505689239008722, -2.6313677929958907, -1.1775816019739036, -8.715282142059824, 4.015910283153733, -24.498186149868275, 5.8116447227730355, 7.489144611670275, 9.768957785976182, -6.25235747997185, -7.973955773901335, -6.014037613048699, -12.47891551301126, -0.9258433082146995, -11.10783027026101, -18.498372666245583, 6.339715163822362, 2.9349566023099722, -24.015346522712555, -0.5539632436417792, 7.506248557275519, -7.2122063243820325, -22.14351268160948, -11.938329499470761, -1.3481215658617502, -9.252972093764237, -0.5487672714493863, -12.061045836999863, -17.944789165334846, -5.143249698794458, -12.651969084040456, 13.526500239689168, -28.89365747455944, -5.4292087922186045, -2.5772877799110634, -14.853523648767277, 0.90578518928766, 9.920248943105815, 0.4850987362691983, -0.017444724020896807, -4.906271109472467, -1.3335540021035373, -11.536460025227585, -4.296161832866405, -5.927823754823329, -7.417474701918757, -0.5860837968542478, -10.25096447663641, -14.765516838340808, -6.981351987694398, 15.046733053071668, 0.41213792831903806, -7.0326997834780105, -8.638371120356316, -16.18159378270206, -11.13066004237827, 13.852166023252293, -19.072580339843345, -9.748829014318671, -1.5570342460256659, -12.565195738210654, 2.1656659297377088, -11.622879578712809, -19.60290865335617, -13.2704055380966, 5.39061463732042, 0.08169666420798016, -3.473834219930431, 0.14834628520031679, 10.431944134860284, 11.95146084697158, -5.94425857414058, -15.933233071587678, -22.145013647562195, -9.333574899853861, -23.41525727066535, 2.1820926077412706, 3.505332647185, -0.8966940881350194, -3.992137650031717, -0.5661936340633718, -5.855024677191573, -25.788115029947527, -4.5120079522957965, -0.36463976090154926, -5.113879639331311, -6.17469237072431, 4.264315905919075, -18.729981747477808, -19.34548074531632], "y": [-36.35134750840583, -38.96009948566188, -28.646953765137344, -28.493944265299874, -37.10409869066156, -29.636838347916413, -35.64953491448877, -22.736271842539026, -27.58073662250566, -16.328899751737765, -36.91298379509758, -36.080859646545065, -25.21202316978486, -25.239691509109313, -26.96305074792638, -36.93012184920078, -27.002800460134804, -23.35581729587612, -38.280443529410746, -20.499237705609204, -33.88139606083536, -11.117679939838712, -24.795635484201743, -36.08702345069172, -25.46537885917316, -27.326745619281308, -23.69029964681277, -39.585358751331306, -36.29612770241503, -8.898506124950483, -28.8288856433053, -24.869625960182866, -35.4573841124601, -21.330450774067295, -28.11958426715069, -19.59361125838658, -21.119524937448375, -29.4123674343098, -32.62081074928048, -23.908721680973606, -42.01241981294821, -20.817691220516483, -33.585926764001975, -32.96422146702375, -37.80669856560253, -27.592636929893263, -26.874938684965734, -30.9154695690536, -15.45803286530502, -25.864807343430947, -35.03805002765959, -23.374507211050457, -26.64160617523716, -33.99577742289598, -21.35952841675931, -17.390130694297188, -42.72173701309789, -25.75344954434312, -17.638447697020204, -38.3283414074085, -24.033171129192773, -36.432466141831, -17.562879217237942, -38.41904604293507, -24.937563292282366, -23.22651230282829, -24.11276233701723, -38.08426091200913, -20.089565001561304, -24.370568770164432, -9.197518180648359, -33.037541349140426, -28.404669381687675, -32.24506472127082, -21.173169116559794, -27.24361322143302, -17.085121455365158, -20.833449986917437, -18.06126746073917, -25.778224969174808, -26.963447286894674, -29.003220394053265, -22.64113752764817, -14.803498926068015, -29.452038000962762, -31.95550653284341, -36.50450319617936, -24.453640269501932, -27.77308150892176, -48.98565819422777, -35.17801800616501, -33.120323210876016, -27.33071351863352, -24.093545169980633, -30.05736547747401, -38.32143074322541, -20.730524656904382, -25.647382861734453, -26.92824842211364, -26.48190439313339, -33.908676642135894, -29.315045401222136, -29.579983792057003, -33.17142049948182, -27.327874427129068, -40.50882562467838, -27.324168752631834, -16.972090605863425, -35.66306160980147, -19.514088286418, -39.10289108707758, -39.800053371299484, -16.435240210567564, -18.291126477744292, -32.34849291259982, 13.361423404253042, 23.416750774298848, 21.5492817720461, 13.825412603581006, 17.043899290788236, 9.707989284259916, 3.6678229215001172, 4.239966540442478, 11.72273655884981, 14.247468142624978, 7.053960228280288, 22.00577837391603, -1.6988124753164957, 23.309547745996678, 3.12052068047298, 14.614548032575511, 19.44791561232731, 16.261390439828556, 15.391345528177226, 9.920564800065266, 1.5487165313753142, 2.7192340639422445, 27.81318430889155, -0.4553834716260887, 16.70561835389118, 1.4588861139165736, -14.79971928273966, 20.57404211725617, 13.330317409658898, 9.644575880161188, -9.192735258638477, 16.49106698515117, 12.220613859191772, -1.2253778873918435, 14.705070211902548, 10.833656442664296, 12.550413943998398, 8.107117833931598, 10.605089076212654, 13.104676629052385, 17.520596808189566, -0.06991136453705238, 17.005170126366203, 4.523177358014748, -4.48067844569038, 10.202796222471141, 11.451298061639463, 1.3352382863308367, 7.213869835925213, 20.018837655547205, 4.848374182193863, 7.565264962518791, -5.012585110100417, 11.302673880229081, 8.023920771006697, 7.735646766207834, 9.69073170038296, -0.7245839301654318, 14.407200415050006, 10.606498648393025, 18.96585475812646, -1.8782006435657301, 14.18982682182167, 5.525926857045415, 1.205095468880577, 9.859826668706056, 24.199198962071044, 15.628656275111169, 18.081873728063314, 12.922147853837398, 8.926045834257762, 6.001022381443361, 8.481584878318893, 0.09687056069436473, 15.68093844745352, 1.6964546242333167, 8.045602880820223, 5.120867362336212, 2.142598413286768, 1.8668543067854042, 26.338402798005625, 18.267437775503772, 11.976535833618026, -5.370796045057263, 12.174730871028137, 7.7784814007160845, 12.345445718817604, -4.05068718256145, 28.755608098982933, 12.533630574956948, 0.124211772460745, 0.4369828431138316, 3.6658912779681794, 2.9566016584988386, 23.354361733258454, 20.695047110977804, 5.113656824675632, -7.426090921356417, 5.627670313901082, 17.601700720142034, -5.765802902284776, -1.6193832005569622, 19.470780471035013, -1.1127736667800434, -1.4989085733037193, 11.330343813163609, 2.3559407945121347, 12.365299619250166, -2.9995355635537173, 3.1004512170855865, 28.358524225636813, 6.264384128768025, 15.929185386126079, 18.629574879697934, 1.3031736074205913, 10.106370867742513, 3.9726118462276823, 13.941553721078389, 21.01186202445366, 12.854351185383521, 9.207738278130885, 12.970084649186312, 26.138918816663967, 14.731278990730775, 13.7891285901867, 16.913275154729295, 19.977598979374253, 7.8402606916048505, 2.328135642566684, 20.591441106675518, 7.241121857050466, 16.635180442234866, 17.27693782925602, -4.751257151453695, 13.360535211318627, 15.12905220492963, 2.045887893233365, 14.487071059310136, -5.238480620425374, -0.46433292158593176, 14.199916266978459, 3.182803752649062, 10.437228571041606, -2.583501192548475, -6.684600225995828, 7.032802539116794, -6.618094184292268, 0.41185265215307565, -3.5621953676607365, -6.5258188742855125, -11.111515122874218, -12.67683039285741, -7.321162372008752, -5.142453942752554, 3.7906662990763196, 2.338169326590705, 0.08264705539929906, 5.732200146760688, -5.587549004888196, -4.650429586431249, -3.7706483611109505, -0.597751799838977, -6.286497494715217, -2.571944373547215, 5.77609484236171, -5.025379260606339, -0.8889476745825013, -0.7545428339230404, -1.8214401594768241, -3.397022530468427, 0.08342621921737825, 4.97521619153906, 1.38530903934301, -7.669519047159321, 2.5544308566683145, 0.2546933245784415, -10.222383148069413, 1.5902747452523083, -2.027418180825952, -10.953055342488334, 2.570501033233748, -1.8541749634717184, 0.456762101203561, 9.324342914442623, -1.2332105490461371, -5.773081454662888, -2.230219768532893, -6.2418181764591, -9.60342513338886, 5.92691320340518, -0.7856313016980094, -1.8224948162767274, -6.474160370067903, -6.461454728279028, -4.060406877715593, 0.045165883322024314, -7.339041059176839, 6.780078042367444, 9.628026008165236, -1.8535865426254734, -7.927650356607952, -7.620596411082726, 0.21195228971728408, 2.824109894959323, -6.5981375259078305, -0.24502552791945265, -7.488582106778468, -5.328667145804935, 4.934815246347755, 1.7234370111943838, 0.04874981492256625, -2.558228328321243, -9.341944002997312, 9.061548050699514, -8.697740699544324, -5.046242813768317, -2.142608103790627, 4.273207642616118, -0.2858077422461227, -4.122511625579001, -0.2994945083442828, -15.590014321622585, 2.701690670105854, 4.56396158381683, 0.5745474713933163, -10.502291722972636, -2.289342239784379, 2.1403590043076206, -2.7776604711843205, -1.7025334768385907, -13.792234510019282, 0.5910841396635966, 2.6870785277685454, -9.064894895908354, 2.5537603164636846, -4.737357814134647, 5.401863213431218, -0.8987760242157705, 4.187048786508486, -0.6351663442696378, -3.525481662000775, -11.74116767347658, -3.825471661209873, -8.760858745284972, 0.48051675654820336, -5.623152208523361, -11.087020533586436, -1.1482513220697577, 1.4750587992194868, -7.942193758362574, -0.5883127612962746, -4.726975795326304, -14.161095869365857, -6.020080881383156, 1.7362892431342605, -5.137198402265444, -7.182738448508017, -0.23718694927542683, -0.43785441586413043, -5.209236819247285, -1.6467901581976547, 2.6729147122130192, -8.795380839275214, 0.942106552058708, 2.7205502003377213, -2.3846939352688636, -11.20550627043298, 5.729731622571768, -5.7180090825867005, -3.900524735226665, 1.1245179547036823, 5.180390346359136, 22.479718412607298, 26.670750633434025, 31.610583757883802, 27.67366418651883, 30.236156797200238, 6.9661492885172365, 24.13026024946089, 31.758751412343443, 21.665886696524424, 21.33322864245504, 28.086387710521358, 29.374394834487546, 20.24168145488734, 22.23208731843869, 22.08444719653931, 21.014780696405204, 11.973819387949659, 39.25875736452638, 8.28258067956797, 44.816810980594965, 14.119315553564068, 24.79943117531588, 38.31099051843425, 6.55545859654374, 32.05659158771806, 24.45258720019816, 25.017731370543178, 22.885897970952545, 11.717436566066404, 30.225030113595672, 22.347631085735625, 31.003968083794, 30.482541066100246, 7.3110768133968005, 31.69630491637701, 2.7289876543750395, 13.34619297591604, 21.20361353984804, 28.920742677831036, 17.347042107986415, 28.988854563393193, 13.967016331555545, 24.775809741653173, 25.970578181015952, 33.69471224992013, 17.337673068477404, 8.955250419861335, 11.274439321942378, 23.904681618217154, 32.8035406382362, 9.697861111917847, 21.1888876759857, 15.767367058238829, 28.776444469128663, 24.569207705704414, 6.531841496594197, 31.31412155801422, 8.751377726336328, 19.367541230028028, 12.671848497148307, 24.08827539087902, 4.92879052367503, 12.923456954981326, 23.01111884901977, 24.75724630856599, 19.384392595871592, 30.602059655416294, 16.772461587536874, 19.354639401113428, 24.043730333878077, 23.850349921004444, 9.34626717790752, 25.456983843947125, 34.37486240275658, 6.217767128090676, 0.7973640971369278, 16.058488658597305, 13.063806758086988, 6.661394409265133, 34.76487843949634, 24.440104055820182, 10.207987559087869, 16.73525627918999, 14.41055143048364, 22.702616631257754, 26.409626103837578, 9.80634884405841, 13.818770055208109, 30.29186565079467, 14.642626262426049, 9.476541023951905, 17.522845037908933, 33.33600165445704, 20.021913489314784, 24.97640414290279, 14.396625033006256, 14.72651179771177, 36.597866213451155, 11.825068342342258, 24.443304715846512, 26.517893139446894, 23.65483884847601, 27.043500626109676, 20.020798872742258, 17.10007830973556, -10.662950448923162, 22.35063946443579, 25.821413973329843, 25.58868030647435, 23.979336364826157, 26.929148945607288, 16.208262908662324, 32.336554397712774], "z": [-37.478122565996394, -35.33454795422914, -33.69245841127421, -42.979388772027505, -35.41890089362299, -36.76430310410251, -39.45873885868842, -19.688265938745957, -24.641019853611407, -21.11801986758227, -39.687017990898745, -38.99479809847338, -40.025858872701235, -19.24163230646225, -26.830222903997658, -40.19556134159984, -30.450919042582118, -32.2256853144057, -39.07257914109185, -22.944501299513867, -32.2524687037753, -23.550203143646737, -27.10774423288737, -36.06639684129117, -34.503314387306915, -22.424536254631864, -33.95415660929389, -43.1001210213721, -42.14998221386975, -23.840191267577765, -29.02907984206137, -38.49789050902826, -31.01205716289442, -33.3738568657912, -39.60567400072673, -24.384820860230967, -33.29823629601479, -31.62885616256721, -33.24472397622345, -27.267766510099715, -35.80939450853437, -25.191018551806874, -38.24440338350687, -30.095774926608378, -32.638926578730114, -31.63217272706129, -21.516581906072723, -30.2197438708647, -28.038454654955682, -29.594344502812316, -36.10361588255207, -22.625430124249498, -31.310155317813273, -28.017027399509573, -25.49830418312888, -29.945287321632748, -34.103262770648506, -27.911251955640743, -22.773525005099273, -29.18433832675548, -35.68115892114207, -33.063150938405705, -26.813435425343247, -36.353122609010626, -28.542406477155733, -32.124350917677475, -34.83425543625734, -28.23677599277442, -30.941969866733416, -30.72635209582371, -30.338791859511485, -30.04208641154466, -32.24565610929354, -38.670335294040505, -27.067853815518877, -28.61167068331308, -14.82653849780594, -16.206493426592978, -22.101949503078497, -23.688626136636174, -25.895267178718356, -30.52038025913153, -31.59346340035231, -24.05913579180044, -20.458299224891654, -23.631214735408342, -37.67070138105092, -28.085358349519883, -28.76635291305984, -23.88144690853925, -34.57379988606657, -32.448068702446974, -32.00003512771732, -24.6514560360376, -26.713538834829976, -30.694246029497343, -17.5396139499955, -38.538954983375014, -32.60970481920513, -31.209978293309124, -25.970701559966585, -26.318261167465508, -32.36161886734919, -28.71050573276575, -31.730932548600357, -39.29617954075815, -37.0036958334063, -21.672041894898, -28.849357897210258, -36.13686402824917, -20.205231597236335, -29.259607875092986, -32.97607124861498, -23.867890311725606, -32.750328939840976, -21.13606273281979, -20.808951548897888, -8.724478156160083, -15.631576096692982, -9.648792637116365, -13.345282470770549, -11.934027020943278, -7.737640572549902, -13.698657049578483, -13.019671866560952, -17.492642205240756, -22.507291528033605, -14.52894918462094, -11.06074901309166, -17.357015369226605, -15.078887077199035, -5.217289408800545, -11.822209410321019, -14.12530217050338, -24.250457334442807, -28.289854389471987, -16.577552782075344, -11.685597061924284, -19.664797215726537, -11.825349670255319, -21.14897153826101, -26.121583342557436, -18.85351789584156, -24.262377170374446, -19.69001594014677, -27.83889191215797, -18.728118110084765, -28.84878943818433, -25.657061640391902, -18.99302143786946, -27.331206897914043, -10.190777392340676, -6.398784964599717, -23.824976826327706, -22.98655108181483, -12.04523409513436, -21.48797615420733, -14.466126740826974, -22.3073538570605, -27.755000980000617, -19.154780069317507, -22.109053395848086, -22.31995250132919, -15.134517138362344, -10.203326910323742, -22.073112529956152, -24.231496401315173, -14.746398145503154, -20.40540437324973, -11.255844705249284, -21.021497613516523, -3.4354510808803465, -19.842797992927885, -28.18163665221521, -22.598401427975062, -14.15507002071076, -16.681768042936394, -18.6179183061234, -20.47087334874495, -19.054603218556906, -28.609937388765598, -11.064310497242447, -12.398720943170382, -11.17487198506862, -14.297649007063976, -17.886753929080875, -22.290178754064534, -20.515081479260765, -14.960502604776226, -13.132070038242501, -20.37845532609138, -19.810092185034392, -15.616967714156573, -20.190499041116517, -11.711565200308627, -2.2566177906769394, -0.9377797439301965, -11.082696642688441, -20.029662432436506, -17.80019657979674, -22.2975804434932, -13.632984675254802, -19.672386204727047, -14.520190412829812, -15.49616297157488, -19.739125391875714, -19.101710101455552, -22.84592119275288, -12.188065540430165, -9.936421745594945, -13.080995438668165, -18.318845413488866, -18.900612616786045, -18.742921810897663, -19.549177143846478, -21.54848500261858, -23.955054734770037, -14.156319742839528, -24.728597073726846, -26.212785764961854, -20.836829123214706, -19.398875303450797, -18.800407692515044, -22.150205492298007, -17.4813638017455, -21.346434129207065, -26.285708627575016, -18.776334274251884, -13.443242489911256, -34.64251323088203, -14.441892115615707, -18.220106228884706, -0.3716623990624761, -11.301040822225943, -18.577755069681114, -17.49458087816633, -16.802663767573016, -5.713819882525204, -15.03837139010098, -25.43814678670557, -9.554270991855153, -21.69090518226079, -23.61917299318194, -18.869277707798332, -16.43466402543224, -16.47190053981543, -22.96626497285568, -23.40324206317583, -21.20376390960333, -13.960527062068088, -11.598496765359158, -26.665307834750532, -22.003541613814896, -20.707604461585394, -21.363659379254493, -11.41725622752244, -20.813082849567806, -25.02566296865875, 16.952040290183376, 20.709372154944795, 14.68642190740766, 15.891685790672746, 18.84539511502134, 8.809799227297288, 17.90734064215427, 21.59183022799906, 12.553274182845811, 18.93599771990375, 16.737655051949474, 15.980579154549865, 26.793311565881417, 16.69976651906354, 21.00771499727159, 20.993929237441158, 16.054154111774693, 16.32059573194013, 18.071657624403304, 16.06734286245024, 18.653247886461692, 15.247414317771574, 16.040282568779997, 17.347355543959964, 18.889413319950435, 17.359657972706458, 21.514051047198482, 18.473852108708464, 21.184186170188127, 14.762271305539228, 23.2164972629321, 20.87222022830663, 19.708168386850392, 19.045764471622142, 27.578807148841893, 15.263381429614759, 22.737063248535204, 14.046759626054385, 18.7719492366064, 15.037554109721054, 17.343159715404084, 23.80999315324952, 23.459508161508452, 14.158296270874906, 20.861778961834787, 21.075706966619986, 22.872357575812238, 15.909912094257312, 20.950228257927048, 17.77502086328927, 19.49561473416822, 21.205058428499093, 15.833477679551129, 18.75216396925196, 14.93513375750627, 21.15947223658354, 24.85302995495725, 16.04408416106295, 14.221897862188666, 21.42473415571078, 19.26431636457312, 18.71013904741766, 27.54182975127165, 16.564086021074758, 17.177366810265312, 25.30404790862885, 21.507068654278736, 17.70310826099729, 14.562255639752895, 6.6014513424166985, 15.306248250475559, 18.729512193877568, 24.465317559536537, 18.118177298559143, 17.810057901587715, 17.987080856622764, 20.663908967978035, 25.791320644388797, 19.533943504113243, 15.913633035065882, 21.783989357109025, 17.376718740996722, 20.97221379694784, 19.059404678717666, 20.957800753691036, 17.223384821572495, 17.173657107694844, 11.350982516587345, 21.628263897297213, 17.096517675936028, 15.700645158699189, 18.522072765484893, 18.07430052111027, 18.919808953527784, 16.88709927263594, 20.65517539961434, 16.141140639705032, 13.185604947950889, 29.995633267812405, 17.472658346625494, 18.11100126864826, 20.241615954151175, 15.717471256916294, 15.497903603208366, 16.674648927205695, 21.288465350215102, 15.570049002503897, 20.28547926819841, 18.2425268867584, 18.945031844046923, 22.55803566922578, 17.405845943466005, 19.63328969024555, 17.481428098719253, 16.46802877398439, 23.570573520525492, 20.24690303691057, 19.224395995990964, 15.883689096254654, 20.89516990414601, 16.97597735112312, 21.17376005389289, 21.213895794398713, 13.095815390818924, 26.148351992533314, 18.2478449706281, 13.206722917854368, 23.82128565540281, 17.180117311570513, 27.26397526763293, 12.519352765931949, 18.98962816723173, 27.198368364345047, 15.971496834503242, 1.8501616117920694, 11.953643334509788, 21.494436518450268, 20.50029957264737, 26.581577382169506, 1.959135503376201, 18.950444629435054, 9.914580840144602, 1.6672206823453486, 0.2393705108957711, 16.500867328073287, 16.533640160765067, 20.496937727092305, 4.665771566588459, 35.06944111412547, 22.660528644924938, 5.460755037761745, 24.131435389716565, 14.188942145247008, 16.806539402694717, 22.42251404423954, 23.095703510371674, 16.174922501481273, 1.5813899887206748, -5.345456119029178, 6.957863828395038, 25.009297982011077, 8.95845687099309, -3.177390916053218, 29.174489470056614, 15.919368296780375, 13.795083220328717, 7.214887868367964, 19.155581212324268, 12.833425874314209, 16.673381466494114, 20.34341019861943, 9.538881932319779, 23.27846171595009, 12.98178608410703, 12.282381589941574, 7.625999452233892, 3.6501388219997857, 16.209804930201656, 9.213670462088865, 9.235197293663187, 9.651262687984556, -7.503429167497346, 16.109455212602306, 2.093405535709808, 23.024270984756107, 29.117049787770817, 7.5536572014431504, 18.110370008004782, 25.20675823788497, 9.196917459861806, -5.311197571093134, 11.14240749445869, 11.761355997491114, 12.009030917120898, 15.668089985296763, 19.333160808794858, 8.645939788779152, -2.0159810546583934, 16.6269382866062, 4.305023299131285, 7.707596844294256, 12.776562594832889, 9.101812459543211, 1.9854595105726283, 5.483213287447506, 12.367691471358537, 16.82565211689367, 8.577367521095447, 26.789649541165645, 28.90619163365505, 11.488565440765184, 3.7752234910538895, 10.295262847874938, -2.608264950462573, 28.83220691167374, -4.809656549980398, 7.181496525542423, 15.035885687741295, 23.06730501615366, 16.71637327714569, 8.918929258477188, 12.94515169283942, 0.6808611232019235, 10.946846802064226, 23.714773346933185, 28.684544577409554, 26.14405175753805, 8.002213737811122, 18.747938215413154, 5.068154485893432, 19.407735226745192, 16.88601114439774, 9.493010036164536, 33.38046642722892, 2.558552734423481, 12.837662938218587, 0.9377965535630413, 2.3582713863136373, 4.988885488809565, 6.198284513880839, 24.523535282960815, 13.844730045422455]}],
                        {"template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}},
                        {"responsive": true}
                    ).then(function(){

var gd = document.getElementById('34d74526-b2b5-469f-91dc-d8ef0e7c247d');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});}}

                        })
                };
                });
            </script>
        </div>


Cluster 별 latent dimension과 원소 수의 true value는 다음과 같다.


```python
true_d
```




    [7, 10, 5, 13]




```python
true_z_count
```




    [115, 143, 129, 113]



# 2. Settings

## Specifying hyperparameters


```python
#specifying hyperparameters for prior distribution
mu_tilde = data.apply(np.mean).values
nu_tilde = dim
Sigma_tilde = (1/N)*np.cov(data.transpose())
alpha_tilde = 1
beta_tilde = 1
a_0 = 2
gamma_tilde = 1
delta_tilde = 1
a_tilde = 1
b_tilde = 5


# Initial number of clusters
K_0 = 2

hyperpara_dict = {'mu_tilde': mu_tilde, 'nu_tilde': nu_tilde, 'Sigma_tilde': Sigma_tilde, 'alpha_tilde': alpha_tilde, 
                 'beta_tilde': beta_tilde, 'a_0': a_0, 'gamma_tilde': gamma_tilde, 'delta_tilde': delta_tilde, 
                  'a_tilde': a_tilde, 'b_tilde': b_tilde, 'K_0': K_0, 'N': N, 'dim': dim}
```

## Initializing parameters


```python
# list to save the iteration result
## hyperparameter
mu_0_list = []
Sigma_0_list = []
phi_list = []
b_0_list = []
## Mixture component parameter
mu_list = []
Lambda_list = []
Psi_list = []
d_list = []
## Mixture assignment parameter
c_list = []
alpha_list = []

## initialize cluster assignment
#kmeans = KMeans(n_clusters=K_0, random_state=0).fit(data)
#c_list.append(kmeans.labels_)
#c_list.append(np.random.randint(0, K_0, N))

## Initialize alpha
alpha_list.append(np.random.gamma(a_tilde, 1/b_tilde, 1)[0])

## Initialize d : 1 ~ dim-1
d_list.append(np.random.randint(1, dim, K_0))

## Initialize mu_0
mu_0_list.append(np.random.multivariate_normal(mu_tilde, Sigma_tilde, 1)[0])

## Initialize Sigma_0
inv_wishart = invwishart(df=nu_tilde, scale=LA.inv(Sigma_tilde))
Sigma_0_list.append(inv_wishart.rvs(1))

## Initialize phi_j's
phi_list.append(np.random.gamma(alpha_tilde, 1/beta_tilde, dim-1))

## Initialize a_0, b_0
b_0_list.append(np.random.gamma(gamma_tilde, 1/delta_tilde, 1)[0])

## Initialize mu_k's
mu_list.append(np.random.multivariate_normal(mu_0_list[-1], Sigma_0_list[-1], K_0).transpose())

## Initialize c
c_init = np.zeros((N),dtype=int)
for n in range(N):
    normarray = np.array([LA.norm(data.iloc[n].values - mu_list[-1][:,muidx]) for muidx in range(mu_list[-1].shape[1]) ])
    c_init[n] = np.argmin(normarray)
c_list.append(c_init)

## Initialize Lambda_k's
Lambda_total = [] 
for i in range(K_0):
    Lambda_init = np.zeros((dim,d_list[-1][i]))
    for j in range(d_list[-1][i]):
        Lambda_j_init = np.random.multivariate_normal(np.repeat(0, dim), np.diag(np.repeat(1/(phi_list[-1][j]),dim)), 1)[0]
        Lambda_init[:,j] = Lambda_j_init
    Lambda_total.append(Lambda_init)
Lambda_list.append(Lambda_total)

## Initialize Psi_k's
Psi_total = []
for i in range(K_0):
    Psi_init = np.diag(1/np.random.gamma(a_0, 1/b_0_list[-1], dim))
    Psi_total.append(Psi_init)
Psi_list.append(Psi_total)

init_dict = {'mu_0': mu_0_list[-1], 'Sigma_0': Sigma_0_list[-1], 'phi': phi_list[-1], 'b_0': b_0_list[-1],
             'mu': mu_list[-1], 'Lambda': Lambda_list[-1], 'Psi': Psi_list[-1], 'd': d_list[-1], 'c': c_list[-1], 
             'alpha': alpha_list[-1]}
```


```python
init_dict
```




    {'mu_0': array([-10.5796966 ,  -0.53295315,  -5.50465242,  -2.97212471,
             -3.01247383,  -6.47696968,   7.4842918 ,   1.96275214,
              4.51985615,   5.57832617,   1.42320164,  -7.60205859,
             -3.56831577,  -7.19265603,  -0.72895332]),
     'Sigma_0': array([[ 2.49123453e+02, -2.19514061e+02,  1.98476655e+02,
              2.57418625e+02, -2.49006860e+02,  1.78742772e+02,
             -3.24722445e+02,  1.87372666e+02, -2.97748910e+02,
              7.19770576e+00, -2.94525641e+01,  1.53423126e+02,
             -4.03613283e+02,  7.44543186e+02, -3.38787130e+01],
            [-2.19514061e+02,  1.99332795e+02, -1.78352967e+02,
             -2.30770364e+02,  2.23024114e+02, -1.61178129e+02,
              2.93384807e+02, -1.70631159e+02,  2.68878070e+02,
             -8.41546025e+00,  2.69535766e+01, -1.35537741e+02,
              3.65283403e+02, -6.71814212e+02,  2.90932008e+01],
            [ 1.98476655e+02, -1.78352967e+02,  1.62687780e+02,
              2.07881462e+02, -2.01129283e+02,  1.44072323e+02,
             -2.63101922e+02,  1.51356564e+02, -2.40389008e+02,
              5.93003470e+00, -2.29012377e+01,  1.22723129e+02,
             -3.24265292e+02,  6.01857181e+02, -2.63807496e+01],
            [ 2.57418625e+02, -2.30770364e+02,  2.07881462e+02,
              2.70878518e+02, -2.61004605e+02,  1.88183060e+02,
             -3.42977602e+02,  1.99721171e+02, -3.14672050e+02,
              9.59831608e+00, -3.22477042e+01,  1.59322553e+02,
             -4.26401791e+02,  7.84038033e+02, -3.30215120e+01],
            [-2.49006860e+02,  2.23024114e+02, -2.01129283e+02,
             -2.61004605e+02,  2.53843797e+02, -1.82683568e+02,
              3.32754766e+02, -1.93860235e+02,  3.05519374e+02,
             -9.73299324e+00,  3.08648464e+01, -1.54665915e+02,
              4.15049656e+02, -7.59304658e+02,  3.22933188e+01],
            [ 1.78742772e+02, -1.61178129e+02,  1.44072323e+02,
              1.88183060e+02, -1.82683568e+02,  1.32827471e+02,
             -2.40583412e+02,  1.41578719e+02, -2.21566233e+02,
              8.08303770e+00, -2.27203310e+01,  1.11298350e+02,
             -3.02086934e+02,  5.49015775e+02, -2.31289533e+01],
            [-3.24722445e+02,  2.93384807e+02, -2.63101922e+02,
             -3.42977602e+02,  3.32754766e+02, -2.40583412e+02,
              4.40290598e+02, -2.59593395e+02,  4.04131345e+02,
             -1.56769050e+01,  4.26462706e+01, -2.02281116e+02,
              5.51115752e+02, -1.00020490e+03,  4.08024292e+01],
            [ 1.87372666e+02, -1.70631159e+02,  1.51356564e+02,
              1.99721171e+02, -1.93860235e+02,  1.41578719e+02,
             -2.59593395e+02,  1.58680428e+02, -2.40068503e+02,
              1.34625512e+01, -2.73220726e+01,  1.17841391e+02,
             -3.30163779e+02,  5.86000959e+02, -2.24177658e+01],
            [-2.97748910e+02,  2.68878070e+02, -2.40389008e+02,
             -3.14672050e+02,  3.05519374e+02, -2.21566233e+02,
              4.04131345e+02, -2.40068503e+02,  3.72608265e+02,
             -1.58388824e+01,  3.94341497e+01, -1.85891295e+02,
              5.08495479e+02, -9.18473930e+02,  3.72636664e+01],
            [ 7.19770576e+00, -8.41546025e+00,  5.93003470e+00,
              9.59831608e+00, -9.73299324e+00,  8.08303770e+00,
             -1.56769050e+01,  1.34625512e+01, -1.58388824e+01,
              4.74611288e+00, -2.96073129e+00,  5.29688570e+00,
             -2.42894224e+01,  3.23342239e+01,  5.34142540e-02],
            [-2.94525641e+01,  2.69535766e+01, -2.29012377e+01,
             -3.22477042e+01,  3.08648464e+01, -2.27203310e+01,
              4.26462706e+01, -2.73220726e+01,  3.94341497e+01,
             -2.96073129e+00,  6.14591260e+00, -1.88087176e+01,
              5.50897932e+01, -9.46260202e+01,  2.56447075e+00],
            [ 1.53423126e+02, -1.35537741e+02,  1.22723129e+02,
              1.59322553e+02, -1.54665915e+02,  1.11298350e+02,
             -2.02281116e+02,  1.17841391e+02, -1.85891295e+02,
              5.29688570e+00, -1.88087176e+01,  9.55656417e+01,
             -2.52319971e+02,  4.61902270e+02, -2.02116427e+01],
            [-4.03613283e+02,  3.65283403e+02, -3.24265292e+02,
             -4.26401791e+02,  4.15049656e+02, -3.02086934e+02,
              5.51115752e+02, -3.30163779e+02,  5.08495479e+02,
             -2.42894224e+01,  5.50897932e+01, -2.52319971e+02,
              6.99540428e+02, -1.25067256e+03,  5.17031338e+01],
            [ 7.44543186e+02, -6.71814212e+02,  6.01857181e+02,
              7.84038033e+02, -7.59304658e+02,  5.49015775e+02,
             -1.00020490e+03,  5.86000959e+02, -9.18473930e+02,
              3.23342239e+01, -9.46260202e+01,  4.61902270e+02,
             -1.25067256e+03,  2.28330172e+03, -9.60889011e+01],
            [-3.38787130e+01,  2.90932008e+01, -2.63807496e+01,
             -3.30215120e+01,  3.22933188e+01, -2.31289533e+01,
              4.08024292e+01, -2.24177658e+01,  3.72636664e+01,
              5.34142540e-02,  2.56447075e+00, -2.02116427e+01,
              5.17031338e+01, -9.60889011e+01,  6.90597176e+00]]),
     'phi': array([0.37730185, 0.00713908, 0.28880592, 1.00715917, 1.78147993,
            0.25171846, 0.24627171, 0.54029245, 0.30525224, 0.10043334,
            1.31118513, 0.93485124, 0.98017262, 0.69568678]),
     'b_0': 0.22503269767145934,
     'mu': array([[-22.11246086,   5.36436731],
            [ 10.45711399, -13.07840932],
            [-14.15746816,   6.2730544 ],
            [-17.58959884,  11.0293064 ],
            [ 10.74299061, -15.00477298],
            [-18.82166887,   1.77955946],
            [ 27.79952698,  -6.75202493],
            [-14.66842069,   6.31397432],
            [ 25.66378858,  -6.63948458],
            [  1.68684689,   3.13066913],
            [  5.14523775,   1.8831888 ],
            [-16.12335979,  -0.13135713],
            [ 26.49816809, -16.81845441],
            [-51.048682  ,  31.08897085],
            [ -0.49704862,  -3.79374347]]),
     'Lambda': [array([[ 2.42773406e+00, -5.14259081e+00, -2.21199722e+00,
              -9.78954865e-01,  1.12016350e+00,  3.24888858e+00],
             [ 6.97643353e-01, -1.14472553e+01,  8.86318660e-01,
               7.87334866e-01, -6.07535305e-01, -2.18179200e+00],
             [ 1.43542198e+00,  3.56860073e+00,  1.31565391e+00,
               2.13467668e+00, -4.19539867e-01,  1.37155547e+00],
             [ 1.88056878e+00, -8.95454878e+00,  1.83600990e+00,
              -3.36445081e-01, -3.86491390e-01, -2.24114211e+00],
             [ 7.44209171e-01,  5.94285466e+00,  5.53956783e+00,
               8.46392100e-01,  4.42773275e-01, -3.60154741e+00],
             [ 1.11365856e+00,  8.44680113e+00,  3.91773200e-01,
               1.58870916e+00, -3.02872482e-01, -6.13655781e+00],
             [-9.35819137e-01, -8.18486558e+00, -1.04679913e+00,
               1.78983642e+00,  2.85820475e-01,  5.12716767e-01],
             [ 1.61782670e+00,  1.63071992e+01, -2.50188464e+00,
              -1.86497534e+00, -1.77837052e+00,  2.54275206e+00],
             [ 1.07408122e+00,  1.19310055e+01,  2.87942063e-01,
              -9.31054248e-01, -1.27051473e+00, -7.10499293e-01],
             [-1.67877422e-01, -1.29901734e+01,  2.35825165e+00,
               6.07242796e-01, -2.96529618e-01,  2.10061479e+00],
             [-2.54958064e+00, -1.15474294e+01, -5.99517136e-01,
               4.75612800e-01,  4.27408853e-02, -1.04457230e+00],
             [ 9.77553416e-01, -3.16935572e+01, -2.97166736e+00,
               7.43417900e-01, -5.94874465e-01, -1.82401906e+00],
             [ 3.35338697e-01,  3.60364947e+00, -1.45239024e+00,
               3.09220502e-01,  9.08998116e-01,  3.40394004e+00],
             [-8.52063750e-01, -4.18047832e+00,  1.83185776e+00,
              -8.19024155e-01,  2.28108605e-01,  1.84333265e+00],
             [ 2.66719895e+00, -1.61804562e+01,  1.62303880e+00,
              -3.63993988e-01, -2.02349829e-02,  1.55727265e+00]]),
      array([[  0.52963678,   2.68780428,  -1.34584145],
             [  3.01534944,  12.98913781,   2.65872394],
             [ -0.34577098,  -5.66976825,  -4.61642558],
             [ -1.1183843 ,  -0.91440076,  -0.67268476],
             [ -2.82362013,  17.1195034 ,  -2.25733216],
             [  0.43848661,  -3.90512646,   1.76979514],
             [ -0.25310443,  -1.64230597,  -1.95469755],
             [ -1.42371806,   0.66471487,  -2.22087458],
             [ -2.53724791,  -2.44965754,   1.26881164],
             [  1.18649253,  10.51393449,  -0.94263262],
             [ -0.45483289, -13.94766431,  -0.39231347],
             [ -0.80834129,   8.88275341,  -2.29104029],
             [ -0.19457733,  -4.60455521,   1.11467081],
             [ -1.00410806, -11.73899065,  -0.35934645],
             [  0.36286301,   3.45190614,   1.10098429]])],
     'Psi': [array([[0.0411733 , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.21481857, 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.3250026 , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.11099103, 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.03767077,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.09676922, 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.17399361, 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.19228462, 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.22326443, 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.12695546,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.0505733 , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.36918892, 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.07568105, 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.15761507, 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.16679734]]),
      array([[0.03784321, 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.17154962, 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.46229525, 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.17595995, 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.18868369,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.05291112, 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.11500872, 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.16508208, 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.11940206, 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.03411399,
              0.        , 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.23164045, 0.        , 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.10079185, 0.        , 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.21066831, 0.        , 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.06658336, 0.        ],
             [0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.        ,
              0.        , 0.        , 0.        , 0.        , 0.16721265]])],
     'd': array([6, 3]),
     'c': array([1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1,
            1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1,
            0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0,
            1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1,
            0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1,
            1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
            0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1,
            1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0,
            1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0,
            1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1,
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1]),
     'alpha': 0.2632582162143184}



## Number of iterations
Iteration 수는 5000으로 설정.


```python
Iter = 5000
```

## Define module for parallel computing
8개의 processor로 parameter의 업데이트를 병렬적으로 수행.


```python
multiprocessing.cpu_count()
```




    8




```python
def parallel_iter(func, dataset_list, init_dict_var):
    parameter_sample_lists_fixed = partial(func, initialization_dict = init_dict_var, hyperparameter_dict = hyperpara_dict, whole_data = data)     
    if __name__ == '__main__':
        pool = Pool(multiprocessing.cpu_count()) 
        result_list = list(pool.map(parameter_sample_lists_fixed, dataset_list))
        pool.close()
        pool.join()
    return result_list
```

## Create list to save the NMI values of each iteration


```python
NMI_list = []
```

# 3. Sampling

$\mathbf c$를 업데이트할 때 사용하는 auxiliary variable의 수는 $m = 4$을 사용.


```python
start_time = time.time()
for iters in range(Iter):
    start_iter_time = time.time()
    if (iters % 5 == 1) or (iters < 30):
        print("alpha for this iteration is ",alpha_list[-1])
    
    ##################### Update c ##################### 
    c_iter_result = Algorithm_8_MFA(data, init_dict, hyperpara_dict, m=4)
    
    mu_0_list.append(c_iter_result['mu_0'])
    Sigma_0_list.append(c_iter_result['Sigma_0'])
    phi_list.append(c_iter_result['phi'])
    b_0_list.append(c_iter_result['b_0'])
    mu_list.append(c_iter_result['mu'])
    Lambda_list.append(c_iter_result['Lambda'])
    Psi_list.append(c_iter_result['Psi'])
    d_list.append(c_iter_result['d'])
    c_list.append(c_iter_result['c'])
    alpha_list.append(c_iter_result['alpha'])
    
    # divide data by clusters
    grouped = data.groupby(c_list[-1])
    data_c_list = [(idx,grouped.get_group(idx)) for idx in np.unique(c_list[-1])]
    K = len(data_c_list)
    
    # Update init_dict for next task
    init_dict = {'mu_0': mu_0_list[-1], 'Sigma_0': Sigma_0_list[-1], 'phi': phi_list[-1], 'b_0': b_0_list[-1],
                 'mu': mu_list[-1], 'Lambda': Lambda_list[-1], 'Psi': Psi_list[-1], 'd': d_list[-1], 'c': c_list[-1], 
                 'alpha': alpha_list[-1]}
    
    ##################### Update mixture components ##################### 
    # Parallel update for mixture component parameters
    phi_result_list = parallel_iter(func = parameter_sample, dataset_list = data_c_list, init_dict_var= init_dict)
    phi_result_list
    # Update parameter lists
    for j in range(K):        
        mu_list[-1][:,j] = phi_result_list[j]['mu_k']
        Lambda_list[-1][j] = phi_result_list[j]['Lambda_k']
        Psi_list[-1][j] = phi_result_list[j]['Psi_k']
        d_list[-1][j] = phi_result_list[j]['d_k']
        
    ##################### Update parameters for prior distributions ##################### 
    # Update alpha
    eta = np.random.beta(alpha_list[-1]+1, N, 1)[0]
    alpha_mix_prob = [a_tilde + K-1, N*(b_tilde - np.log(eta))]
    alpha_mix_prob = alpha_mix_prob/sum(alpha_mix_prob)
    mix_bool = np.random.choice([True,False], p=alpha_mix_prob)
    # sample from mixture of gamma
    if mix_bool:
        alpha_new = np.random.gamma(a_tilde+K, 1/(b_tilde - np.log(eta)), 1)[0]
    else:
        alpha_new = np.random.gamma(a_tilde+K-1, 1/(b_tilde - np.log(eta)), 1)[0]
    alpha_list[-1] = alpha_new
    
    # Update mu_0
    mu_bar =  np.mean(pd.DataFrame(mu_list[-1]).transpose()).values
    cov = LA.inv(LA.inv(Sigma_tilde) + K*LA.inv(Sigma_0_list[-1]))
    mean = np.matmul(cov,(np.matmul(LA.inv(Sigma_tilde), mu_tilde) + K*np.matmul(LA.inv(Sigma_0_list[-1]),mu_bar)))
    mu_0_new = np.random.multivariate_normal(mean, cov, 1)[0]
    mu_0_list[-1] = mu_0_new
    
    # Update Sigma_0
    V = np.matmul( (pd.DataFrame(mu_list[-1].transpose())- mu_bar).values.transpose(), 
                  (pd.DataFrame(mu_list[-1].transpose())- mu_bar).values )
    inv_wishart = invwishart(df=nu_tilde + 1, scale=LA.inv(Sigma_tilde) + V)
    Sigma_0_list[-1] = inv_wishart.rvs(1)
    
    # Update phi_j
    for j in range(dim-1):
        shape = alpha_tilde
        rate = beta_tilde
        for k in range(K):
            if d_list[-1][k] > j:
                shape = shape + (dim/2)
                LL = Lambda_list[-1][k][:,j]
                rate = rate + (np.dot(LL, LL)/2)
        phi_j_new = np.random.gamma(shape, 1/rate, 1)[0]
        phi_list[-1][j] = phi_j_new
        
    # Update b_0
    shape = gamma_tilde + (a_0*K*dim)
    rate = delta_tilde
    for k in range(K):
        rate = rate + sum(1/np.diag(Psi_list[-1][k]))
    b_0_new = np.random.gamma(shape, 1/rate, 1)[0]
    b_0_list[-1] = b_0_new
    
    ######################## Update init_dict for next iteration ##########################

    init_dict = {'mu_0': mu_0_list[-1], 'Sigma_0': Sigma_0_list[-1], 'phi': phi_list[-1], 'b_0': b_0_list[-1],
                 'mu': mu_list[-1], 'Lambda': Lambda_list[-1], 'Psi': Psi_list[-1], 'd': d_list[-1], 'c': c_list[-1], 
                 'alpha': alpha_list[-1]}
    
    ######################## Print out the output ##########################
    NMI = normalized_mutual_info_score(data.index, c_list[-1],average_method = 'arithmetic')
    NMI_list.append(NMI)
    
    end_time = time.time()
    
    if (iters % 5 == 1) or (iters < 30):
        print(iters+1,"th iteration completed // # of clusters : ",max(c_list[-1])+1)
        table = np.array([( Counter(c_list[-1])[j] ) for j in range(max(c_list[-1])+1)])
        table = pd.DataFrame(table).transpose()
        table = table.append(pd.DataFrame(d_list[-1]).transpose())
        table.index = ['count', 'dim']
        print(table)
        print("Normalized Mutual Information Score : ", NMI)
        print("Elapsed time : ", np.round(end_time - start_iter_time,1), "sec // Total elapsed time : ", np.round(end_time - start_time,1), "sec")
        print("==================================================================================")
```

    alpha for this iteration is  0.2632582162143184
    1 th iteration completed // # of clusters :  54
           0   1   2   3   4   5   6   7   8   9   ...  44  45  46  47  48  49  \
    count  14   8  17  15  12  11  12  10  11  14  ...   5   3   3   4   3   1   
    dim     6   3   5   6   4   6   3   1   8  10  ...   1   6   6   7   1   8   
    
           50  51  52  53  
    count   1   2   2   1  
    dim     2   2   8   5  
    
    [2 rows x 54 columns]
    Normalized Mutual Information Score :  0.17340250969319826
    Elapsed time :  25.8 sec // Total elapsed time :  25.8 sec
    ==================================================================================
    alpha for this iteration is  4.08245572088003
    2 th iteration completed // # of clusters :  67
           0   1   2   3   4   5   6   7   8   9   ...  57  58  59  60  61  62  \
    count   4   1   5   6   3   4   2   2   4   5  ...   5   2   3   3   3   2   
    dim     6   5   6   4   6   3   2   8  10   6  ...   8   4   8  12   3   4   
    
           63  64  65  66  
    count   1   2   1   1  
    dim     1   5   8   7  
    
    [2 rows x 67 columns]
    Normalized Mutual Information Score :  0.3637149924839635
    Elapsed time :  35.5 sec // Total elapsed time :  61.3 sec
    ==================================================================================
    alpha for this iteration is  6.431113896278033
    3 th iteration completed // # of clusters :  63
           0   1   2   3   4   5   6   7   8   9   ...  53  54  55  56  57  58  \
    count   3   6   2   2   3   4   5   1   3   2  ...   7   3   2   1   2   3   
    dim     6   5   6   6   3   2  10   6   3   2  ...  14   7   2   3   9   7   
    
           59  60  61  62  
    count   2   1   2   1  
    dim     1   3   6  11  
    
    [2 rows x 63 columns]
    Normalized Mutual Information Score :  0.5354817677614138
    Elapsed time :  40.1 sec // Total elapsed time :  101.4 sec
    ==================================================================================
    alpha for this iteration is  7.488668014141318
    4 th iteration completed // # of clusters :  41
           0   1   2   3    4   5   6    7   8   9   ...  31  32  33  34  35  36  \
    count   1   1   1   2  113   9  96  112   1   1  ...   1   2   1   1   1   1   
    dim     7   6   3   3   14  11  12   14   6   4  ...   3   2   1   6   8   5   
    
           37  38  39  40  
    count   4   1   2   1  
    dim     1   2   8   5  
    
    [2 rows x 41 columns]
    Normalized Mutual Information Score :  0.7340073757911796
    Elapsed time :  35.2 sec // Total elapsed time :  136.7 sec
    ==================================================================================
    alpha for this iteration is  4.235476648791053
    5 th iteration completed // # of clusters :  28
            0   1    2   3   4   5    6   7   8   9   ...  18  19  20  21  22  23  \
    count  114  72  132   2   8  45  100   1   2   4  ...   1   1   1   1   1   2   
    dim     14  12   14   4   9  13   14   3   8   2  ...   3   7   5   6   1   8   
    
           24  25  26  27  
    count   1   1   1   1  
    dim     2   5   4   8  
    
    [2 rows x 28 columns]
    Normalized Mutual Information Score :  0.8267103701541815
    Elapsed time :  30.5 sec // Total elapsed time :  167.2 sec
    ==================================================================================
    alpha for this iteration is  2.5904034243805913
    7 th iteration completed // # of clusters :  26
            0   1    2   3   4   5   6   7   8   9   ...  16  17  18  19  20  21  \
    count  114  28  135   2  15  94  93   1   1   1  ...   1   1   1   1   1   1   
    dim     14  14   14   3   9  14  14   3   8   1  ...   6   3   6   1   1   2   
    
           22  23  24  25  
    count   1   1   1   1  
    dim     9   6   4   9  
    
    [2 rows x 26 columns]
    Normalized Mutual Information Score :  0.8428785182360695
    Elapsed time :  23.3 sec // Total elapsed time :  214.2 sec
    ==================================================================================
    alpha for this iteration is  1.6058022977746813
    12 th iteration completed // # of clusters :  26
            0   1    2   3   4   5    6   7   8   9   ...  16  17  18  19  20  21  \
    count  114  25  134   2   8  96  102   1   1   1  ...   1   1   1   1   1   1   
    dim     14  14   14   2  13  14   14   3  10   2  ...   7   3   5   1   1   2   
    
           22  23  24  25  
    count   1   1   1   1  
    dim     9   5   5   9  
    
    [2 rows x 26 columns]
    Normalized Mutual Information Score :  0.8670783381255375
    Elapsed time :  22.7 sec // Total elapsed time :  329.2 sec
    ==================================================================================
    alpha for this iteration is  2.7629893681992836
    17 th iteration completed // # of clusters :  26
            0   1    2   3   4    5   6   7   8   9   ...  16  17  18  19  20  21  \
    count  114  14  134   2  19  107  91   1   1   1  ...   1   1   1   1   1   1   
    dim     14  14   14   3  14   14  14   3  10   4  ...   5   4   6   2   1   2   
    
           22  23  24  25  
    count   1   1   1   1  
    dim    11   6   4   8  
    
    [2 rows x 26 columns]
    Normalized Mutual Information Score :  0.8650913341708795
    Elapsed time :  23.6 sec // Total elapsed time :  447.6 sec
    ==================================================================================
    alpha for this iteration is  2.648857258723105
    22 th iteration completed // # of clusters :  26
            0   1    2   3   4    5   6   7   8   9   ...  16  17  18  19  20  21  \
    count  114  17  134   2  17  104  93   1   1   1  ...   1   1   1   1   1   1   
    dim     14  14   14   3  14   14  14   3   8   4  ...   4   6   7   2   2   2   
    
           22  23  24  25  
    count   1   1   1   1  
    dim     8   6   5   8  
    
    [2 rows x 26 columns]
    Normalized Mutual Information Score :  0.8637423641817068
    Elapsed time :  23.1 sec // Total elapsed time :  563.5 sec
    ==================================================================================
    alpha for this iteration is  2.6609569969508446
    27 th iteration completed // # of clusters :  26
            0   1    2   3   4    5   6   7   8   9   ...  16  17  18  19  20  21  \
    count  114  11  134   2  19  110  91   1   1   1  ...   1   1   1   1   1   1   
    dim     14  14   14   3  14   14  14   3  10   2  ...   4   7   7   1   1   2   
    
           22  23  24  25  
    count   1   1   1   1  
    dim     8   8   5   7  
    
    [2 rows x 26 columns]
    Normalized Mutual Information Score :  0.8686210789444941
    Elapsed time :  23.7 sec // Total elapsed time :  678.3 sec
    ==================================================================================
    alpha for this iteration is  2.8677908637119076
    32 th iteration completed // # of clusters :  26
            0   1    2   3   4    5   6   7   8   9   ...  16  17  18  19  20  21  \
    count  114   7  134   2  13  114  97   1   1   1  ...   1   1   1   1   1   1   
    dim     14  14   14   4  14   14  14   3  12   3  ...   4   7   7   1   2   2   
    
           22  23  24  25  
    count   1   1   1   1  
    dim     8   8   6   7  
    
    [2 rows x 26 columns]
    Normalized Mutual Information Score :  0.8801171046931516
    Elapsed time :  26.4 sec // Total elapsed time :  797.0 sec
    ==================================================================================
    alpha for this iteration is  2.3655497951975675
    37 th iteration completed // # of clusters :  26
            0   1    2   3   4    5   6   7   8   9   ...  16  17  18  19  20  21  \
    count  114   8  134   2  12  113  98   1   1   1  ...   1   1   1   1   1   1   
    dim     14  14   14   6  14   14  14   3  13   5  ...   5   8   8   1   4   2   
    
           22  23  24  25  
    count   1   1   1   1  
    dim    10   6   4  10  
    
    [2 rows x 26 columns]
    Normalized Mutual Information Score :  0.8797454248309614
    Elapsed time :  23.0 sec // Total elapsed time :  912.9 sec
    ==================================================================================
    alpha for this iteration is  2.9104573782395753
    42 th iteration completed // # of clusters :  26
            0   1    2   3   4    5   6   7   8   9   ...  16  17  18  19  20  21  \
    count  114   4  134   2  11  117  99   1   1   1  ...   1   1   1   1   1   1   
    dim     14  13   14   5  14   14  14   2  13   4  ...   5   9   6   1   3   3   
    
           22  23  24  25  
    count   1   1   1   1  
    dim     8   5   3  11  
    
    [2 rows x 26 columns]
    Normalized Mutual Information Score :  0.8876793161342177
    Elapsed time :  23.4 sec // Total elapsed time :  1031.9 sec
    ==================================================================================
    alpha for this iteration is  2.5615500545098584
    47 th iteration completed // # of clusters :  26
            0    1   2   3    4    5   6   7   8   9   ...  16  17  18  19  20  \
    count  114  134   2   7  120  103   1   1   1   1  ...   1   1   1   1   1   
    dim     14   14   5  14   14   14   3  12   1   2  ...  11  12   7   2   3   
    
           21  22  23  24  25  
    count   1   1   1   1   1  
    dim     3   8   6   4  10  
    
    [2 rows x 26 columns]
    Normalized Mutual Information Score :  0.9001033041430261
    Elapsed time :  23.3 sec // Total elapsed time :  1148.6 sec
    ==================================================================================
    alpha for this iteration is  2.47323045128049
    52 th iteration completed // # of clusters :  25
            0    1   2   3    4    5   6   7   8   9   ...  15  16  17  18  19  \
    count  114  134   2   6  121  104   1   1   1   1  ...   1   1   1   1   1   
    dim     14   13   4  14   14   14   4  13   2   2  ...   3   8   5   2   3   
    
           20  21  22  23  24  
    count   1   1   1   1   1  
    dim     2   7   7   4  11  
    
    [2 rows x 25 columns]
    Normalized Mutual Information Score :  0.9051510837487619
    Elapsed time :  23.4 sec // Total elapsed time :  1265.6 sec
    ==================================================================================
    alpha for this iteration is  2.1790587063644002
    57 th iteration completed // # of clusters :  25
            0    1   2   3    4   5   6   7   8   9   ...  15  16  17  18  19  20  \
    count  114  134   2  11  121  99   1   1   1   1  ...   1   1   1   1   1   1   
    dim     14   13   4  14   14  14   5  12   3   2  ...   3   9   5   2   3   3   
    
           21  22  23  24  
    count   1   1   1   1  
    dim     7   5   5  10  
    
    [2 rows x 25 columns]
    Normalized Mutual Information Score :  0.8978145851311342
    Elapsed time :  23.1 sec // Total elapsed time :  1379.7 sec
    ==================================================================================
    alpha for this iteration is  1.9314936349004412
    62 th iteration completed // # of clusters :  25
            0    1   2   3    4    5   6   7   8   9   ...  15  16  17  18  19  \
    count  114  134   2   8  121  102   1   1   1   1  ...   1   1   1   1   1   
    dim     14   13   4  14   14   14   2  13   3   4  ...   4  10   6   1   4   
    
           20  21  22  23  24  
    count   1   1   1   1   1  
    dim     4   7   4   6  11  
    
    [2 rows x 25 columns]
    Normalized Mutual Information Score :  0.9019694717057004
    Elapsed time :  23.0 sec // Total elapsed time :  1494.8 sec
    ==================================================================================
    alpha for this iteration is  2.629562557725017
    67 th iteration completed // # of clusters :  25
            0    1   2   3    4    5   6   7   8   9   ...  15  16  17  18  19  \
    count  114  134   2   5  121  105   1   1   1   1  ...   1   1   1   1   1   
    dim     14   13   4  14   14   14   3  14   2   3  ...   5  10   5   2   3   
    
           20  21  22  23  24  
    count   1   1   1   1   1  
    dim     4  11   4   5   9  
    
    [2 rows x 25 columns]
    Normalized Mutual Information Score :  0.9069012510648811
    Elapsed time :  23.0 sec // Total elapsed time :  1610.0 sec
    ==================================================================================
    alpha for this iteration is  2.45462744530895
    72 th iteration completed // # of clusters :  24
            0    1   2   3    4    5   6   7   8   9   ...  14  15  16  17  18  \
    count  114  135   2   5  121  105   1   1   1   1  ...   1   1   1   1   1   
    dim     14   13   4  14   14   14   2  13   2   4  ...   4  10   3   4   4   
    
           19  20  21  22  23  
    count   1   1   1   1   1  
    dim     3   9   7   5  10  
    
    [2 rows x 24 columns]
    Normalized Mutual Information Score :  0.9104279258549057
    Elapsed time :  22.6 sec // Total elapsed time :  1723.1 sec
    ==================================================================================
    alpha for this iteration is  3.1031322633039755
    77 th iteration completed // # of clusters :  24
            0    1   2   3    4    5   6   7   8   9   ...  14  15  16  17  18  \
    count  114  135   2   4  121  106   1   1   1   1  ...   1   1   1   1   1   
    dim     14   13   5  14   14   14   3  13   2   5  ...   3  12   4   4   5   
    
           19  20  21  22  23  
    count   1   1   1   1   1  
    dim     3   9   5   6   9  
    
    [2 rows x 24 columns]
    Normalized Mutual Information Score :  0.9123255969426347
    Elapsed time :  22.8 sec // Total elapsed time :  1837.7 sec
    ==================================================================================
    alpha for this iteration is  2.5952146986849707
    82 th iteration completed // # of clusters :  24
            0    1   2   3    4    5   6   7   8   9   ...  14  15  16  17  18  \
    count  114  135   2   4  121  106   1   1   1   1  ...   1   1   1   1   1   
    dim     14   13   5  13   14   14   3  12   2   4  ...   3  13   5   2   5   
    
           19  20  21  22  23  
    count   1   1   1   1   1  
    dim     3  12   7   5   9  
    
    [2 rows x 24 columns]
    Normalized Mutual Information Score :  0.9123255969426347
    Elapsed time :  22.9 sec // Total elapsed time :  1952.3 sec
    ==================================================================================
    alpha for this iteration is  2.457154470050333
    87 th iteration completed // # of clusters :  23
            0    1   2   3    4    5   6   7   8   9   ...  13  14  15  16  17  \
    count  114  135   2   4  122  106   1   1   1   1  ...   1   1   1   1   1   
    dim     14   13   5  12   14   14   4  11   3   4  ...   5   6   5   1   5   
    
           18  19  20  21  22  
    count   1   1   1   1   1  
    dim     3  11   8   7   8  
    
    [2 rows x 23 columns]
    Normalized Mutual Information Score :  0.9158329571117765
    Elapsed time :  22.0 sec // Total elapsed time :  2071.5 sec
    ==================================================================================
    alpha for this iteration is  1.835177791228218
    92 th iteration completed // # of clusters :  22
            0    1   2    3    4   5   6   7   8   9   ...  12  13  14  15  16  \
    count  114  135   2  122  110   1   1   1   1   1  ...   1   1   1   1   1   
    dim     14   13   5   14   14   5   8   1   3   6  ...   4   7   4   2   4   
    
           17  18  19  20  21  
    count   1   1   1   1   1  
    dim     3  10   8   9   9  
    
    [2 rows x 22 columns]
    Normalized Mutual Information Score :  0.9263841669541721
    Elapsed time :  22.5 sec // Total elapsed time :  2183.0 sec
    ==================================================================================
    alpha for this iteration is  1.9027952077275037
    97 th iteration completed // # of clusters :  21
            0    1   2    3    4   5   6   7   8   9   ...  11  12  13  14  15  \
    count  114  135   2  123  110   1   1   1   1   1  ...   1   1   1   1   1   
    dim     14   13   5   14   14   3   9   1   4   7  ...  12   4   9   5   3   
    
           16  17  18  19  20  
    count   1   1   1   1   1  
    dim     4   3  11   8  11  
    
    [2 rows x 21 columns]
    Normalized Mutual Information Score :  0.9300057992828807
    Elapsed time :  21.2 sec // Total elapsed time :  2291.4 sec
    ==================================================================================
    alpha for this iteration is  2.4046022628413244
    102 th iteration completed // # of clusters :  20
             0    1  2    3    4  5   6  7  8  9  10  11  12  13  14  15  16  17  \
    count  114  135  2  123  111  1   1  1  1  1   1   1   1   1   1   1   1   1   
    dim     14   13  5   14   14  3  11  2  6  7  12  14   3   8   9   2   1   4   
    
           18  19  
    count   1   1  
    dim     6   9  
    Normalized Mutual Information Score :  0.9335908200463936
    Elapsed time :  21.3 sec // Total elapsed time :  2399.2 sec
    ==================================================================================
    alpha for this iteration is  2.0419095394323254
    107 th iteration completed // # of clusters :  20
             0    1  2    3    4  5   6  7  8  9  10  11  12  13  14  15  16  17  \
    count  114  135  2  123  111  1   1  1  1  1   1   1   1   1   1   1   1   1   
    dim     14   13  5   14   14  3  10  4  7  7  10  14   4   7   8   5   1   4   
    
           18  19  
    count   1   1  
    dim     6  10  
    Normalized Mutual Information Score :  0.9335908200463936
    Elapsed time :  21.2 sec // Total elapsed time :  2505.6 sec
    ==================================================================================
    alpha for this iteration is  2.581276708915583
    112 th iteration completed // # of clusters :  20
             0    1  2    3    4  5   6  7  8  9  10  11  12  13  14  15  16  17  \
    count  114  135  2  123  111  1   1  1  1  1   1   1   1   1   1   1   1   1   
    dim     14   13  7   14   14  2  11  3  8  6  12  14   6   8   9   6   2   4   
    
           18  19  
    count   1   1  
    dim     4  10  
    Normalized Mutual Information Score :  0.9335908200463936
    Elapsed time :  21.0 sec // Total elapsed time :  2612.0 sec
    ==================================================================================
    alpha for this iteration is  2.428682679936777
    117 th iteration completed // # of clusters :  19
             0    1  2    3    4  5  6  7  8  9  10  11  12  13  14  15  16  17  \
    count  114  136  2  123  111  1  1  1  1  1   1   1   1   1   1   1   1   1   
    dim     14   13  5   14   14  2  9  3  6  6  12   5   5  10   7   4   6   4   
    
           18  
    count   1  
    dim    10  
    Normalized Mutual Information Score :  0.9373332632326629
    Elapsed time :  23.1 sec // Total elapsed time :  2719.8 sec
    ==================================================================================
    alpha for this iteration is  1.1429853019695742
    122 th iteration completed // # of clusters :  19
             0    1  2    3    4  5  6  7  8  9  10  11  12  13  14  15  16  17  \
    count  114  136  2  123  111  1  1  1  1  1   1   1   1   1   1   1   1   1   
    dim     14   14  4   14   14  3  9  4  5  6  13   3   3  10   8   4   5   4   
    
           18  
    count   1  
    dim    12  
    Normalized Mutual Information Score :  0.9373332632326629
    Elapsed time :  20.8 sec // Total elapsed time :  2824.5 sec
    ==================================================================================
    alpha for this iteration is  1.4555202252079593
    127 th iteration completed // # of clusters :  19
             0    1  2    3    4  5  6  7  8  9  10  11  12  13  14  15  16  17  \
    count  114  136  2  123  111  1  1  1  1  1   1   1   1   1   1   1   1   1   
    dim     14   14  5   14   14  5  8  4  7  5  14   4   3  10   9   5   5   6   
    
           18  
    count   1  
    dim    11  
    Normalized Mutual Information Score :  0.9373332632326629
    Elapsed time :  21.1 sec // Total elapsed time :  2928.5 sec
    ==================================================================================
    alpha for this iteration is  1.3031294801578162
    132 th iteration completed // # of clusters :  18
             0    1  2    3    4  5  6  7  8  9  10  11  12  13  14  15  16  17
    count  114  136  2  124  111  1  1  1  1  1   1   1   1   1   1   1   1   1
    dim     14   14  5   14   14  3  8  3  8  6  11   2   5  11   5   6   4  12
    Normalized Mutual Information Score :  0.9410463931103893
    Elapsed time :  20.6 sec // Total elapsed time :  3031.6 sec
    ==================================================================================
    alpha for this iteration is  1.578588457857095
    137 th iteration completed // # of clusters :  18
             0    1  2    3    4  5  6  7  8  9  10  11  12  13  14  15  16  17
    count  114  136  2  124  111  1  1  1  1  1   1   1   1   1   1   1   1   1
    dim     14   14  4   14   14  4  9  4  9  6  11   2   8  13   8   4   3   9
    Normalized Mutual Information Score :  0.9410463931103893
    Elapsed time :  20.6 sec // Total elapsed time :  3134.9 sec
    ==================================================================================
    alpha for this iteration is  1.55507712386363
    142 th iteration completed // # of clusters :  17
             0    1  2    3    4  5  6  7  8  9  10  11  12  13  14  15  16
    count  114  136  2  125  111  1  1  1  1  1   1   1   1   1   1   1   1
    dim     14   13  4   14   14  2  9  4  7  4  10   2   8   9   3   5  13
    Normalized Mutual Information Score :  0.9447942683217329
    Elapsed time :  21.1 sec // Total elapsed time :  3238.2 sec
    ==================================================================================
    alpha for this iteration is  2.4083009061291243
    147 th iteration completed // # of clusters :  17
             0    1  2    3    4  5  6  7   8  9  10  11  12  13  14  15  16
    count  114  136  2  125  111  1  1  1   1  1   1   1   1   1   1   1   1
    dim     14   13  4   14   14  3  8  6  10  6  11   4   9  11   3   5  10
    Normalized Mutual Information Score :  0.9447942683217329
    Elapsed time :  20.1 sec // Total elapsed time :  3339.8 sec
    ==================================================================================
    alpha for this iteration is  1.7227428412627221
    152 th iteration completed // # of clusters :  16
             0    1  2    3    4  5  6  7   8  9  10  11  12  13  14  15
    count  114  137  2  125  111  1  1  1   1  1   1   1   1   1   1   1
    dim     14   13  6   14   14  4  6  6  10  5   8   3   8   3   5   8
    Normalized Mutual Information Score :  0.9486320454228061
    Elapsed time :  21.0 sec // Total elapsed time :  3446.8 sec
    ==================================================================================
    alpha for this iteration is  1.7788072623208673
    157 th iteration completed // # of clusters :  16
             0    1  2    3    4  5  6  7   8  9  10  11  12  13  14  15
    count  114  137  2  125  111  1  1  1   1  1   1   1   1   1   1   1
    dim     14   13  8   14   14  4  8  6  11  5   8   4  10   4   3   9
    Normalized Mutual Information Score :  0.9486320454228061
    Elapsed time :  20.0 sec // Total elapsed time :  3547.9 sec
    ==================================================================================
    alpha for this iteration is  1.9339266116062346
    162 th iteration completed // # of clusters :  16
             0    1    2    3  4   5  6  7  8  9  10  11  12  13  14  15
    count  114  137  126  111  1   1  1  1  1  1   1   1   1   1   1   1
    dim     14   13   14   14  4  10  6  9  6  9   5   7  10   3   3  11
    Normalized Mutual Information Score :  0.9515366465326283
    Elapsed time :  20.4 sec // Total elapsed time :  3648.4 sec
    ==================================================================================
    alpha for this iteration is  1.5115091481332235
    167 th iteration completed // # of clusters :  16
             0    1    2    3   4  5   6  7  8  9  10  11  12  13  14  15
    count  114  137  125  111   2  1   1  1  1  1   1   1   1   1   1   1
    dim     14   13   14   14  12  2  11  6  8  4   8   5   3   4   5  11
    Normalized Mutual Information Score :  0.9486320454228062
    Elapsed time :  23.1 sec // Total elapsed time :  3752.1 sec
    ==================================================================================
    alpha for this iteration is  1.6530008609455416
    172 th iteration completed // # of clusters :  16
             0    1    2    3   4  5  6  7  8   9  10  11  12  13  14  15
    count  114  137  124  111   2  2  1  1  1   1   1   1   1   1   1   1
    dim     14   14   14   14  11  3  2  9  4  10   4   7   7   3   2  10
    Normalized Mutual Information Score :  0.9457503020609286
    Elapsed time :  21.4 sec // Total elapsed time :  3868.9 sec
    ==================================================================================
    alpha for this iteration is  1.476992377055069
    177 th iteration completed // # of clusters :  16
             0    1    2    3   4  5  6  7  8  9  10  11  12  13  14  15
    count  114  137  124  111   2  2  1  1  1  1   1   1   1   1   1   1
    dim     14   14   14   14  10  4  4  9  3  7   4   7   5   3   2  11
    Normalized Mutual Information Score :  0.9457503020609286
    Elapsed time :  21.5 sec // Total elapsed time :  3976.9 sec
    ==================================================================================
    alpha for this iteration is  1.8713457671398686
    182 th iteration completed // # of clusters :  16
             0    1    2    3   4  5  6   7  8  9  10  11  12  13  14  15
    count  114  137  124  111   2  2  1   1  1  1   1   1   1   1   1   1
    dim     14   14   14   14  10  4  5  11  4  7   5   7   4   2   3  13
    Normalized Mutual Information Score :  0.9457503020609286
    Elapsed time :  19.8 sec // Total elapsed time :  4076.8 sec
    ==================================================================================
    alpha for this iteration is  1.4385273257451405
    187 th iteration completed // # of clusters :  16
             0    1    2    3   4  5  6  7  8  9  10  11  12  13  14  15
    count  114  137  124  111   2  2  1  1  1  1   1   1   1   1   1   1
    dim     14   13   14   14  13  4  4  9  4  7   2   7   3   2   2  13
    Normalized Mutual Information Score :  0.9457503020609286
    Elapsed time :  34.2 sec // Total elapsed time :  4191.4 sec
    ==================================================================================
    alpha for this iteration is  2.1604291555132877
    192 th iteration completed // # of clusters :  16
             0    1    2    3   4  5  6   7  8  9  10  11  12  13  14  15
    count  114  137  124  111   2  2  1   1  1  1   1   1   1   1   1   1
    dim     14   13   14   14  12  5  4  10  3  8   6   7   3   3   2  14
    Normalized Mutual Information Score :  0.9457503020609286
    Elapsed time :  28.6 sec // Total elapsed time :  4323.4 sec
    ==================================================================================
    alpha for this iteration is  2.1064456101731532
    197 th iteration completed // # of clusters :  16
             0    1    2    3   4  5  6   7  8  9  10  11  12  13  14  15
    count  114  137  125  111   1  2  1   1  1  1   1   1   1   1   1   1
    dim     14   13   14   14  11  3  5  13  6  8   6   9   4   2   3  12
    Normalized Mutual Information Score :  0.9486320454228062
    Elapsed time :  29.3 sec // Total elapsed time :  4473.0 sec
    ==================================================================================
    alpha for this iteration is  1.5079002425954362
    202 th iteration completed // # of clusters :  14
             0    1    2    3  4  5  6  7  8  9  10  11  12  13
    count  114  138  126  111  2  1  1  1  1  1   1   1   1   1
    dim     14   13   14   14  3  8  4  8  6  8   4   3   3  11
    Normalized Mutual Information Score :  0.9563511128509747
    Elapsed time :  30.5 sec // Total elapsed time :  4619.2 sec
    ==================================================================================
    alpha for this iteration is  1.066061144127872
    207 th iteration completed // # of clusters :  13
             0    1    2    3  4  5  6  7  8  9  10  11  12
    count  114  138  126  112  2  1  1  1  1  1   1   1   1
    dim     14   13   14   14  4  9  4  9  6  9   2   5   1
    Normalized Mutual Information Score :  0.9601485493777115
    Elapsed time :  27.2 sec // Total elapsed time :  4757.4 sec
    ==================================================================================
    alpha for this iteration is  1.2084285051542203
    212 th iteration completed // # of clusters :  13
             0    1    2    3  4  5  6   7   8  9  10  11  12
    count  114  138  126  112  2  1  1   1   1  1   1   1   1
    dim     14   13   14   14  3  9  5  13  10  8   4   4   1
    Normalized Mutual Information Score :  0.9601485493777115
    Elapsed time :  27.2 sec // Total elapsed time :  4894.5 sec
    ==================================================================================
    alpha for this iteration is  1.1156840502317462
    217 th iteration completed // # of clusters :  13
             0    1    2    3  4  5  6   7   8  9  10  11  12
    count  114  138  126  112  2  1  1   1   1  1   1   1   1
    dim     14   13   14   14  3  9  4  13  10  9   7   4   1
    Normalized Mutual Information Score :  0.9601485493777115
    Elapsed time :  27.5 sec // Total elapsed time :  5039.3 sec
    ==================================================================================
    alpha for this iteration is  0.9840763746252383
    222 th iteration completed // # of clusters :  13
             0    1    2    3  4  5  6   7   8  9  10  11  12
    count  114  138  126  112  2  1  1   1   1  1   1   1   1
    dim     14   14   14   14  3  8  3  14  10  7   6   3   4
    Normalized Mutual Information Score :  0.9601485493777115
    Elapsed time :  27.3 sec // Total elapsed time :  5175.3 sec
    ==================================================================================
    alpha for this iteration is  0.9536259079455116
    227 th iteration completed // # of clusters :  13
             0    1    2    3  4  5  6   7   8  9  10  11  12
    count  114  138  126  112  2  1  1   1   1  1   1   1   1
    dim     14   14   14   14  3  9  4  13  10  8   3   3   4
    Normalized Mutual Information Score :  0.9601485493777115
    Elapsed time :  26.8 sec // Total elapsed time :  5321.0 sec
    ==================================================================================
    alpha for this iteration is  1.8261637184628385
    232 th iteration completed // # of clusters :  12
             0    1    2    3  4  5  6   7  8  9  10  11
    count  114  139  126  112  2  1  1   1  1  1   1   1
    dim     14   14   14   14  3  8  5  13  8  7   2   3
    Normalized Mutual Information Score :  0.9641221263025105
    Elapsed time :  25.7 sec // Total elapsed time :  5449.4 sec
    ==================================================================================
    alpha for this iteration is  1.4988706327862493
    237 th iteration completed // # of clusters :  12
             0    1    2    3  4  5  6   7  8  9  10  11
    count  114  139  126  112  2  1  1   1  1  1   1   1
    dim     14   14   14   14  4  7  5  14  8  9   3   4
    Normalized Mutual Information Score :  0.9641221263025105
    Elapsed time :  26.2 sec // Total elapsed time :  5582.2 sec
    ==================================================================================
    alpha for this iteration is  0.888046254209504
    242 th iteration completed // # of clusters :  11
             0    1    2    3  4  5  6   7  8  9  10
    count  114  140  126  112  2  1  1   1  1  1   1
    dim     14   14   14   14  3  6  5  13  8  3   2
    Normalized Mutual Information Score :  0.9681336095611406
    Elapsed time :  27.3 sec // Total elapsed time :  5716.4 sec
    ==================================================================================
    alpha for this iteration is  1.2168075173311252
    247 th iteration completed // # of clusters :  9
             0    1    2    3  4  5  6  7  8
    count  114  142  126  112  2  1  1  1  1
    dim     13   14   14   14  4  8  3  5  4
    Normalized Mutual Information Score :  0.9762723081879234
    Elapsed time :  24.1 sec // Total elapsed time :  5841.3 sec
    ==================================================================================
    alpha for this iteration is  1.147599441096996
    252 th iteration completed // # of clusters :  9
             0    1    2    3  4  5  6  7  8
    count  114  142  126  112  2  1  1  1  1
    dim     13   14   14   14  4  7  3  6  3
    Normalized Mutual Information Score :  0.9762723081879234
    Elapsed time :  25.6 sec // Total elapsed time :  5963.5 sec
    ==================================================================================
    alpha for this iteration is  0.8324305860490426
    257 th iteration completed // # of clusters :  9
             0    1    2    3  4  5  6  7  8
    count  114  142  126  112  2  1  1  1  1
    dim     13   14   14   14  5  7  3  8  3
    Normalized Mutual Information Score :  0.9762723081879234
    Elapsed time :  25.1 sec // Total elapsed time :  6087.8 sec
    ==================================================================================
    alpha for this iteration is  1.0927917447084554
    262 th iteration completed // # of clusters :  9
             0    1    2    3  4  5  6  7  8
    count  114  142  126  112  2  1  1  1  1
    dim     13   14   14   14  5  7  3  9  3
    Normalized Mutual Information Score :  0.9762723081879234
    Elapsed time :  24.5 sec // Total elapsed time :  6211.8 sec
    ==================================================================================
    alpha for this iteration is  0.40080952452387
    267 th iteration completed // # of clusters :  9
             0    1    2    3  4  5  6  7  8
    count  114  142  126  112  2  1  1  1  1
    dim     13   14   14   14  6  7  5  8  3
    Normalized Mutual Information Score :  0.9762723081879234
    Elapsed time :  24.4 sec // Total elapsed time :  6335.8 sec
    ==================================================================================
    alpha for this iteration is  0.8026111469398863
    272 th iteration completed // # of clusters :  9
             0    1    2    3  4  5  6  7  8
    count  114  142  126  112  2  1  1  1  1
    dim     13   14   14   14  6  6  6  8  3
    Normalized Mutual Information Score :  0.9762723081879234
    Elapsed time :  24.9 sec // Total elapsed time :  6460.2 sec
    ==================================================================================
    alpha for this iteration is  0.8577480081024389
    277 th iteration completed // # of clusters :  9
             0    1    2    3  4  5  6   7  8
    count  114  142  126  112  2  1  1   1  1
    dim     13   13   14   14  5  9  3  10  2
    Normalized Mutual Information Score :  0.9762723081879234
    Elapsed time :  25.0 sec // Total elapsed time :  6610.8 sec
    ==================================================================================
    alpha for this iteration is  1.0215874669343572
    282 th iteration completed // # of clusters :  9
             0    1    2    3  4  5  6   7  8
    count  114  142  126  112  2  1  1   1  1
    dim     13   13   14   14  5  8  2  12  2
    Normalized Mutual Information Score :  0.9762723081879234
    Elapsed time :  24.9 sec // Total elapsed time :  6734.5 sec
    ==================================================================================
    alpha for this iteration is  0.5386106236489087
    287 th iteration completed // # of clusters :  9
             0    1    2    3  4  5  6   7  8
    count  114  142  126  112  2  1  1   1  1
    dim     13   13   14   14  4  7  3  10  4
    Normalized Mutual Information Score :  0.9762723081879234
    Elapsed time :  24.2 sec // Total elapsed time :  6866.1 sec
    ==================================================================================
    alpha for this iteration is  0.9217811222530695
    292 th iteration completed // # of clusters :  8
             0    1    2    3  4  5  6  7
    count  114  142  127  112  2  1  1  1
    dim     13   13   14   14  3  8  4  2
    Normalized Mutual Information Score :  0.9803177072176641
    Elapsed time :  26.5 sec // Total elapsed time :  6991.2 sec
    ==================================================================================
    alpha for this iteration is  0.41464980503862897
    297 th iteration completed // # of clusters :  7
             0    1    2    3  4  5  6
    count  115  142  127  112  2  1  1
    dim     13   14   14   14  2  3  2
    Normalized Mutual Information Score :  0.9843268747706517
    Elapsed time :  22.3 sec // Total elapsed time :  7104.3 sec
    ==================================================================================
    alpha for this iteration is  0.8354143635169674
    302 th iteration completed // # of clusters :  7
             0    1    2    3  4  5  6
    count  115  142  127  112  2  1  1
    dim     13   14   14   14  3  6  4
    Normalized Mutual Information Score :  0.9843268747706517
    Elapsed time :  22.0 sec // Total elapsed time :  7224.0 sec
    ==================================================================================
    alpha for this iteration is  0.6376601139305584
    307 th iteration completed // # of clusters :  7
             0    1    2    3  4  5  6
    count  115  142  127  112  2  1  1
    dim     13   13   14   14  4  9  3
    Normalized Mutual Information Score :  0.9843268747706517
    Elapsed time :  23.1 sec // Total elapsed time :  7345.7 sec
    ==================================================================================
    alpha for this iteration is  0.48212465771496804
    312 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  4  2
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  22.4 sec // Total elapsed time :  7453.3 sec
    ==================================================================================
    alpha for this iteration is  0.46526011421740443
    317 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  4  3
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  20.4 sec // Total elapsed time :  7557.6 sec
    ==================================================================================
    alpha for this iteration is  0.6960711760353144
    322 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  4  2
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  21.2 sec // Total elapsed time :  7662.5 sec
    ==================================================================================
    alpha for this iteration is  0.5459914402848157
    327 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  4  4
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  20.8 sec // Total elapsed time :  7767.6 sec
    ==================================================================================
    alpha for this iteration is  0.19743964395649763
    332 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  3  3
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  21.2 sec // Total elapsed time :  7875.1 sec
    ==================================================================================
    alpha for this iteration is  0.2183353082600598
    337 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  5  2
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  25.8 sec // Total elapsed time :  7989.3 sec
    ==================================================================================
    alpha for this iteration is  1.062169852254682
    342 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  3  3
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  23.2 sec // Total elapsed time :  8104.0 sec
    ==================================================================================
    alpha for this iteration is  0.8212852921941703
    347 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  3  2
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  32.1 sec // Total elapsed time :  8238.3 sec
    ==================================================================================
    alpha for this iteration is  0.8710463701127558
    352 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  3  3
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  24.4 sec // Total elapsed time :  8361.9 sec
    ==================================================================================
    alpha for this iteration is  0.3971406393636921
    357 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  4  1
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  24.2 sec // Total elapsed time :  8484.5 sec
    ==================================================================================
    alpha for this iteration is  0.6696504295547139
    362 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  3  3
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  23.6 sec // Total elapsed time :  8602.9 sec
    ==================================================================================
    alpha for this iteration is  0.39242723660608464
    367 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  3  2
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  24.5 sec // Total elapsed time :  8754.5 sec
    ==================================================================================
    alpha for this iteration is  0.6004088517350505
    372 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  3  5
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  22.6 sec // Total elapsed time :  8883.6 sec
    ==================================================================================
    alpha for this iteration is  0.7348343100768665
    377 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  3  7
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  29.4 sec // Total elapsed time :  9014.7 sec
    ==================================================================================
    alpha for this iteration is  0.6753678409330522
    382 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  5  7
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  36.7 sec // Total elapsed time :  9173.1 sec
    ==================================================================================
    alpha for this iteration is  0.2512091999990442
    387 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  2  6
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  30.1 sec // Total elapsed time :  9303.6 sec
    ==================================================================================
    alpha for this iteration is  0.18425751793212097
    392 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  3  5
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  21.8 sec // Total elapsed time :  9445.8 sec
    ==================================================================================
    alpha for this iteration is  0.6092228138725782
    397 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     13   13   14   14  3  4
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  24.1 sec // Total elapsed time :  9579.2 sec
    ==================================================================================
    alpha for this iteration is  0.22767939880089422
    402 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     14   13   14   14  2  2
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  39.6 sec // Total elapsed time :  9729.4 sec
    ==================================================================================
    alpha for this iteration is  0.27785039145914847
    407 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     14   13   14   14  2  4
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  30.6 sec // Total elapsed time :  9879.3 sec
    ==================================================================================
    alpha for this iteration is  0.6059413654566161
    412 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     14   13   14   14  3  5
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  26.7 sec // Total elapsed time :  10018.9 sec
    ==================================================================================
    alpha for this iteration is  0.4195639129581981
    417 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     14   13   14   14  3  5
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  21.3 sec // Total elapsed time :  10143.8 sec
    ==================================================================================
    alpha for this iteration is  0.3533660724665608
    422 th iteration completed // # of clusters :  6
             0    1    2    3  4  5
    count  115  143  127  112  2  1
    dim     14   13   14   14  2  5
    Normalized Mutual Information Score :  0.9885236668137114
    Elapsed time :  21.4 sec // Total elapsed time :  10251.6 sec
    ==================================================================================
    alpha for this iteration is  0.4332385027917392
    427 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     14   13   14   14  4
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  20.0 sec // Total elapsed time :  10357.6 sec
    ==================================================================================
    alpha for this iteration is  0.5272093506111836
    432 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     14   13   14   14  2
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  19.3 sec // Total elapsed time :  10460.0 sec
    ==================================================================================
    alpha for this iteration is  0.49858772181012334
    437 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     14   13   14   14  4
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  19.3 sec // Total elapsed time :  10558.4 sec
    ==================================================================================
    alpha for this iteration is  0.864231578385934
    442 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     14   13   14   14  2
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  20.0 sec // Total elapsed time :  10656.1 sec
    ==================================================================================
    alpha for this iteration is  0.3552302656676545
    447 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     14   13   14   14  2
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  19.9 sec // Total elapsed time :  10766.5 sec
    ==================================================================================
    alpha for this iteration is  0.5545155199023056
    452 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     14   13   14   14  2
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  25.2 sec // Total elapsed time :  10885.1 sec
    ==================================================================================
    alpha for this iteration is  0.5039020295245679
    457 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     14   13   14   14  2
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  20.0 sec // Total elapsed time :  10993.9 sec
    ==================================================================================
    alpha for this iteration is  0.17119587804671269
    462 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     13   13   14   14  3
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  20.7 sec // Total elapsed time :  11094.0 sec
    ==================================================================================
    alpha for this iteration is  0.4273876085016931
    467 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     13   13   14   14  3
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  19.8 sec // Total elapsed time :  11192.2 sec
    ==================================================================================
    alpha for this iteration is  0.39054895529703537
    472 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     13   13   14   14  5
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  19.5 sec // Total elapsed time :  11290.6 sec
    ==================================================================================
    alpha for this iteration is  0.3532473208507237
    477 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  127  113  2
    dim     13   13   14   14  6
    Normalized Mutual Information Score :  0.9925878084028755
    Elapsed time :  20.3 sec // Total elapsed time :  11391.9 sec
    ==================================================================================
    alpha for this iteration is  0.5354661291919014
    482 th iteration completed // # of clusters :  5
             0    1    2    3  4
    count  115  143  128  113  1
    dim     13   13   14   14  6
    Normalized Mutual Information Score :  0.9957796184419704
    Elapsed time :  19.8 sec // Total elapsed time :  11489.8 sec
    ==================================================================================
    alpha for this iteration is  0.18242585370675085
    487 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  18.7 sec // Total elapsed time :  11589.1 sec
    ==================================================================================
    alpha for this iteration is  0.45854391700428
    492 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  20.3 sec // Total elapsed time :  11694.3 sec
    ==================================================================================
    alpha for this iteration is  0.23849154731458871
    497 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  24.9 sec // Total elapsed time :  11815.1 sec
    ==================================================================================
    alpha for this iteration is  0.2679418540760964
    502 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  30.4 sec // Total elapsed time :  11927.4 sec
    ==================================================================================
    alpha for this iteration is  0.2294289502388042
    507 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  23.0 sec // Total elapsed time :  12034.1 sec
    ==================================================================================
    alpha for this iteration is  0.28519590235242787
    512 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  20.6 sec // Total elapsed time :  12130.3 sec
    ==================================================================================
    alpha for this iteration is  0.28827498382637046
    517 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  19.3 sec // Total elapsed time :  12225.8 sec
    ==================================================================================
    alpha for this iteration is  0.283552887856448
    522 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  18.0 sec // Total elapsed time :  12317.8 sec
    ==================================================================================
    alpha for this iteration is  0.21660200432827006
    527 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  19.4 sec // Total elapsed time :  12413.0 sec
    ==================================================================================
    alpha for this iteration is  0.39296497139797454
    532 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  20.6 sec // Total elapsed time :  12510.5 sec
    ==================================================================================
    alpha for this iteration is  0.19464188955818096
    537 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  25.9 sec // Total elapsed time :  12627.1 sec
    ==================================================================================
    alpha for this iteration is  0.6367301054677227
    542 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  37.8 sec // Total elapsed time :  12759.8 sec
    ==================================================================================
    alpha for this iteration is  0.16274867807961255
    547 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  18.2 sec // Total elapsed time :  12874.4 sec
    ==================================================================================
    alpha for this iteration is  0.4384199532466777
    552 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  20.3 sec // Total elapsed time :  12987.4 sec
    ==================================================================================
    alpha for this iteration is  0.13825012988664676
    557 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  17.0 sec // Total elapsed time :  13071.3 sec
    ==================================================================================
    alpha for this iteration is  0.432598335735783
    562 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  16.7 sec // Total elapsed time :  13164.0 sec
    ==================================================================================
    alpha for this iteration is  0.15112897075214785
    567 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  19.9 sec // Total elapsed time :  13255.7 sec
    ==================================================================================
    alpha for this iteration is  0.20138277325778514
    572 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  16.7 sec // Total elapsed time :  13339.1 sec
    ==================================================================================
    alpha for this iteration is  0.24468610408152128
    577 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  16.7 sec // Total elapsed time :  13428.7 sec
    ==================================================================================
    alpha for this iteration is  0.22714032999894238
    582 th iteration completed // # of clusters :  4
             0    1    2    3
    count  115  143  129  113
    dim     13   13   14   14
    Normalized Mutual Information Score :  1.0
    Elapsed time :  25.4 sec // Total elapsed time :  13535.5 sec
    ==================================================================================


* 약 67번째 iteration(27분 경과)부터는, singleton cluster를 제외하면, cluster assignment를 안정적으로 포착하며 state space를 탐색하는 모습을 보였다.
* 312번째 iteration(124분 경과)부터는, 4개의 observation을 제외하고 생성되었던 cluster를 찾아감.
* 487번째 iteration(193분 경과)부터는 모든 cluster가 완전히 포착됨.
* 하지만 subspace의 dimension은 거의 포착하지 못하는 모습을 보였음. 
    * 이는 dimension의 birth-death를 탐색하는 RJMCMC step이 iteration 별로 한 번 씩만 수행되서 그런 것은 아닐까?
    * 혹은 $\Psi$의 diagonal element가 서로 같다는 제약을 두지 않아서 그런 것인가?
    * Identifiability problem



```python

```


```python

```


```python

```

공분산을 확인하기 위해 1000번째 iteration에서 중단해보았다.


```python
Cov_estimated_0 = np.matmul(Lambda_list[-2][0],Lambda_list[-2][0].transpose()) + Psi_list[-2][0]
Cov_estimated_1 = np.matmul(Lambda_list[-2][1],Lambda_list[-2][1].transpose()) + Psi_list[-2][1]
Cov_estimated_2 = np.matmul(Lambda_list[-2][2],Lambda_list[-2][2].transpose()) + Psi_list[-2][2]
```


```python
Cov_true_0 = np.matmul(true_W_list[0],true_W_list[0].transpose()) + np.diag(np.repeat(sigma,dim))
Cov_true_1 = np.matmul(true_W_list[1],true_W_list[1].transpose()) + np.diag(np.repeat(sigma,dim))
Cov_true_2 = np.matmul(true_W_list[2],true_W_list[2].transpose()) + np.diag(np.repeat(sigma,dim))
```


```python
np.mean(pd.DataFrame(mu_list[-1]).transpose()).values
```




    array([-0.60144159, -1.00312128,  6.81017517, -5.98066164,  3.06089913,
           -0.68590817,  2.20218758, 10.09724462, -6.71764645,  7.40141854])




```python
val1, vec1 = LA.eigh(Cov_estimated_0)
val1 = val1[np.argsort(val1)[::-1]]
vec1 = vec1[:,np.argsort(val1)[::-1]]

val2, vec2 = LA.eigh(Cov_true_0)
val2 = val2[np.argsort(val2)[::-1]]
vec2 = vec2[:,np.argsort(val2)[::-1]]

df = pd.DataFrame([val1,val2])
df.index = ["estimated","true"]
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>estimated</td>
      <td>329.078916</td>
      <td>130.283488</td>
      <td>109.604822</td>
      <td>82.693508</td>
      <td>62.868054</td>
      <td>35.275020</td>
      <td>22.869043</td>
      <td>14.263365</td>
      <td>1.603746</td>
      <td>0.819304</td>
    </tr>
    <tr>
      <td>true</td>
      <td>219.654519</td>
      <td>135.418909</td>
      <td>86.685768</td>
      <td>72.067475</td>
      <td>31.107793</td>
      <td>18.853932</td>
      <td>7.778586</td>
      <td>0.500000</td>
      <td>0.500000</td>
      <td>0.500000</td>
    </tr>
  </tbody>
</table>
</div>




```python
val1, vec1 = LA.eigh(Cov_estimated_1)
val1 = val1[np.argsort(val1)[::-1]]
vec1 = vec1[:,np.argsort(val1)[::-1]]

val2, vec2 = LA.eigh(Cov_true_1)
val2 = val2[np.argsort(val2)[::-1]]
vec2 = vec2[:,np.argsort(val2)[::-1]]

df = pd.DataFrame([val1,val2])
df.index = ["estimated","true"]
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>estimated</td>
      <td>372.460980</td>
      <td>151.439763</td>
      <td>110.270056</td>
      <td>52.170564</td>
      <td>38.193328</td>
      <td>29.405775</td>
      <td>26.793994</td>
      <td>12.544531</td>
      <td>4.594465</td>
      <td>2.666787</td>
    </tr>
    <tr>
      <td>true</td>
      <td>208.509514</td>
      <td>176.544938</td>
      <td>102.404130</td>
      <td>43.504023</td>
      <td>39.344547</td>
      <td>14.575308</td>
      <td>5.837318</td>
      <td>0.500000</td>
      <td>0.500000</td>
      <td>0.500000</td>
    </tr>
  </tbody>
</table>
</div>




```python
val1, vec1 = LA.eigh(Cov_estimated_2)
val1 = val1[np.argsort(val1)[::-1]]
vec1 = vec1[:,np.argsort(val1)[::-1]]

val2, vec2 = LA.eigh(Cov_true_2)
val2 = val2[np.argsort(val2)[::-1]]
vec2 = vec2[:,np.argsort(val2)[::-1]]

df = pd.DataFrame([val1,val2])
df.index = ["estimated","true"]
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>estimated</td>
      <td>186.767789</td>
      <td>75.729795</td>
      <td>53.145282</td>
      <td>36.255812</td>
      <td>11.054797</td>
      <td>7.618271</td>
      <td>2.059132</td>
      <td>0.847434</td>
      <td>0.614211</td>
      <td>0.446752</td>
    </tr>
    <tr>
      <td>true</td>
      <td>78.661702</td>
      <td>0.500000</td>
      <td>0.500000</td>
      <td>0.500000</td>
      <td>0.500000</td>
      <td>0.500000</td>
      <td>0.500000</td>
      <td>0.500000</td>
      <td>0.500000</td>
      <td>0.500000</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.DataFrame(Cov_true_1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>49.303275</td>
      <td>-5.359289</td>
      <td>-39.121282</td>
      <td>-5.170560</td>
      <td>34.344265</td>
      <td>22.636355</td>
      <td>27.632796</td>
      <td>-26.797958</td>
      <td>-33.531483</td>
      <td>9.225358</td>
    </tr>
    <tr>
      <td>1</td>
      <td>-5.359289</td>
      <td>62.196386</td>
      <td>-20.886464</td>
      <td>15.761558</td>
      <td>3.121088</td>
      <td>28.152674</td>
      <td>13.945363</td>
      <td>1.146782</td>
      <td>12.157007</td>
      <td>-19.532118</td>
    </tr>
    <tr>
      <td>2</td>
      <td>-39.121282</td>
      <td>-20.886464</td>
      <td>64.258537</td>
      <td>-10.370499</td>
      <td>-49.749939</td>
      <td>-16.911300</td>
      <td>-8.173606</td>
      <td>10.868177</td>
      <td>37.766306</td>
      <td>-14.611605</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-5.170560</td>
      <td>15.761558</td>
      <td>-10.370499</td>
      <td>27.133722</td>
      <td>3.728911</td>
      <td>-2.556426</td>
      <td>-28.451584</td>
      <td>32.441693</td>
      <td>-9.094869</td>
      <td>2.899292</td>
    </tr>
    <tr>
      <td>4</td>
      <td>34.344265</td>
      <td>3.121088</td>
      <td>-49.749939</td>
      <td>3.728911</td>
      <td>66.076467</td>
      <td>1.303619</td>
      <td>-6.357167</td>
      <td>-24.734922</td>
      <td>-46.314103</td>
      <td>41.632646</td>
    </tr>
    <tr>
      <td>5</td>
      <td>22.636355</td>
      <td>28.152674</td>
      <td>-16.911300</td>
      <td>-2.556426</td>
      <td>1.303619</td>
      <td>52.288960</td>
      <td>45.683166</td>
      <td>-8.184721</td>
      <td>12.848669</td>
      <td>-14.510235</td>
    </tr>
    <tr>
      <td>6</td>
      <td>27.632796</td>
      <td>13.945363</td>
      <td>-8.173606</td>
      <td>-28.451584</td>
      <td>-6.357167</td>
      <td>45.683166</td>
      <td>86.119082</td>
      <td>-43.401508</td>
      <td>28.253575</td>
      <td>-20.286585</td>
    </tr>
    <tr>
      <td>7</td>
      <td>-26.797958</td>
      <td>1.146782</td>
      <td>10.868177</td>
      <td>32.441693</td>
      <td>-24.734922</td>
      <td>-8.184721</td>
      <td>-43.401508</td>
      <td>73.585545</td>
      <td>15.134963</td>
      <td>-0.867855</td>
    </tr>
    <tr>
      <td>8</td>
      <td>-33.531483</td>
      <td>12.157007</td>
      <td>37.766306</td>
      <td>-9.094869</td>
      <td>-46.314103</td>
      <td>12.848669</td>
      <td>28.253575</td>
      <td>15.134963</td>
      <td>61.647062</td>
      <td>-22.304380</td>
    </tr>
    <tr>
      <td>9</td>
      <td>9.225358</td>
      <td>-19.532118</td>
      <td>-14.611605</td>
      <td>2.899292</td>
      <td>41.632646</td>
      <td>-14.510235</td>
      <td>-20.286585</td>
      <td>-0.867855</td>
      <td>-22.304380</td>
      <td>49.610742</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.DataFrame(Cov_estimated_1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>71.789094</td>
      <td>27.034750</td>
      <td>-50.402422</td>
      <td>-39.238673</td>
      <td>88.255522</td>
      <td>50.446378</td>
      <td>13.165013</td>
      <td>-10.520953</td>
      <td>-25.580492</td>
      <td>-15.740031</td>
    </tr>
    <tr>
      <td>1</td>
      <td>27.034750</td>
      <td>68.920760</td>
      <td>-14.906305</td>
      <td>-29.690904</td>
      <td>49.525630</td>
      <td>47.955623</td>
      <td>24.549956</td>
      <td>-10.407349</td>
      <td>14.177903</td>
      <td>-27.744206</td>
    </tr>
    <tr>
      <td>2</td>
      <td>-50.402422</td>
      <td>-14.906305</td>
      <td>68.195171</td>
      <td>9.296009</td>
      <td>-76.198700</td>
      <td>-28.276494</td>
      <td>-3.387225</td>
      <td>0.212711</td>
      <td>33.805356</td>
      <td>2.939601</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-39.238673</td>
      <td>-29.690904</td>
      <td>9.296009</td>
      <td>66.380210</td>
      <td>-77.845682</td>
      <td>-33.643032</td>
      <td>-29.259640</td>
      <td>27.548819</td>
      <td>-2.099174</td>
      <td>18.830883</td>
    </tr>
    <tr>
      <td>4</td>
      <td>88.255522</td>
      <td>49.525630</td>
      <td>-76.198700</td>
      <td>-77.845682</td>
      <td>187.657945</td>
      <td>56.405222</td>
      <td>20.072429</td>
      <td>-16.517963</td>
      <td>-45.271365</td>
      <td>-4.966363</td>
    </tr>
    <tr>
      <td>5</td>
      <td>50.446378</td>
      <td>47.955623</td>
      <td>-28.276494</td>
      <td>-33.643032</td>
      <td>56.405222</td>
      <td>76.365573</td>
      <td>24.197430</td>
      <td>-3.871924</td>
      <td>13.718823</td>
      <td>-28.380172</td>
    </tr>
    <tr>
      <td>6</td>
      <td>13.165013</td>
      <td>24.549956</td>
      <td>-3.387225</td>
      <td>-29.259640</td>
      <td>20.072429</td>
      <td>24.197430</td>
      <td>62.472864</td>
      <td>-39.568208</td>
      <td>16.921528</td>
      <td>-8.906284</td>
    </tr>
    <tr>
      <td>7</td>
      <td>-10.520953</td>
      <td>-10.407349</td>
      <td>0.212711</td>
      <td>27.548819</td>
      <td>-16.517963</td>
      <td>-3.871924</td>
      <td>-39.568208</td>
      <td>81.220202</td>
      <td>3.818670</td>
      <td>-11.108592</td>
    </tr>
    <tr>
      <td>8</td>
      <td>-25.580492</td>
      <td>14.177903</td>
      <td>33.805356</td>
      <td>-2.099174</td>
      <td>-45.271365</td>
      <td>13.718823</td>
      <td>16.921528</td>
      <td>3.818670</td>
      <td>52.716609</td>
      <td>-25.604115</td>
    </tr>
    <tr>
      <td>9</td>
      <td>-15.740031</td>
      <td>-27.744206</td>
      <td>2.939601</td>
      <td>18.830883</td>
      <td>-4.966363</td>
      <td>-28.380172</td>
      <td>-8.906284</td>
      <td>-11.108592</td>
      <td>-25.604115</td>
      <td>64.821816</td>
    </tr>
  </tbody>
</table>
</div>


